<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Interactive 3DGS</title>
    <style type="text/css">
        html,
        body {
            margin: 0;
            height: 100%;
            background-image: linear-gradient(white, white);
            overflow: hidden;
        }

        #Form {
            position: absolute;
            top: 14%;
            margin-left: 24.6%;
            font-family: 'Palatino';
            color: "darkgrey";
            font-size: 1.8em;
            font-weight: bold;
        }

        #Force {
            position: absolute;
            top: 14%;
            margin-left: 74.6%;
            font-family: 'Palatino';
            color: "darkgrey";
            font-size: 1.8em;
            font-weight: bold;
        }

        #mink{
           position:absolute;
           top:79.5%;
           margin-left:8%;
           font-family:'Palatino';
           color:"darkgrey";
           font-size:1.2em;
          }

        #supp1x{
           position:absolute;
           top:82.5%;
           margin-left:8%;
           font-family:'Palatino';
           color:"darkgrey";
           font-size:1.2em;
          }

        #supp1y{
           position:absolute;
           top:85.5%;
           margin-left:8%;
           font-family:'Palatino';
           color:"darkgrey";
           font-size:1.2em;
          }

        #supp2x{
           position:absolute;
           top:88.5%;
           margin-left:8%;
           font-family:'Palatino';
           color:"darkgrey";
           font-size:1.2em;
          }

        #supp2y{
           position:absolute;
           top:91.5%;
           margin-left:8%;
           font-family:'Palatino';
           color:"darkgrey";
           font-size:1.2em;
          }

        #faces{
           position:absolute;
           top:79.5%;
           margin-left:30%;
           font-family:'Palatino';
           color:"darkgrey";
           font-size:1.2em;
          }

          #forces{
           position:absolute;
           top:82.5%;
           margin-left:30%;
           font-family:'Palatino';
           color:"darkgrey";
           font-size:1.2em;
          }

          #forces2{
           position:absolute;
           top:85.5%;
           margin-left:30%;
           font-family:'Palatino';
           color:"darkgrey";
           font-size:1.2em;
          }

          #forces3{
           position:absolute;
           top:88.5%;
           margin-left:30%;
           font-family:'Palatino';
           color:"darkgrey";
           font-size:1.2em;
          }

          #apply1{
           position:absolute;
           top:79.5%;
           margin-left:78%;
           font-family:'Palatino';
           color:"darkgrey";
           font-size:1.2em;
          }

          #apply2{
           position:absolute;
           top:82.5%;
           margin-left:78%;
           font-family:'Palatino';
           color:"darkgrey";
           font-size:1.2em;
          }

          #apply3{
           position:absolute;
           top:85.5%;
           margin-left:78%;
           font-family:'Palatino';
           color:"darkgrey";
           font-size:1.2em;
          }

          #applyface{
           position:absolute;
           top:82.5%;
           margin-left:78%;
           font-family:'Palatino';
           color:"darkgrey";
           font-size:1.2em;
          }

        #GDoF1{
           position:absolute;
           top:79.5%;
           margin-left:63.5%;
           font-family:'Palatino';
           color:"darkgrey";
           font-size:1.2em;
          }
          #GDoF2{
           position:absolute;
           top:82.5%;
           margin-left:63.5%;
           font-family:'Palatino';
           color:"darkgrey";
           font-size:1.2em;
          }
          #GDoF3{
           position:absolute;
           top:85.5%;
           margin-left:63.5%;
           font-family:'Palatino';
           color:"darkgrey";
           font-size:1.2em;
          }
          #GDoF4{
           position:absolute;
           top:88.5%;
           margin-left:63.5%;
           font-family:'Palatino';
           color:"darkgrey";
           font-size:1.2em;
          }
          #GDoF5{
           position:absolute;
           top:91.5%;
           margin-left:63.5%;
           font-family:'Palatino';
           color:"darkgrey";
           font-size:1.2em;
          }


        canvas {
            display: block;
        }

        #custom-handle {
    width: 3em;
    height: 1.6em;
    top: 50%;
    margin-top: -.8em;
    text-align: center;
    line-height: 1.6em;
  }
    </style>
</head>

<body onload="draw();">


    <div id="Form">form</div>
    <div id="Force">force</div>
    <div id="mink">&#945 (Minkowski sum)</div>
    <div id="faces">faces</div>
    <div id="forces">forces_f1</div>
    <div id="forces2">forces_f2</div>
    <div id="forces3">forces_f3</div>
    <div id="GDoF1">GDoF 1</div>
    <div id="GDoF2">GDoF 2</div>
    <div id="GDoF3">GDoF 3</div>
    <div id="GDoF4">GDoF 4</div>
    <div id="GDoF5">GDoF 5</div>
    <div id="supp1x">support 1.x</div>
    <div id="supp1y">support 1.y</div>
    <div id="supp2x">support 2.x</div>
    <div id="supp2y">support 2.y</div>
    <div id="apply1"> f 1</div>
    <div id="apply2"> f 2</div>
    <div id="apply3"> f 3</div>

    <!-- <div id="applyface"> applyload</div> -->


    <a href="https://www.i3dgs.com/examples"><img src="../images/logo.png" style="width: 75px;
    position:absolute;
    top:6%;
    margin-left:10%;
    height: 23px;
    "></a>
<!-- 
    <canvas id="canvas_test" width="800" height="250"></canvas> -->

    <div id="minkscale"><div id="custom-handle" class="ui-slider-handle"></div></div>
    <div id="support1x"></div>
    <div id="support1y"></div>
    <div id="support2x"></div>
    <div id="support2y"></div>


    <div id="forcescale_1"></div>
    <div id="forcescale_2"></div>
    <div id="forcescale_3"></div>
    <div id="forcescale_4"></div>
    <div id="forcescale_5"></div>

    <div id="applyload_1"></div>
    <div id="applyload_2"></div>
    <div id="applyload_3"></div>

    <div id="check_faces">
        <input id="form_faces" name="chkItem" type="checkbox">
    </div>

    <!-- <div id="check_applyface">
        <input id="force_face" name="chkItem" type="checkbox">
    </div> -->

    <div id="check_forces_f1">
        <input id="form_forces_f1" name="chkItem" type="checkbox">
    </div>

    <div id="check_forces_f2">
        <input id="form_forces_f2" name="chkItem" type="checkbox">
    </div>

    <div id="check_forces_f3">
        <input id="form_forces_f3" name="chkItem" type="checkbox">
    </div>

    <div id="check_mink">
        <input id="form_mink" name="chkItem" type="checkbox">
    </div>


</body>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r124/three.js"></script>
<script type="text/javascript" src="../libs/three/utils/SceneUtils.js"></script>
<!-- <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/three@0.101.1/examples/js/controls/TransformControls.js"></script> -->
<script type="text/javascript" src="../libs/three/controls/TransformControls.js"></script>
<script type="text/javascript"
    src="https://cdn.jsdelivr.net/npm/three@0.101.1/examples/js/controls/OrbitControls.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/17.2.0/Tween.js"></script>
<script src="https://threejs.org/examples/js/curves/NURBSCurve.js"></script>
<script src="https://threejs.org/examples/js/curves/NURBSUtils.js"></script>


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.css">
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.7.7/dat.gui.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/stats.js/7/Stats.js"></script>

<!-- <script>
$( function() {
    $( "#minkscale" ).slider({
        orientation: "horizontal",

    range: "min",
    max: 2,
    min: 0,
    step: 0.01,
    round: 1,
      create: function() {
        handle1.text( $( this ).slider( "value" ) );
      },
      slide: function( event, ui ) {
        handle1.text( ui.value );
      }
    });
    } );
</script> -->

<style>


    /* support 1.x */
    #support1x {
        position: absolute;
        top: 83%;
        width: 5%;
        height: 2px;
        margin-left: 17.5%;

    }



    #support1x .ui-slider-range {
        background: #383838;
    }

    #support1x .ui-slider-handle {
        border-color: #666666;
        border-color: #666666;
        height: 10px;
        width: 10px;

        border-radius: 10px;
        border-width: 2px;
    }

    /* support 1.y */
    #support1y {
        position: absolute;
        top: 86%;
        width: 5%;
        height: 2px;
        margin-left: 17.5%;

    }



    #support1y .ui-slider-range {
        background: #383838;
    }

    #support1y .ui-slider-handle {
        border-color: #666666;
        border-color: #666666;
        height: 10px;
        width: 10px;

        border-radius: 10px;
        border-width: 2px;
    }

     /* support 2.x */
     #support2x {
        position: absolute;
        top: 89%;
        width: 5%;
        height: 2px;
        margin-left: 17.5%;

    }



    #support2x .ui-slider-range {
        background: #383838;
    }

    #support2x .ui-slider-handle {
        border-color: #666666;
        border-color: #666666;
        height: 10px;
        width: 10px;

        border-radius: 10px;
        border-width: 2px;
    }

    /* support 2.y */
    #support2y {
        position: absolute;
        top: 92%;
        width: 5%;
        height: 2px;
        margin-left: 17.5%;

    }



    #support2y .ui-slider-range {
        background: #383838;
    }

    #support2y .ui-slider-handle {
        border-color: #666666;
        border-color: #666666;
        height: 10px;
        width: 10px;

        border-radius: 10px;
        border-width: 2px;
    }


    /* minkowski scale */
    #minkscale {
        position: absolute;
        top: 80.5%;
        width: 5%;
        height: 2px;
        margin-left: 19.5%;

    }



    #minkscale .ui-slider-range {
        background: #383838;
    }

    /* #minkscale .ui-slider-handle {
        border-color: #666666;
        border-color: #666666;
        height: 10px;
        width: 10px;

        border-radius: 10px;
        border-width: 2px;
    } */

    /* apply load 1 */

    #applyload_1 {
        position: absolute;
        top: 80.5%;
        width: 5%;
        height: 2px;
        margin-left: 81%;

    }



    #applyload_1 .ui-slider-range {
        background: #383838;
    }

    #applyload_1 .ui-slider-handle {
        border-color: #666666;
        border-color: #666666;
        height: 10px;
        width: 10px;

        border-radius: 10px;
        border-width: 2px;
    }


    /* apply load 2 */

    #applyload_2 {
        position: absolute;
        top: 83.5%;
        width: 5%;
        height: 2px;
        margin-left: 81%;

    }



    #applyload_2 .ui-slider-range {
        background: #383838;
    }

    #applyload_2 .ui-slider-handle {
        border-color: #666666;
        border-color: #666666;
        height: 10px;
        width: 10px;

        border-radius: 10px;
        border-width: 2px;
    }


    /* apply load 3 */

    #applyload_3 {
        position: absolute;
        top: 86.5%;
        width: 5%;
        height: 2px;
        margin-left: 81%;

    }



    #applyload_3 .ui-slider-range {
        background: #383838;
    }

    #applyload_3 .ui-slider-handle {
        border-color: #666666;
        border-color: #666666;
        height: 10px;
        width: 10px;

        border-radius: 10px;
        border-width: 2px;
    }

    /* force scale 1 */

    #forcescale_1 {
        position: absolute;
        top: 80.5%;
        width: 5%;
        height: 2px;
        margin-left: 68.5%;

    }



    #forcescale_1 .ui-slider-range {
        background: #383838;
    }

    #forcescale_1 .ui-slider-handle {
        border-color: #666666;
        border-color: #666666;
        height: 10px;
        width: 10px;

        border-radius: 10px;
        border-width: 2px;
    }

     /* force scale 2 */

     #forcescale_2 {
        position: absolute;
        top: 83.5%;
        width: 5%;
        height: 2px;
        margin-left: 68.5%;

    }



    #forcescale_2 .ui-slider-range {
        background: #383838;
    }

    #forcescale_2 .ui-slider-handle {
        border-color: #666666;
        border-color: #666666;
        height: 10px;
        width: 10px;

        border-radius: 10px;
        border-width: 2px;
    }

     /* force scale 3 */

     #forcescale_3 {
        position: absolute;
        top: 86.5%;
        width: 5%;
        height: 2px;
        margin-left: 68.5%;

    }



    #forcescale_3 .ui-slider-range {
        background: #383838;
    }

    #forcescale_3 .ui-slider-handle {
        border-color: #666666;
        border-color: #666666;
        height: 10px;
        width: 10px;

        border-radius: 10px;
        border-width: 2px;
    }


     /* force scale 4 */

     #forcescale_4 {
        position: absolute;
        top: 89.5%;
        width: 5%;
        height: 2px;
        margin-left: 68.5%;

    }



    #forcescale_4 .ui-slider-range {
        background: #383838;
    }

    #forcescale_4 .ui-slider-handle {
        border-color: #666666;
        border-color: #666666;
        height: 10px;
        width: 10px;

        border-radius: 10px;
        border-width: 2px;
    }


     /* force scale 5 */

     #forcescale_5 {
        position: absolute;
        top: 92.5%;
        width: 5%;
        height: 2px;
        margin-left: 68.5%;

    }



    #forcescale_5 .ui-slider-range {
        background: #383838;
    }

    #forcescale_5 .ui-slider-handle {
        border-color: #666666;
        border-color: #666666;
        height: 10px;
        width: 10px;

        border-radius: 10px;
        border-width: 2px;
    }







    #check_faces{

        position: absolute;
        float: left;
        clear: left;
        top: 79.8%;
        margin-left: 33.2%;

        }

        #check_forces_f1{

        position: absolute;
        float: left;
        clear: left;
        top: 82.8%;
        margin-left: 34.2%;

        }

        #check_forces_f2{

        position: absolute;
        float: left;
        clear: left;
        top: 85.8%;
        margin-left: 34.2%;

        }

        #check_forces_f3{

        position: absolute;
        float: left;
        clear: left;
        top: 88.8%;
        margin-left: 34.2%;

        }

        #check_applyface{

        position: absolute;
        float: left;
        clear: left;
        top: 82.7%;
        margin-left: 82.6%;

        }

    #check_mink{

        position: absolute;
        float: left;
        clear: left;
        top: 79.8%;
        margin-left: 17.2%;

        }

</style>


<script>
    var handle1 = $( "#custom-handle" );
    var renderer;
    var orbit_ctrl;
    //var camera;
    var Ctrl_pts = [];
    var Ctrl_tubes = [];
    var trfm_ctrl;
    var transformControls2;
    var lattice_line_material = new THREE.MeshPhongMaterial({
        color: "green"
    });
    var lattice_line_material1 = new THREE.MeshPhongMaterial({
        color: 0x3b3b3b
    });
    var lattice_line_material2 = new THREE.MeshPhongMaterial({
        color: 0x3b3b3b
    });
    var lattice_line_material3 = new THREE.MeshPhongMaterial({
        color: 0x3b3b3b
    });

    var arrow_material = new THREE.MeshPhongMaterial({
        color: 0x000080
    });

    var DragPointMat = new THREE.MeshPhongMaterial({ color: 0x696969, transparent: true, opacity: 0.8 });

    var rayCaster = new THREE.Raycaster();
    var mouse = new THREE.Vector2();

    var f1;

    var control_right;

    var controls_scale = new function () {
        this.scale = 0;
        this.MaxScale = 3;

        this.Force_face = true;
        this.Arrow_face = false;
        this.Force_Arrow = true;
        this.Scale_face = false;

        this.Control_Face = false;
        this.ForceFace_left = false;

        this.Cell_Faces = false;

        this.A = false;
        this.B = false;
        this.C = false;
        this.D = false;

        this.AB = false;
        this.AC = false;
        this.AD = false;
        this.BC = false;
        this.BD = false;
        this.CD = false;

        this.Pair_Control = false;
    };

    var tubethick = new function () {
        this.v = 0.05;
    }

    var flen = new function () {
        this.l = 2;
    }

    var FP_B = new function () {
        this.x = 0;
        this.y = 1;
    }
    var FP_C = new function () {
        this.x = 0;
        this.y = -1.2;
    }

    var FP_D = new function () {
        this.x = -1;
        this.y = -1;
    }
    var Dlen1 = new function () {
        this.l = 0.5;

    }
    var Dlen2 = new function () {
        this.l = 0.5;

    }
    var Dlen3 = new function () {
        this.l = 0.5;

    }
    var Dlen4 = new function () {
        this.l = 0.5;

    }
    var cp1 = new function () {
        this.z = -1;

    }
    var cp2 = new function () {
        this.z = -1.2;

    }
    var cp3 = new function () {
        this.z = -1.2;

    }
    var cp4 = new function () {
        this.z = -1.2;

    }

    var fo = new function () {
        this.x = -1;
        this.y = 0;
        this.z = -2;

    }
    var o1 = new function () {
        this.l = 2;


    }

    var o2 = new function () {
        this.l = 2;


    }

    var formo2 = new function () {
        this.l = 1;


    }

    var minkscale1 = new function () {
        this.l = 0.2;


    }

    var support1x1 = new function () {
        this.l = -2;


    }
    var support1y1 = new function () {
        this.l = 0;


    }

    var support2x1 = new function () {
        this.l = 0;


    }
    var support2y1 = new function () {
        this.l = 1;


    }
    var forcescale_1 = new function () {
        this.l = 4;


    }

    var applyload_1 = new function () {
        this.l = 5;


    }

    var applyload_2 = new function () {
        this.l = 5;


    }

    var applyload_3 = new function () {
        this.l = 5;


    }


    var forcescale_2 = new function () {
        this.l = 2;


    }

    var forcescale_3 = new function () {
        this.l = 2;


    }
    var forcescale_4 = new function () {
        this.l = 2;


    }
    var forcescale_5 = new function () {
        this.l = 2;


    }

    var foffset = new function () {
        this.l = 0.8;


    }

    var triP3 = new function () {
        this.z = 0;

    }


    function initRender() {
        renderer = new THREE.WebGLRenderer({ alpha: true });
        //renderer.setClearColor(new THREE.Color(0xf5f5f5));
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.shadowMapEnabled = true;
        renderer.shadowMaptype = THREE.PCFSoftShadowMap;
        renderer.localClippingEnabled = true;
        //renderer.shadowMapType=THREE.PCFSoftShadowMap;
        document.body.appendChild(renderer.domElement);


    }

    var camera;
    var cameraOrtho;
    function initCamera() {
        camera = new THREE.PerspectiveCamera(45, window.innerWidth / (window.innerHeight * 2), 0.1, 200);
        camera.position.set(10, 0, 0);

        camera.up.x = 0;
        camera.up.y = 0;
        camera.up.z = 1;

        camera.lookAt({
            x: 0,
            y: 0,
            z: 0
        });

        cameraOrtho = new THREE.OrthographicCamera( - window.innerWidth / 2, window.innerWidth / 2, window.innerHeight / 2, - window.innerHeight / 2, 1, 10 );
				cameraOrtho.position.z = 10;


    }

    var scene, scene2, sceneOrtho1, sceneOrtho2;

    function initScene() {
        scene = new THREE.Scene();

        scene2 = new THREE.Scene();

        sceneOrtho1 = new THREE.Scene();
        sceneOrtho2 = new THREE.Scene();

    }

    var light;

    function initLight() {
        scene.add(new THREE.AmbientLight(0x404040));

        light = new THREE.DirectionalLight(0xffffff);
        light.position.set(1, 1, 1);
        scene.add(light);

    }





    var form_group
    var form_group_mink
    var form_group_faces
    var form_group_forces
    var form_group_forces2
    var form_group_forces3
    var force_group
    var force_group_test
    var form_sigima_1
    var form_sigima_2
    var force_gamma_1
    var force_gamma_2
    var force_cell
    var form_trial
    var form_closingplane
    var form_greenfaces
    var face_arrow1;
    var face_arrow2;
    var face_arrow3;
    var face_arrow4;

    var mesh_left;
    var mesh_left_pair;
    var mesh_left_ForceFace;
    var corePoint_body;
    var corePoint_body2;

    var Change_N3N4 = false;

    //var



    function addControl(x, y, z) {
        var controls = new function () {
            this.x = x;
            this.y = y;
            this.z = z;
        };

        return controls;
    }

    $("#applyload_1").slider({

        orientation: "horizontal",

        range: "min",
        max: 40,
        min: 5,
        step: 1,
        round: 1


    });

    $("#applyload_2").slider({

        orientation: "horizontal",

        range: "min",
        max: 40,
        min: 5,
        step: 1,
        round: 1


    });

    $("#applyload_3").slider({

        orientation: "horizontal",

        range: "min",
        max: 40,
        min: 5,
        step: 1,
        round: 1


    });

    $("#forcescale_1").slider({

        orientation: "horizontal",

        range: "min",
        max: 6,
        min: 0,
        step: 0.01,
        round: 1


    });

    $("#forcescale_2").slider({

        orientation: "horizontal",

        range: "min",
        max: 6,
        min: 0,
        step: 0.01,
        round: 1


    });

    $("#forcescale_3").slider({

        orientation: "horizontal",

        range: "min",
        max: 6,
        min: 0,
        step: 0.01,
        round: 1


    });

    $("#forcescale_4").slider({

        orientation: "horizontal",

        range: "min",
        max: 6,
        min: 0,
        step: 0.01,
        round: 1


    });


    $("#forcescale_5").slider({

        orientation: "horizontal",

        range: "min",
        max: 6,
        min: 0,
        step: 0.01,
        round: 1


    });



    $( "#minkscale" ).slider({
        orientation: "horizontal",

    range: "min",
    max: 0.35,
    min: 0.1,
    step: 0.01,
    round: 1,
      create: function() {
        handle1.text( $( this ).slider( "value" ) );
      },
      slide: function( event, ui ) {
        handle1.text( ui.value );
      }
    });


    // $("#minkscale").slider({

    //     orientation: "horizontal",

    //     range: "min",
    //     max: 2,
    //     min: 0,
    //     step: 0.01,
    //     round: 1,

    // });


    $("#support1x").slider({

        orientation: "horizontal",

        range: "min",
        max: 1,
        min: -2,
        step: 0.01,
        round: 1


    });
    $("#support1y").slider({

        orientation: "horizontal",

        range: "min",
        max: 1,
        min: -1,
        step: 0.01,
        round: 1


    });

    $("#support2x").slider({

        orientation: "horizontal",

        range: "min",
        max: 1,
        min: -2,
        step: 0.01,
        round: 1


    });
    $("#support2y").slider({

        orientation: "horizontal",

        range: "min",
        max: 1,
        min: -1,
        step: 0.01,
        round: 1


    });

    $("#minkscale").slider("value", 0.2);
    $("#support1x").slider("value", -2);
    $("#support1y").slider("value", 0);
    $("#support2x").slider("value", 0);
    $("#support2y").slider("value", 1);
    $("#forcescale_1").slider("value", 4);
    $("#forcescale_2").slider("value", 2);
    $("#forcescale_3").slider("value", 2);
    $("#forcescale_4").slider("value", 2);
    $("#forcescale_5").slider("value", 2);

    $("#applyload_1").slider("value", 5);
    $("#applyload_2").slider("value", 5);
    $("#applyload_3").slider("value", 5);

    $("#applyload_1").slider({
        slide: function (event, ui) {
            applyload_1.l = ui.value;
            redraw();
            form_group_forces.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f1").prop('checked');

            }

        });


        force_gamma_1.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f1").prop('checked');

            }

        });

        },
        change: function (event, ui) {
            applyload_1.l = ui.value;
            redraw();
            form_group_forces.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f1").prop('checked');

            }

        });
  
        force_gamma_1.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f1").prop('checked');

            }

        });

        }
    });

    $("#applyload_2").slider({
        slide: function (event, ui) {
            applyload_2.l = ui.value;
            redraw();
            form_group_forces2.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f2").prop('checked');

            }

        });

        force_gamma_2.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f2").prop('checked');

            }

        });


        },
        change: function (event, ui) {
            applyload_2.l = ui.value;
            redraw();
            form_group_forces2.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f2").prop('checked');

            }

        });
 
        force_gamma_2.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f2").prop('checked');

            }

        });

        }
    });

    $("#applyload_3").slider({
        slide: function (event, ui) {
            applyload_3.l = ui.value;
            redraw();
            form_group_forces3.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f3").prop('checked');

            }

        });

        },
        change: function (event, ui) {
            applyload_3.l = ui.value;
            redraw();
            form_group_forces3.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f3").prop('checked');

            }

        });
        }
    });

    $("#forcescale_1").slider({
        slide: function (event, ui) {
            forcescale_1.l = ui.value;
            redraw();

            form_group_forces.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f1").prop('checked');

            }

        })

        form_group_forces2.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f2").prop('checked');

            }

        });

        form_group_forces3.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f3").prop('checked');

            }

        });



        force_gamma_2.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f2").prop('checked');

            }

        });

        force_gamma_1.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f1").prop('checked');

            }

        });

        },
        change: function (event, ui) {
            forcescale_1.l = ui.value;
            redraw();

            form_group_forces.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f1").prop('checked');

            }

        });
        form_group_forces2.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f2").prop('checked');

            }

        });

        form_group_forces3.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f3").prop('checked');

            }

        });



        force_gamma_1.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f1").prop('checked');

            }

        });

        force_gamma_2.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f2").prop('checked');

            }

        });
        }
    });

    $("#forcescale_2").slider({
        slide: function (event, ui) {
            forcescale_2.l = ui.value;
            redraw();
            form_group_forces.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f1").prop('checked');

            }

        });

        form_group_forces2.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f2").prop('checked');

            }

        });

        form_group_forces3.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f3").prop('checked');

            }

        });
 

        force_gamma_1.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f1").prop('checked');

            }

        });

        force_gamma_2.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f2").prop('checked');

            }

        });

        },
        change: function (event, ui) {
            forcescale_2.l = ui.value;
            redraw();
            form_group_forces.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f1").prop('checked');

            }

        });
        form_group_forces2.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f2").prop('checked');

            }

        });
        form_group_forces3.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f3").prop('checked');

            }

        });


        force_gamma_1.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f1").prop('checked');

            }

        });

        force_gamma_2.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f2").prop('checked');

            }

        });

        }
    });

    $("#forcescale_3").slider({
        slide: function (event, ui) {
            forcescale_3.l = ui.value;
            redraw();
            form_group_forces.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f1").prop('checked');

            }

        });
        form_group_forces2.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f2").prop('checked');

            }

        });
        form_group_forces3.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f3").prop('checked');

            }

        });


        force_gamma_1.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f1").prop('checked');

            }

        });

        force_gamma_2.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f2").prop('checked');

            }

        });

        },
        change: function (event, ui) {
            forcescale_3.l = ui.value;
            redraw();
            form_group_forces.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f1").prop('checked');

            }

        });
        form_group_forces2.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f2").prop('checked');

            }

        });
        form_group_forces3.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f3").prop('checked');

            }

        });


        force_gamma_1.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f1").prop('checked');

            }

        });

        force_gamma_2.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f2").prop('checked');

            }

        });
        }
    });

    $("#forcescale_4").slider({
        slide: function (event, ui) {
            forcescale_4.l = ui.value;
            redraw();
            form_group_forces.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f1").prop('checked');

            }

        });
        form_group_forces2.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f2").prop('checked');

            }

        });
        form_group_forces3.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f3").prop('checked');

            }

        });

        force_gamma_1.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f1").prop('checked');

            }

        });

        force_gamma_2.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f2").prop('checked');

            }

        });

        },
        change: function (event, ui) {
            forcescale_4.l = ui.value;
            redraw();
            form_group_forces.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f1").prop('checked');

            }

        });
        form_group_forces2.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f2").prop('checked');

            }

        });
        form_group_forces3.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f3").prop('checked');

            }

        });


        force_gamma_1.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f1").prop('checked');

            }

        });

        force_gamma_2.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f2").prop('checked');

            }

        });
        }
    });
    $("#forcescale_5").slider({
        slide: function (event, ui) {
            forcescale_5.l = ui.value;
            redraw();
            form_group_forces.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f1").prop('checked');

            }

        });
        form_group_forces2.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f2").prop('checked');

            }

        });
        form_group_forces3.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f3").prop('checked');

            }

        });

        force_gamma_1.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f1").prop('checked');

            }

        });

        force_gamma_2.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f2").prop('checked');

            }

        });
        },
        change: function (event, ui) {
            forcescale_5.l = ui.value;
            redraw();
            form_group_forces.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f1").prop('checked');

            }

        });
        form_group_forces2.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f2").prop('checked');

            }

        });
        form_group_forces3.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f3").prop('checked');

            }

        });


        force_gamma_1.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f1").prop('checked');

            }

        });

        force_gamma_2.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f2").prop('checked');

            }

        });
        }
    });

    $("#support1x").slider({
        slide: function (event, ui) {
            support1x1.l = ui.value;
            redraw();

        },
        change: function (event, ui) {
            support1x1.l = ui.value;
            redraw();
        }
    });
    $("#support1y").slider({
        slide: function (event, ui) {
            support1y1.l = ui.value;
            redraw();

        },
        change: function (event, ui) {
            support1y1.l = ui.value;
            redraw();
        }
    });

    $("#support2x").slider({
        slide: function (event, ui) {
            support2x1.l = ui.value;
            redraw();

        },
        change: function (event, ui) {
            support2x1.l = ui.value;
            redraw();
        }
    });
    $("#support2y").slider({
        slide: function (event, ui) {
            support2y1.l = ui.value;
            redraw();

        },
        change: function (event, ui) {
            support2y1.l = ui.value;
            redraw();
        }
    });

    $("#minkscale").slider({

        slide: function (event, ui) {
            minkscale1.l = ui.value;
            handle1.text( ui.value );
            redraw();
            form_group.traverse(function(obj) {
            if (obj.type === "Mesh") {
                obj.material.visible =false;

            }
            if (obj.type === "LineSegments") {
                obj.material.visible =false;

            }

        });
            form_group_mink.traverse(function(obj) {
            if (obj.type === "Mesh") {
                obj.material.visible =$("#form_mink").prop('checked');

            }
            if (obj.type === "LineSegments") {
                obj.material.visible =$("#form_mink").prop('checked');

            }

        });
        form_sigima_1.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f1").prop('checked');

            }

        });
        form_sigima_2.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f2").prop('checked');

            }

        });
        },
        change: function (event, ui) {
            minkscale1.l = ui.value;
            redraw();

            if ($("#form_mink").prop('checked')){
            form_group.traverse(function(obj) {
            if (obj.type === "Mesh") {
                obj.material.visible =false;

            }
            if (obj.type === "LineSegments") {
                obj.material.visible =false;

            }

        }); }
            form_group_mink.traverse(function(obj) {
            if (obj.type === "Mesh") {
                obj.material.visible =$("#form_mink").prop('checked');

            }
            if (obj.type === "LineSegments") {
                obj.material.visible =$("#form_mink").prop('checked');

            }

        });
        form_sigima_1.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f1").prop('checked');

            }

        });
        form_sigima_2.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f2").prop('checked');

            }

        });
        }
    });

    $("#minkscale").hide()
    $("#applyload_1").hide()
    $("#applyload_2").hide()
    $("#applyload_3").hide()

    $("#form_faces").attr("checked",false);
    $("#form_faces").change(function() {
        redraw();
        form_group_faces.traverse(function(obj) {
            if (obj.type === "Mesh") {
                obj.material.visible =$("#form_faces").prop('checked');

            }

        });

    });

    $("#force_face").attr("checked",true);
    $("#force_face").change(function() {
        redraw();
        // force_group_test.children[1].visible=$("#force_face").prop('checked')
        force_group_test.children[2].visible=$("#force_face").prop('checked')
        for(i=10;i<=30;i++){
        force_group_test.children[i].visible=$("#force_face").prop('checked')
        }
        // text_closingplane_trial_group.children[i].visible=$("#Trial").prop('checked');
        // form_group_faces.traverse(function(obj) {
        //     if (obj.type === "Mesh") {
        //         obj.material.visible =$("#force_face").prop('checked');

        //     }

        // });

    });

    $("#form_forces_f1").attr("checked",false);
    $("#form_forces_f1").change(function() {
        redraw();
        if ($("#form_forces_f1").prop('checked')){
        form_group_forces.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f1").prop('checked');

            }

        });
 
        force_gamma_1.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f1").prop('checked');

            }

        });
        $("#applyload_1").show(800)
        // $("#applyload_2").show(800)
        // $("#applyload_3").show(800)
    }
    else{
        
        $("#applyload_1").hide()
        // $("#applyload_2").hide()
        // $("#applyload_3").hide()
    }
    });

    $("#form_forces_f2").attr("checked",false);
    $("#form_forces_f2").change(function() {
        redraw();
        if ($("#form_forces_f2").prop('checked')){
        form_group_forces2.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f2").prop('checked');

            }

        });
        //$("#applyload_1").show(800)
         $("#applyload_2").show(800)
        // $("#applyload_3").show(800)

        force_gamma_2.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f2").prop('checked');

            }

        });
    }
    else{
        //$("#applyload_1").hide()
         $("#applyload_2").hide()
        // $("#applyload_3").hide()
    }
    });

    $("#form_forces_f3").attr("checked",false);
    $("#form_forces_f3").change(function() {
        redraw();
        if ($("#form_forces_f3").prop('checked')){
        form_group_forces3.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f3").prop('checked');

            }

        });
        //$("#applyload_1").show(800)
        // $("#applyload_2").show(800)
         $("#applyload_3").show(800)
    }
    else{
        //$("#applyload_1").hide()
        // $("#applyload_2").hide()
         $("#applyload_3").hide()
    }
    });


    $("#form_mink").attr("checked",false);
    $("#form_mink").change(function() {
        redraw();
        if ($("#form_mink").prop('checked')){
        form_group.traverse(function(obj) {
            if (obj.type === "Mesh") {
                obj.material.visible =false;

            }
            if (obj.type === "LineSegments") {
                obj.material.visible =false;

            }

        });

        form_group_mink.traverse(function(obj) {
            if (obj.type === "Mesh") {
                obj.material.visible =$("#form_mink").prop('checked');

            }
            if (obj.type === "LineSegments") {
                obj.material.visible =$("#form_mink").prop('checked');

            }

        });
        $("#minkscale").show(800)
        form_sigima_1.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f1").prop('checked');

            }

        });
        form_sigima_2.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =$("#form_forces_f2").prop('checked');

            }

        });
    }
    else {
        form_group.traverse(function(obj) {
            if (obj.type === "Mesh") {
                obj.material.visible =true;

            }
            // if (obj.type === "LineSegments") {
            //     obj.material.visible =false;

            // }

        });
        $("#minkscale").hide()
    }

    });


    var TubePoints1 = [];
    TubePoints1.push(addControl(0, 0, 0));
    TubePoints1.push(addControl(0, 0, 1));

    var TubePoints2 = [];
    TubePoints2.push(addControl(0, 0, 0));
    TubePoints2.push(addControl(1, -1, -1));

    var TubePoints3 = [];
    TubePoints3.push(addControl(0, 0, 0));
    TubePoints3.push(addControl(-1.3660, -0.3660, -1));



    var TubePoints4 = [];
    TubePoints4.push(addControl(0, 0, 0));
    TubePoints4.push(addControl(0.3660, 1.3660, -1));

    var newPoint1 = [];
    newPoint1.push(addControl(-1.7, -1, -1));

    var newPoint2 = [];
    newPoint2.push(addControl(-0.5, -2, -1));

    var newPoint3 = [];
    newPoint3.push(addControl(1.7, 1, -1));

    var newPoint4 = [];
    newPoint4.push(addControl(0.5, 2, -1));

    var FormP_O12 = [];
    for (i = 0; i <= minkscale1.l; i++) {

        FormP_O12.push(new THREE.Vector3(-0.7 + i, -0.7 + i, 1));


    }
    // FormP_O12.push(addControl(-0.5,0.5,1));

    var form_appl1 = new THREE.Vector3(-0.6, 0.1, 0.2)
    var form_appl2 = new THREE.Vector3(0.4, 0.05, 0.2)
    var form_appl3 = new THREE.Vector3(1, 0.5, 0.2)


    var newFP_B2;

    var P_A;


    var P_B;
    var P_C;
    var P_D;

    var L;

    var P_A_Right;
    var P_B_Right;
    var P_C_Right;
    var P_D_Right;

    var P_A_Left;
    var P_B_Left;
    var P_C_Left;
    var P_D_Left;

    var P_A_Left_Pair;
    var P_B_Left_Pair;
    var P_C_Left_Pair;
    var P_D_Left_Pair;


    var corePoint_temp = new THREE.Vector3(0, 0, 0);


    var fontloaded;

    var leftMouseDown, rightMouseDown;
    var selectObj = null;
    var lastPosition;
    var lastIntersection, nowIntersection;
    var mouseX, mouseY;
    var control;





    function initModel() {


        L = controls_scale.scale;//scale

        Cal_ForcesPnt();
        Force_move_left();
        redraw();

        // Transform control (a triad)
        trfm_ctrl = new THREE.TransformControls(camera, renderer.domElement);
        trfm_ctrl.addEventListener('change', render);

        trfm_ctrl.addEventListener('objectChange', function (e) {

            if (Math.abs(selectObj.position.x) <= 2 && Math.abs(selectObj.position.y) <= 2 && Math.abs(selectObj.position.z) <= 2) {



                if (selectObj.name.charAt(2) === '2') {
                    newFP_B2.x = selectObj.position.x;
                    newFP_B2.y = selectObj.position.y;
                    newFP_B2.z = selectObj.position.z;



                }

                if (selectObj.name.charAt(2) === '6') {

                    form_appl1.x = selectObj.position.x;
                    form_appl1.y = selectObj.position.y;
                    form_appl1.z = selectObj.position.z + 0.4;

                }

                if (selectObj.name.charAt(2) === '7') {
                    form_appl2.x = selectObj.position.x;
                    form_appl2.y = selectObj.position.y;
                    form_appl2.z = selectObj.position.z + 0.4;



                }
                if (selectObj.name.charAt(2) === '8') {
                    form_appl3.x = selectObj.position.x;
                    form_appl3.y = selectObj.position.y;
                    form_appl3.z = selectObj.position.z + 0.4;



                }
                if (selectObj.name.charAt(2) === '9') {
                    newPoint4[0].x = selectObj.position.x;
                    newPoint4[0].y = selectObj.position.y;
                    newPoint4[0].z = selectObj.position.z;



                }

                redraw();

            }


            //render();
        });

        trfm_ctrl.addEventListener('mouseDown', (evt) => {

            orbit_ctrl.enabled = false;


        });
        trfm_ctrl.addEventListener('mouseUp', (evt) => {

            orbit_ctrl.enabled = true;
        });





        scene.add(trfm_ctrl);



        document.addEventListener('mousedown', onMouseDown);
        document.addEventListener('mouseup', onMouseUp);
        document.addEventListener('mousemove', onMouseMove);
        //document.addEventListener('wheel', onMouseWheel);

        document.oncontextmenu = function (event) {
            event.preventDefault();
        };



        var ambient = new THREE.AmbientLight(0xffffff);
        scene.add(ambient);
        scene2.add(ambient.clone());

        var light = new THREE.DirectionalLight(0xffffff);
        // light.position.set( 1, 1, 1 ).normalize();
        light.position.set(0, 0, 20);
        light.shadow.camera.left = -30; // or whatever value works for the scale of your scene
        light.shadow.camera.right = 30;
        light.shadow.camera.top = 30;
        light.shadow.camera.bottom = -30;
        light.shadow.camera.near = 0.01;
        light.shadow.camera.far = 100;
        light.castShadow = true;
        light.shadowMapHeight = 4096;
        light.shadowMapWidth = 4096;
        //light.shadow.map.width=512;
        //light.shadow.map.height=1000;

        scene.add(light);
        scene2.add(light.clone());

        // var helper = new THREE.CameraHelper( light.shadow.camera );
        // scene1.add( helper );


        // ground plane for shadow effects
        var FLOOR = - 2.5;
        var geometry = new THREE.PlaneBufferGeometry(100, 100);
        // var planeMaterial = new THREE.MeshLambertMaterial( { color: 0xdddddd } );
        var planeMaterial = new THREE.ShadowMaterial();
        planeMaterial.opacity = 0.2;
        var ground = new THREE.Mesh(geometry, planeMaterial);
        ground.position.set(0, 0, FLOOR);
        ground.rotation.x = 0;
        ground.scale.set(100, 100, 100);
        ground.castShadow = false;
        ground.receiveShadow = true;
        scene.add(ground);
        scene2.add(ground.clone());



    }

    function createCircleFaceArrow(centerPt, radius, arr_dir) {

        var Vec_a = cross(arr_dir, new THREE.Vector3(1, 0, 0));

        if (Vec_a.x === 0 && Vec_a.y === 0 && Vec_a.z === 0) {
            Vec_a = cross(arr_dir, new THREE.Vector3(0, 1, 0));
        }

        var Vec_b = cross(arr_dir, Vec_a);

        Vec_a.normalize();
        Vec_b.normalize();

        // console.log("vec_a,vec_b",Vec_a,Vec_b);

        var points = [];
        var length = 20;


        for (i = 0; i <= length; i++) {
            var Pts_Circle = new THREE.Vector3(0, 0, 0);
            Pts_Circle.x = centerPt.x + radius * Vec_a.x * Math.cos(Math.PI * 1.5 * i / length) + radius * Vec_b.x * Math.sin(Math.PI * 1.5 * i / length);
            Pts_Circle.y = centerPt.y + radius * Vec_a.y * Math.cos(Math.PI * 1.5 * i / length) + radius * Vec_b.y * Math.sin(Math.PI * 1.5 * i / length);
            Pts_Circle.z = centerPt.z + radius * Vec_a.z * Math.cos(Math.PI * 1.5 * i / length) + radius * Vec_b.z * Math.sin(Math.PI * 1.5 * i / length);

            points.push(Pts_Circle);

        }

        var geometrySpacedPoints = new THREE.BufferGeometry().setFromPoints(points);
        //var line2 = new THREE.Line( geometrySpacedPoints, material);

        var arcMaterial = new THREE.LineDashedMaterial({
            color: 0x00ff00,//color
            dashSize: 0.1,//size
            gapSize: 0.05//dis
        });



        var CircleMesh = new THREE.Line(geometrySpacedPoints, arcMaterial);

        //console.log("points=",points[1],points[5]);

        CircleMesh.computeLineDistances();//compute

        var arrow_material1 = new THREE.MeshBasicMaterial({
            color: "white"//green
        });

        // var CircleMesh=createCylinderMesh(points[0],points[1],arrow_material1,0.02,0.02);

        for (i = 0; i < length; i++) {
            var CircleMesh1 = createCylinderMesh(points[i], points[i + 1], arrow_material1, 0.005, 0.005);
            CircleMesh.add(CircleMesh1);
        }

        var Arr_Pt1 = new THREE.Vector3(0, 0, 0);

        Arr_Pt1.x = centerPt.x + radius * Vec_a.x * Math.cos(Math.PI * 1.6 * i / length) + radius * Vec_b.x * Math.sin(Math.PI * 1.6 * i / length);
        Arr_Pt1.y = centerPt.y + radius * Vec_a.y * Math.cos(Math.PI * 1.6 * i / length) + radius * Vec_b.y * Math.sin(Math.PI * 1.6 * i / length);
        Arr_Pt1.z = centerPt.z + radius * Vec_a.z * Math.cos(Math.PI * 1.6 * i / length) + radius * Vec_b.z * Math.sin(Math.PI * 1.6 * i / length);


        var face_arrow1 = createCylinderArrowMesh(points[length], Arr_Pt1, arrow_material1, 0.01, 0.02, 0.01);

        CircleMesh.add(face_arrow1);



        // CircleMesh.position.x=centerPt.x;
        // CircleMesh.position.y=centerPt.y;
        // CircleMesh.position.z=centerPt.z;
        //scene2.add(CircleMesh);

        return CircleMesh;


    }

    function createCircleFaceArrow2(centerPt, radius, arr_dir) {

        var Vec_a = cross(arr_dir, new THREE.Vector3(1, 0, 0)); //

        if (Vec_a.x === 0 && Vec_a.y === 0 && Vec_a.z === 0) {
            Vec_a = cross(arr_dir, new THREE.Vector3(0, 1, 0));//
        }

        var Vec_b = cross(arr_dir, Vec_a);

        Vec_a.normalize();
        Vec_b.normalize();

        // console.log("vec_a,vec_b",Vec_a,Vec_b);

        var points = [];
        var length = 20;


        for (i = 0; i <= length; i++) {
            var Pts_Circle = new THREE.Vector3(0, 0, 0);
            Pts_Circle.x = centerPt.x + radius * Vec_a.x * Math.cos(Math.PI * 1.5 * i / length) + radius * Vec_b.x * Math.sin(Math.PI * 1.5 * i / length);
            Pts_Circle.y = centerPt.y + radius * Vec_a.y * Math.cos(Math.PI * 1.5 * i / length) + radius * Vec_b.y * Math.sin(Math.PI * 1.5 * i / length);
            Pts_Circle.z = centerPt.z + radius * Vec_a.z * Math.cos(Math.PI * 1.5 * i / length) + radius * Vec_b.z * Math.sin(Math.PI * 1.5 * i / length);

            points.push(Pts_Circle);

        }

        var geometrySpacedPoints = new THREE.BufferGeometry().setFromPoints(points);
        //var line2 = new THREE.Line( geometrySpacedPoints, material);

        var arcMaterial = new THREE.LineDashedMaterial({
            color: 0x00ff00,//color
            dashSize: 0.1,//size
            gapSize: 0.05//dis
        });



        var CircleMesh = new THREE.Line(geometrySpacedPoints, arcMaterial);

        //console.log("points=",points[1],points[5]);

        CircleMesh.computeLineDistances();//compute

        var arrow_material1 = new THREE.MeshPhongMaterial({
            color: 0x009600//green
        });

        // var CircleMesh=createCylinderMesh(points[0],points[1],arrow_material1,0.02,0.02);

        for (i = 0; i < length; i++) {
            var CircleMesh1 = createCylinderMesh(points[i], points[i + 1], arrow_material1, 0.005, 0.005);
            CircleMesh.add(CircleMesh1);
        }

        var Arr_Pt1 = new THREE.Vector3(0, 0, 0);

        Arr_Pt1.x = centerPt.x + radius * Vec_a.x * Math.cos(Math.PI * 1.6 * i / length) + radius * Vec_b.x * Math.sin(Math.PI * 1.6 * i / length);
        Arr_Pt1.y = centerPt.y + radius * Vec_a.y * Math.cos(Math.PI * 1.6 * i / length) + radius * Vec_b.y * Math.sin(Math.PI * 1.6 * i / length);
        Arr_Pt1.z = centerPt.z + radius * Vec_a.z * Math.cos(Math.PI * 1.6 * i / length) + radius * Vec_b.z * Math.sin(Math.PI * 1.6 * i / length);


        var face_arrow1 = createCylinderArrowMesh(points[length], Arr_Pt1, arrow_material1, 0.01, 0.02, 0.01);

        CircleMesh.add(face_arrow1);



        // CircleMesh.position.x=centerPt.x;
        // CircleMesh.position.y=centerPt.y;
        // CircleMesh.position.z=centerPt.z;
        //scene2.add(CircleMesh);

        return CircleMesh;


    }

    function createCylinderMesh(pointX, pointY, material1, radius, radius2) {
        if (radius === undefined) {
            radius = 1;
        }

        if (radius2 === undefined) {
            radius2 = radius;
        }

        var direction = new THREE.Vector3().subVectors(pointY, pointX);
        var orientation = new THREE.Matrix4();
        orientation.lookAt(pointX, pointY, new THREE.Object3D().up);
        orientation.multiply(new THREE.Matrix4().set(1, 0, 0, 0,
            0, 0, 1, 0,
            0, -1, 0, 0,
            0, 0, 0, 1));
        var edgeGeometry = new THREE.CylinderGeometry(radius, radius2, direction.length(), 8, 1);
        var edge = new THREE.Mesh(edgeGeometry, material1);
        edge.applyMatrix4(orientation);
        // position based on midpoints - there may be a better solution than this
        edge.position.x = (pointY.x + pointX.x) / 2;
        edge.position.y = (pointY.y + pointX.y) / 2;
        edge.position.z = (pointY.z + pointX.z) / 2;


        //console.log("pos=", edge.position.x);
        return edge;
    }

    function create_TriangleMesh(p1, p2, p3, direction, coreScale) {

        var corepoint = face_center(p1, p2, p3);



        var unit_direction = new THREE.Vector3();//normal
        unit_direction.x = direction.x / norm(direction);
        unit_direction.y = direction.y / norm(direction);
        unit_direction.z = direction.z / norm(direction);


        // var Scale_direction=new THREE.Vector3();

        // Scale_direction.x=1.2*unit_direction.x;
        // Scale_direction.y=1.2*unit_direction.y;
        // Scale_direction.z=1.2*unit_direction.z;


        var direction1 = new THREE.Vector3().subVectors(coreScale, corepoint);
        var m = direction1.length();





        //move point

        var p1_1 = new THREE.Vector3();
        p1_1.x = p1.x + m * unit_direction.x;
        p1_1.y = p1.y + m * unit_direction.y;
        p1_1.z = p1.z + m * unit_direction.z;

        var p2_1 = new THREE.Vector3();
        p2_1.x = p2.x + m * unit_direction.x;
        p2_1.y = p2.y + m * unit_direction.y;
        p2_1.z = p2.z + m * unit_direction.z;

        var p3_1 = new THREE.Vector3();
        p3_1.x = p3.x + m * unit_direction.x;
        p3_1.y = p3.y + m * unit_direction.y;
        p3_1.z = p3.z + m * unit_direction.z;

        //console.log("p1=",p1,"p2=",p2,"p3=",p3,"p1_1=",p1_1,"p2_1=",p2_1,"p3_1=",p3_1,"direction",direction,"dis",dis);


        //tri

        var vertices_tri = [
            p1, p2, p3, p1_1, p2_1, p3_1
        ];

        var faces_tri = [
            new THREE.Face3(0, 1, 2),
            new THREE.Face3(0, 4, 1),
            new THREE.Face3(2, 1, 4),
            new THREE.Face3(0, 3, 4),
            new THREE.Face3(2, 4, 5),
            new THREE.Face3(0, 3, 5),
            new THREE.Face3(2, 0, 5),
            new THREE.Face3(3, 4, 5)

        ];



        var geom_tri = new THREE.Geometry();
        geom_tri.vertices = vertices_tri;
        geom_tri.faces = faces_tri;
        geom_tri.computeFaceNormals();


        for (i = 0; i < geom_tri.faces.length; i++) {
            var hex = 0x156289;
            geom_tri.faces[i].color.setHex(hex);
        }

        //  var materials = new THREE.MeshBasicMaterial( {
        // vertexColors: THREE.FaceColors
        // } );





        var materials_tri = [
            //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
            //       new THREE.MeshBasicMaterial({color: 0x156289, wireframe: true,transparent: true,opacity:0.001}),
            new THREE.MeshPhongMaterial({
                vertexColors: THREE.FaceColors, transparent: true, opacity: 0.1, side: THREE.DoubleSide
            })
        ];



        var mesh_tri = new THREE.SceneUtils.createMultiMaterialObject(geom_tri, materials_tri);


        //var polyhedron =createMesh(new THREE.PolyhedronGeometry(vertices,faces));
        return mesh_tri;

    }

    function createTextMesh(text, position) {



        //var text = "three.js";
        var loader = new THREE.FontLoader();
        var posdir = Pnt_copy(position);

        posdir.normalize();





        loader.load('libs/fonts/optimer_regular.typeface.json', function (font1) {



            // mat
            var fontMaterial = new THREE.MeshLambertMaterial({
                color: 0x2F4F4F,
                side: THREE.DoubleSide
            });


            var options = {

                size: 0.15, //size
                height: 0.04, //h
                weight: 'normal', //bold
                font: font1, //type
                style: 'italics', //type
                bevelThickness: 0.01, //th
                bevelSize: 0.01, //wide
                curveSegments: 10,//seg
                bevelEnabled: true, //true

            }

            //var text1 = new THREE.FontLoader().load('libs/fonts/helvetiker_bold.typeface.json', function(text) {
            var gem = new THREE.TextGeometry(text, options);


            var font2 = new THREE.Mesh(gem, fontMaterial);


            font2.position.x = position.x + 0.5 * posdir.x; //* (fontGeometry.boundingBox.max.x - fontGeometry.boundingBox.min.x);
            font2.position.y = position.y + 0.5 * posdir.y;
            font2.position.z = position.z + 0.5 * posdir.z;
            font2.rotation.x = Math.PI / 2;
            font2.rotation.y = Math.PI / 2;

            text_group1.add(font2);


        });





        //return font;





    }

    function createStillText(text,text2) {
        //canva
        var canvas = document.createElement("canvas");
        canvas.width = 440;
        canvas.height = 340;
        var ctx = canvas.getContext("2d");

        ctx.fillStyle = "black";
        ctx.font = "80px Palatino";
        ctx.lineWidth = 2;
        ctx.fillText(text, 150, 150);

        ctx.fillStyle = "black";
        ctx.font = "30px Palatino";
        ctx.lineWidth = 2;
        ctx.fillText(text2,300,120);



        // var texture = new THREE.Texture(canvas);
        // texture.needsUpdate = true;

        // // //text
        // // var material = new THREE.SpriteMaterial({ map: texture, depthWrite:false });
        // // var textObj = new THREE.Sprite(material);
        // // textObj.scale.set(0.7, 0.7, 0.7);
       


        // //textObj.position.set(pos1);

        // // var posdir = Pnt_copy(pos);

        // // posdir.normalize();

        // // textObj.position.x = pos.x  //* (fontGeometry.boundingBox.max.x - fontGeometry.boundingBox.min.x);
        // // textObj.position.y = pos.y
        // // textObj.position.z = pos.z


        // return ctx;
    }



    function createSpriteText(text, pos) {
        //canva
        var canvas = document.createElement("canvas");
        canvas.width = 240;
        canvas.height = 240;
        var ctx = canvas.getContext("2d");
        ctx.fillStyle = "grey";
        ctx.font = "Bold 100px Palatino";
        ctx.lineWidth = 2;
        ctx.fillText(text.charAt(0), 150, 150);
        ctx.fillStyle = "grey";
        ctx.font = "50px Palatino";
        ctx.lineWidth = 2;
        ctx.fillText(text.charAt(1), 210, 170);

        var texture = new THREE.Texture(canvas);
        texture.needsUpdate = true;

        //text
        var material = new THREE.SpriteMaterial({ map: texture, transparent: true });
        var textObj = new THREE.Sprite(material);
        textObj.scale.set(0.5, 0.5, 0.5);


        //textObj.position.set(pos1);

        var posdir = Pnt_copy(pos);

        posdir.normalize();

        textObj.position.x = pos.x + 0.2 * posdir.x; //* (fontGeometry.boundingBox.max.x - fontGeometry.boundingBox.min.x);
        textObj.position.y = pos.y + 0.3 * posdir.y;
        textObj.position.z = pos.z + 0.1 * posdir.z;


        return textObj;
    }

    function createSpriteText3(text, pos) {
        //canva
        var canvas = document.createElement("canvas");
        canvas.width = 240;
        canvas.height = 240;
        var ctx = canvas.getContext("2d");
        ctx.fillStyle = "black";
        ctx.font = "Bold 100px Palatino";
        ctx.lineWidth = 2;
        ctx.fillText(text.charAt(0), 150, 150);
        ctx.fillStyle = "black";
        ctx.font = "50px Palatino";
        ctx.lineWidth = 2;
        ctx.fillText(text.charAt(1), 190, 170);

        var texture = new THREE.Texture(canvas);
        texture.needsUpdate = true;

        //text
        var material = new THREE.SpriteMaterial({ map: texture, transparent: true });
        var textObj = new THREE.Sprite(material);
        textObj.scale.set(0.5, 0.5, 0.5);


        //textObj.position.set(pos1);

        var posdir = Pnt_copy(pos);

        posdir.normalize();

        textObj.position.x = pos.x + 0.18 * posdir.x; //* (fontGeometry.boundingBox.max.x - fontGeometry.boundingBox.min.x);
        textObj.position.y = pos.y + 0.18 * posdir.y;
        textObj.position.z = pos.z + 0.18 * posdir.z;


        return textObj;
    }

    function createSpriteText5(text, pos) {
        //canva
        var canvas = document.createElement("canvas");
        canvas.width = 240;
        canvas.height = 240;
        var ctx = canvas.getContext("2d");
        ctx.fillStyle = "black";
        ctx.font = "Bold 100px Palatino";
        ctx.lineWidth = 2;
        ctx.fillText(text.charAt(0), 150, 150);
        ctx.fillStyle = "black";
        ctx.font = "50px Palatino";
        ctx.lineWidth = 2;
        ctx.fillText(text.charAt(1), 190, 170);

        var texture = new THREE.Texture(canvas);
        texture.needsUpdate = true;

        //text
        var material = new THREE.SpriteMaterial({ map: texture, transparent: true });
        var textObj = new THREE.Sprite(material);
        textObj.scale.set(0.5, 0.5, 0.5);


        //textObj.position.set(pos1);

        var posdir = Pnt_copy(pos);

        posdir.normalize();

        textObj.position.x = pos.x + 0.5 * posdir.x; //* (fontGeometry.boundingBox.max.x - fontGeometry.boundingBox.min.x);
        textObj.position.y = pos.y + 0.5 * posdir.y;
        textObj.position.z = pos.z + 0.5 * posdir.z;


        return textObj;
    }

    function createSpriteText6(text, pos) {
        //canva
        var canvas = document.createElement("canvas");
        canvas.width = 240;
        canvas.height = 240;
        var ctx = canvas.getContext("2d");
        ctx.fillStyle = "black";
        ctx.font = "Bold 100px Palatino";
        ctx.lineWidth = 2;
        ctx.fillText(text.charAt(0), 150, 150);
        ctx.fillStyle = "black";
        ctx.font = "50px Palatino";
        ctx.lineWidth = 2;
        ctx.fillText(text.charAt(1), 190, 170);

        var texture = new THREE.Texture(canvas);
        texture.needsUpdate = true;

        //text
        var material = new THREE.SpriteMaterial({ map: texture, transparent: true });
        var textObj = new THREE.Sprite(material);
        textObj.scale.set(0.5, 0.5, 0.5);


        //textObj.position.set(pos1);

        var posdir = Pnt_copy(pos);

        posdir.normalize();

        textObj.position.x = pos.x + 0.2 * posdir.x; //* (fontGeometry.boundingBox.max.x - fontGeometry.boundingBox.min.x);
        textObj.position.y = pos.y + 0.2 * posdir.y;
        textObj.position.z = pos.z + 0.2 * posdir.z;


        return textObj;
    }

    function createSpriteText4(text, pos) {
        //canva
        var canvas = document.createElement("canvas");
        canvas.width = 240;
        canvas.height = 240;
        var ctx = canvas.getContext("2d");
        ctx.fillStyle = 0xDCDCDC;
        ctx.font = "80px Arial";
        ctx.lineWidth = 2;
        ctx.fillText(text.charAt(0), 150, 150);
        ctx.fillStyle = 0xDCDCDC;
        ctx.font = "50px Arial";
        ctx.lineWidth = 2;
        ctx.fillText(text.charAt(1), 190, 150);

        var texture = new THREE.Texture(canvas);
        texture.needsUpdate = true;

        //text
        var material = new THREE.SpriteMaterial({ map: texture, transparent: true });
        var textObj = new THREE.Sprite(material);
        textObj.scale.set(0.5, 0.5, 0.5);


        //textObj.position.set(pos1);

        var posdir = Pnt_copy(pos);

        posdir.normalize();

        textObj.position.x = pos.x + 0.1 * posdir.x; //* (fontGeometry.boundingBox.max.x - fontGeometry.boundingBox.min.x);
        textObj.position.y = pos.y + 0.1 * posdir.y;
        textObj.position.z = pos.z + 0.1 * posdir.z;


        return textObj;
    }

    function createSpriteText1(text,text2, pos) {
        //canva
        var canvas = document.createElement("canvas");
        canvas.width = 440;
        canvas.height = 340;
        var ctx = canvas.getContext("2d");

        ctx.fillStyle = "black";
        ctx.font = "80px Palatino";
        ctx.lineWidth = 2;
        ctx.fillText(text, 150, 150);

        ctx.fillStyle = "black";
        ctx.font = "30px Palatino";
        ctx.lineWidth = 2;
        ctx.fillText(text2,300,120);



        var texture = new THREE.Texture(canvas);
        texture.needsUpdate = true;

        //text
        var material = new THREE.SpriteMaterial({ map: texture, depthWrite:false });
        var textObj = new THREE.Sprite(material);
        textObj.scale.set(0.7, 0.7, 0.7);


        //textObj.position.set(pos1);

        var posdir = Pnt_copy(pos);

        posdir.normalize();

        textObj.position.x = pos.x  //* (fontGeometry.boundingBox.max.x - fontGeometry.boundingBox.min.x);
        textObj.position.y = pos.y
        textObj.position.z = pos.z


        return textObj;
    }

    function createSpriteText_loads(text,text2,text3,text4,text5, pos) {
        //canva
        var canvas = document.createElement("canvas");
        canvas.width = 830;
        canvas.height = 680;
        var ctx = canvas.getContext("2d");

        ctx.fillStyle = "black";
        ctx.font = "Bold 200px Palatino";
        ctx.lineWidth = 2;
        ctx.fillText(text, 150, 150);

        ctx.fillStyle = "black";
        ctx.font = "100px Palatino";
        ctx.lineWidth = 2;
        ctx.fillText(text2,230,160);

        ctx.fillStyle = "black";
        ctx.font = "100px Palatino";
        ctx.lineWidth = 2;
        ctx.fillText(text3, 290, 140);

        ctx.fillStyle = "black";
        ctx.font = "160px Palatino";
        ctx.lineWidth = 2;
        ctx.fillText(text4, 350, 150);

        ctx.fillStyle = "black";
        ctx.font = "80px Palatino";
        ctx.lineWidth = 2;
        ctx.fillText(text5, 720, 100);




        var texture = new THREE.Texture(canvas);
        texture.needsUpdate = true;

        //text
        var material = new THREE.SpriteMaterial({ map: texture, depthWrite:false });
        var textObj = new THREE.Sprite(material);
        textObj.scale.set(0.7, 0.7, 0.7);


        //textObj.position.set(pos1);

        var posdir = Pnt_copy(pos);

        posdir.normalize();

        textObj.position.x = pos.x + 0.1 * posdir.x; //* (fontGeometry.boundingBox.max.x - fontGeometry.boundingBox.min.x);
        textObj.position.y = pos.y + 0.1 * posdir.y;
        textObj.position.z = pos.z + 0.1 * posdir.z;


        return textObj;
    }
   
   
    function createSpriteText_r3(text,text2,text3,text4, pos) {
        //canva
        var canvas1 = document.createElement("canvas");
        canvas1.width = 830;
        canvas1.height = 680;
        var ctx = canvas1.getContext("2d");

        ctx.fillStyle = "black";
        ctx.font = "Bold 30px Palatino";
        ctx.lineWidth = 2;
        ctx.fillText(text, 150, 150);

        // ctx.fillStyle = "black";
        // ctx.font = "20px Palatino";
        // ctx.lineWidth = 2;
        // ctx.fillText(text2,175,160);

        ctx.fillStyle = "black";
        ctx.font = "20px Palatino";
        ctx.lineWidth = 2;
        ctx.fillText(text3, 195, 150);

        ctx.fillStyle = "black";
        ctx.font = "30px Palatino";
        ctx.lineWidth = 2;
        ctx.fillText(text4, 230, 155);


        var texture = new THREE.Texture(canvas1);
        texture.needsUpdate = true;

        //text
        var material = new THREE.SpriteMaterial({ map: texture, depthWrite:false });
        var textObj = new THREE.Sprite(material);
        textObj.scale.set(material.map.image.width, material.map.image.height, 1 );
        // textObj.position.set( window.innerWidth / 2, window.innerHeight / 2, 0 );
        textObj.center.set( 0.2, 0.27);


        return textObj;
    }


    function createSpriteText_r2(text,text2,text3,text4, pos) {
        //canva
        var canvas = document.createElement("canvas");
        canvas.width = 830;
        canvas.height = 680;
        var ctx = canvas.getContext("2d");

        ctx.fillStyle = "black";
        ctx.font = "Bold 200px Palatino";
        ctx.lineWidth = 2;
        ctx.fillText(text, 150, 150);

        ctx.fillStyle = "black";
        ctx.font = "100px Palatino";
        ctx.lineWidth = 2;
        ctx.fillText(text2,230,190);

        ctx.fillStyle = "black";
        ctx.font = "100px Palatino";
        ctx.lineWidth = 2;
        ctx.fillText(text3, 290, 140);

        ctx.fillStyle = "black";
        ctx.font = "160px Palatino";
        ctx.lineWidth = 2;
        ctx.fillText(text4, 350, 150);


        var texture = new THREE.Texture(canvas);
        texture.needsUpdate = true;

        //text
        var material = new THREE.SpriteMaterial({ map: texture, depthWrite:false });
        var textObj = new THREE.Sprite(material);
        textObj.scale.set(0.7, 0.7, 0.7);


        //textObj.position.set(pos1);

        var posdir = Pnt_copy(pos);

        posdir.normalize();

        textObj.position.x = pos.x + 0.1 * posdir.x; //* (fontGeometry.boundingBox.max.x - fontGeometry.boundingBox.min.x);
        textObj.position.y = pos.y + 0.1 * posdir.y;
        textObj.position.z = pos.z + 0.1 * posdir.z;


        return textObj;
    }


    function createSpriteText_r(text,text3,text4, pos) {
        //canva
        var canvas = document.createElement("canvas");
        canvas.width = 830;
        canvas.height = 680;
        var ctx = canvas.getContext("2d");

        ctx.fillStyle = "black";
        ctx.font = "Bold 200px Palatino";
        ctx.lineWidth = 2;
        ctx.fillText(text, 150, 150);

        ctx.fillStyle = "black";
        ctx.font = "100px Palatino";
        ctx.lineWidth = 2;
        ctx.fillText(text3, 290, 140);

        ctx.fillStyle = "black";
        ctx.font = "160px Palatino";
        ctx.lineWidth = 2;
        ctx.fillText(text4, 350, 150);


        var texture = new THREE.Texture(canvas);
        texture.needsUpdate = true;

        //text
        var material = new THREE.SpriteMaterial({ map: texture, depthWrite:false });
        var textObj = new THREE.Sprite(material);
        textObj.scale.set(0.7, 0.7, 0.7);


        //textObj.position.set(pos1);

        var posdir = Pnt_copy(pos);

        posdir.normalize();

        textObj.position.x = pos.x + 0.1 * posdir.x; //* (fontGeometry.boundingBox.max.x - fontGeometry.boundingBox.min.x);
        textObj.position.y = pos.y + 0.1 * posdir.y;
        textObj.position.z = pos.z + 0.1 * posdir.z;


        return textObj;
    }

    function createSpriteTextstep1(text, pos) {
        //canva
        var canvas = document.createElement("canvas");
        canvas.width = 240;
        canvas.height = 240;
        var ctx = canvas.getContext("2d");
        ctx.fillStyle = "grey";
        ctx.font = "100px Palatino";
        ctx.lineWidth = 2;
        ctx.fillText(text, 150, 150);


        var texture = new THREE.Texture(canvas);
        texture.needsUpdate = true;

        //text
        var material = new THREE.SpriteMaterial({ map: texture, transparent: true });
        var textObj = new THREE.Sprite(material);
        textObj.scale.set(0.5, 0.5, 0.5);


        //textObj.position.set(pos1);

        var posdir = Pnt_copy(pos);

        posdir.normalize();

        textObj.position.x = pos.x + 0.1 * posdir.x; //* (fontGeometry.boundingBox.max.x - fontGeometry.boundingBox.min.x);
        textObj.position.y = pos.y + 0.1 * posdir.y;
        textObj.position.z = pos.z + 0.1 * posdir.z;


        return textObj;
    }

    function createTextMesh1(text, position) {



        //var text = "three.js";
        var loader = new THREE.FontLoader();
        var posdir = Pnt_copy(position);

        posdir.normalize();





        loader.load('libs/fonts/optimer_regular.typeface.json', function (font1) {



            // mat
            var fontMaterial = new THREE.MeshLambertMaterial({
                color: 0x2F4F4F,
                side: THREE.DoubleSide
            });


            var options = {

                size: 0.1, //size
                height: 0.03, //h
                weight: 'normal', //bold
                font: font1, //type
                style: 'italics', //type
                bevelThickness: 0.01, //th
                bevelSize: 0.01, //wide
                curveSegments: 10,//seg
                bevelEnabled: true, //true

            }

            //var text1 = new THREE.FontLoader().load('libs/fonts/helvetiker_bold.typeface.json', function(text) {
            var gem = new THREE.TextGeometry(text, options);



            var font2 = new THREE.Mesh(gem, fontMaterial);


            font2.position.x = position.x + 0.1 * posdir.x; //* (fontGeometry.boundingBox.max.x - fontGeometry.boundingBox.min.x);
            font2.position.y = position.y + 0.1 * posdir.y;
            font2.position.z = position.z + 0.1 * posdir.z;
            font2.rotation.x = Math.PI / 2;
            font2.rotation.y = Math.PI / 2;

            text_group2.add(font2);


        });





        //return font;





    }

    function createCylinderArrowMesh(pointX, pointY, material, radius, radiusCone, edgeLengthRatio) {

        var direction = new THREE.Vector3().subVectors(pointY, pointX);
        var l = direction.length();

        if (radius === undefined) {
            radius = l * 0.01;
        }

        // fixedConeLength = fixedConeLength !== undefined ? fixedConeLength : 4;

        if (radiusCone === undefined) {
            radiusCone = 2 * radius;
        }

        // edgeLengthRatio = edgeLengthRatio !== undefined ? edgeLengthRatio : 0.7 ;

        var pointMid = new THREE.Vector3().addVectors(pointX, edgeLengthRatio * direction);

        var orientation = new THREE.Matrix4();
        orientation.lookAt(pointX, pointY, new THREE.Object3D().up);
        orientation.multiply(new THREE.Matrix4().set(1, 0, 0, 0,
            0, 0, 1, 0,
            0, -1, 0, 0,
            0, 0, 0, 1));

        var edgeGeometry;
        var coneGeometry;
        if (edgeLengthRatio !== undefined) {
            edgeGeometry = new THREE.CylinderGeometry(radius, radius, edgeLengthRatio * l, 8, 1);
            coneGeometry = new THREE.CylinderGeometry(0, radiusCone, (1 - edgeLengthRatio) * l, 8, 1);
            edgeGeometry.translate(0, -(0.5 - 0.5 * edgeLengthRatio) * l, 0);
            var translate = new THREE.Matrix4().makeTranslation(0, (0.5 - 0.5 * (1 - edgeLengthRatio)) * l, 0);
            edgeGeometry.merge(coneGeometry, translate);
        } else {
            // fixed length cone
            var fixedConeLength = 1;
            edgeGeometry = new THREE.CylinderGeometry(radius, radius, l - fixedConeLength, 8, 1);
            coneGeometry = new THREE.CylinderGeometry(0, radiusCone, fixedConeLength, 8, 1);
            edgeGeometry.translate(0, - 0.5 * fixedConeLength, 0);
            var translate = new THREE.Matrix4().makeTranslation(0, 0.5 * (l - fixedConeLength), 0);
            edgeGeometry.merge(coneGeometry, translate);
        }



        var arrow = new THREE.Mesh(edgeGeometry, material);

        arrow.applyMatrix4(orientation);

        arrow.position.x = (pointY.x + pointX.x) / 2;
        arrow.position.y = (pointY.y + pointX.y) / 2;
        arrow.position.z = (pointY.z + pointX.z) / 2;



        return arrow;
    }

    window.addEventListener('keydown', function (event) {

        switch (event.keyCode) {

            case 87: // W
                trfm_ctrl.detach();
                //scene.remove(trfm_ctrl);
                break;


        }

    });

    function onMouseDown(event) {
        //event.preventDefault();

        rayCaster.setFromCamera(mouse, camera);


        //var rayCaster = getRay(event);
        var intersects = rayCaster.intersectObjects(Ctrl_pts);

        if (event.button === 2) {

            trfm_ctrl.detach();





        }



        //document.addEventListener('mousemove', onMouseMove);


        if (event.button === 0 && intersects[0]) {



            selectObj = intersects[0].object;
            console.log("selectobj.name=" + intersects[0].object.name.charAt(2));
            //leftMouseDown = true;
            lastPosition = selectObj.position;
            //lastIntersection = getIntersection(event);

            if (controls_scale.Pair_Control) {

                for (i = 0; i <= 1; i++) {
                    mesh_F1_pair.children[i].material.visible = false;
                    mesh_F2_pair.children[i].material.visible = false;
                    mesh_F3_pair.children[i].material.visible = false;
                    mesh_F4_pair.children[i].material.visible = false;
                    mesh_left_pair.children[i].material.visible = false;
                }

                redraw();
                for (i = 0; i <= 1; i++) {
                    mesh.children[i].material.visible = true;
                }

                // mesh_left_ForceFace.children.forEach(function (e) {
                //     e.geometry.vertices = vertices;
                //     e.geometry.verticesNeedUpdate = true;

                //     // e.geometry.faces[0].color.set(0xff00ee);
                //     // e.geometry.facesNeedUpdate=true;
                //     e.geometry.elementsNeedUpdate = true;
                //     e.geometry.computeFaceNormals();
                //     //e.geometry.center();
                // });

                Tube_group_pair.traverse(function (obj) {//hide group
                    if (obj.type === "Mesh") {
                        obj.material.visible = false;
                    }
                });

                for (i = 0; i <= 1; i++) {
                    mesh_left.children[i].material.visible = false;
                }
                mesh_F1.children[0].material.visible = false;
                mesh_F2.children[0].material.visible = false;
                mesh_F3.children[0].material.visible = false;
                mesh_F4.children[0].material.visible = false;
            }








            trfm_ctrl.attach(selectObj);
            // leftMouseDown = true;
        }

        // mouseX = event.clientX;
        // mouseY = event.clientY;

        //document.addEventListener('mousemove', onMouseMove);
    }

    function onMouseUp(event) {
        leftMouseDown = false;
        rightMouseDown = false;
        //document.removeEventListener('mousemove', onMouseMove);
    }

    function onMouseMove(event) {


        event.preventDefault();
        mouse.x = ((event.clientX * 2) / window.innerWidth) * 2 - 1;
        mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

        //mouse.x = ((event.clientX*2)/window.innerWidth) * 2 - 1;
        // mouse.y = -(event.clientY/window.innerHeight) * 2 + 1;

        //event.clientX=event.clientX/2;


        if (rightMouseDown) {

        }

        if (leftMouseDown) {

            for (i = 0; i <= 1; i++) {

                mesh_left.children[i].material.visible = false;
            }
            mesh_F1.children[0].material.visible = false;
            mesh_F2.children[0].material.visible = false;
            mesh_F3.children[0].material.visible = false;
            mesh_F4.children[0].material.visible = false;


            for (i = 0; i < 2; i++) {
                mesh_left_Cell1.children[i].material.visible = false;
                mesh_left_Cell2.children[i].material.visible = false;
                mesh_left_Cell3.children[i].material.visible = false;
                mesh_left_Cell4.children[i].material.visible = false;

            }


            // var deltaX = event.clientX - mouseX;
            // mouseX = event.clientX;
            // var deltaY = event.clientY - mouseY;
            // mouseY = event.clientY;
            // rotation(deltaX, deltaY);
        }
    }

    function redraw_Faces6() {


        var vertices = [
            new THREE.Vector3(0, 0, 0), TubePoints1[1], TubePoints2[1], TubePoints3[1], TubePoints4[1]
        ];


        //console.log("TubePoints1="+P_A.z);

        // for (i = 0;i<geom.faces.length;i++){
        //         var hex = Math.random() * 0xffffff;
        //         geom.faces[i].color.setHex(hex);
        //     }

        mesh_left_ForceFace.children.forEach(function (e) {
            e.geometry.vertices = vertices;
            e.geometry.verticesNeedUpdate = true;

            // e.geometry.faces[0].color.set(0xff00ee);
            // e.geometry.facesNeedUpdate=true;
            e.geometry.elementsNeedUpdate = true;
            e.geometry.computeFaceNormals();
            //e.geometry.center();
        });
    }

    function redraw_Cell() {

        var vertices = [
            new THREE.Vector3(0, 0, 0), TubePoints1[1], TubePoints2[1], TubePoints3[1], TubePoints4[1]
        ];

        mesh_left_Cell1.children.forEach(function (e) {
            e.geometry.vertices = vertices;
            e.geometry.verticesNeedUpdate = true;

            // e.geometry.faces[0].color.set(0xff00ee);
            // e.geometry.facesNeedUpdate=true;
            e.geometry.elementsNeedUpdate = true;
            e.geometry.computeFaceNormals();
            //e.geometry.center();
        });

        mesh_left_Cell2.children.forEach(function (e) {
            e.geometry.vertices = vertices;
            e.geometry.verticesNeedUpdate = true;

            // e.geometry.faces[0].color.set(0xff00ee);
            // e.geometry.facesNeedUpdate=true;
            e.geometry.elementsNeedUpdate = true;
            e.geometry.computeFaceNormals();
            //e.geometry.center();
        });

        mesh_left_Cell3.children.forEach(function (e) {
            e.geometry.vertices = vertices;
            e.geometry.verticesNeedUpdate = true;

            // e.geometry.faces[0].color.set(0xff00ee);
            // e.geometry.facesNeedUpdate=true;
            e.geometry.elementsNeedUpdate = true;
            e.geometry.computeFaceNormals();
            //e.geometry.center();
        });

        mesh_left_Cell4.children.forEach(function (e) {
            e.geometry.vertices = vertices;
            e.geometry.verticesNeedUpdate = true;

            // e.geometry.faces[0].color.set(0xff00ee);
            // e.geometry.facesNeedUpdate=true;
            e.geometry.elementsNeedUpdate = true;
            e.geometry.computeFaceNormals();
            //e.geometry.center();
        });
    }


    function redraw() {


        Ctrl_pts = [];
        Ctrl_tubes = [];


        scene.remove(form_group);
        scene.remove(form_group_mink);
        scene.remove(form_group_faces);
        scene.remove(form_group_forces);
        scene.remove(form_group_forces2);
        scene.remove(form_group_forces3);

        scene2.remove(force_group_test)

        sceneOrtho2.remove(form_sigima_1)
        sceneOrtho2.remove(form_sigima_2)

        
        sceneOrtho1.remove(force_gamma_1)
        sceneOrtho1.remove(force_gamma_2)
        


        form_group = new THREE.Group();
        form_group_mink = new THREE.Group();
        form_group_faces = new THREE.Group();
        form_group_forces = new THREE.Group();
        form_group_forces2 = new THREE.Group();
        form_group_forces3 = new THREE.Group();
        force_group_test = new THREE.Group();
        form_sigima_1 = new THREE.Group();
        form_sigima_2 = new THREE.Group();
        force_gamma_1 = new THREE.Group();
        force_gamma_2 = new THREE.Group();



        // ****************** New Construct *************************************************************************************************************************************************

        // supports

        var form_nsup1 = new THREE.Vector3(support1x1.l, support1y1.l, -1);
        var form_nsup2 = new THREE.Vector3(support2x1.l, support2y1.l, -1);
        var form_nsup3 = new THREE.Vector3(0, -1, -1);
        var form_nsup4 = new THREE.Vector3(2, -1, -1);
        var form_nsup5 = new THREE.Vector3(2, 1, -1);

        var arrow_apply = new THREE.MeshPhongMaterial({ color: 0x009600 });
        var arrow_apply_out = new THREE.MeshPhongMaterial({ color: "white", transparent: false, side: THREE.BackSide });

        // apply loads
        var A_arrow_apply = new THREE.MeshPhongMaterial({ color: 0x009600 });
        var A_arrow_apply_out = new THREE.MeshPhongMaterial({ color: "white", transparent: false, side: THREE.BackSide });

        var Force_arrow_apply = new THREE.MeshPhongMaterial({ color: 0x009600 });
        var Force_arrow_apply_out = new THREE.MeshPhongMaterial({ color: "white", transparent: false, side: THREE.BackSide });

        var materialapply = new THREE.MeshPhongMaterial({ color: "lightgrey", transparent: false });
        var outlinematerialapply = new THREE.MeshBasicMaterial({ color: "black", transparent: false, side: THREE.BackSide });

        var spapply = new THREE.SphereGeometry(0.038);


        // apply load 1

        // arrow
        var form_appl1b = new THREE.Vector3(form_appl1.x, form_appl1.y, form_appl1.z - 0.4);
        var form_appl1c = new THREE.Vector3(form_appl1.x, form_appl1.y, form_appl1.z - 2.5);
        var form_appl1d = new THREE.Vector3(form_appl1.x, form_appl1.y, form_appl1.z + 0.4);

        var apply_arrow1 = createCylinderArrowMesh(form_appl1d, form_appl1, A_arrow_apply, 0.02, 0.05, 0.6);
        var apply_arrow1_out = createCylinderArrowMesh(form_appl1d, form_appl1, A_arrow_apply_out, 0.03, 0.06, 0.6);


        // node

        var applysp1 = new THREE.Mesh(spapply, materialapply);
        applysp1.position.copy(new THREE.Vector3(form_appl1.x, form_appl1.y, form_appl1.z - 0.4));
        applysp1.name = "sp6";//name
        Ctrl_pts.push(applysp1);

        var outlineapplysp1 = new THREE.Mesh(spapply, outlinematerialapply);
        outlineapplysp1.position.copy(new THREE.Vector3(form_appl1.x, form_appl1.y, form_appl1.z - 0.4));
        outlineapplysp1.scale.multiplyScalar(1.55);

        //dash line

        var apply_o12o12B = [];
        apply_o12o12B.push(form_appl1);
        apply_o12o12B.push(new THREE.Vector3(form_appl1.x, form_appl1.y, - 1.4));

        var apply_12_geo = new THREE.Geometry().setFromPoints(apply_o12o12B);
        var applyline_dash_form = new THREE.LineDashedMaterial({
            color: 0x009600,//color
            dashSize: 0.05,
            gapSize: 0.03,
            linewidth: 1

        });
        var applyline_o12B = new THREE.LineSegments(apply_12_geo, applyline_dash_form);
        applyline_o12B.computeLineDistances();//compute


        form_group.add(applysp1);
        form_group.add(outlineapplysp1);
        form_group.add(apply_arrow1);
        form_group.add(apply_arrow1_out);
        form_group.add(applyline_o12B);



        // apply load 2

        // arrow
        var form_appl2b = new THREE.Vector3(form_appl2.x, form_appl2.y, form_appl2.z - 0.4);
        var form_appl2c = new THREE.Vector3(form_appl2.x, form_appl2.y, form_appl2.z - 2.5);
        var form_appl2d = new THREE.Vector3(form_appl2.x, form_appl2.y, form_appl2.z + 0.4);

        var apply_arrow2 = createCylinderArrowMesh(form_appl2d, form_appl2, A_arrow_apply, 0.02, 0.05, 0.6);
        var apply_arrow2_out = createCylinderArrowMesh(form_appl2d, form_appl2, A_arrow_apply_out, 0.03, 0.06, 0.6);

        // node
        var applysp2 = new THREE.Mesh(spapply, materialapply);
        applysp2.position.copy(new THREE.Vector3(form_appl2.x, form_appl2.y, form_appl2.z - 0.4));
        applysp2.name = "sp7";//name
        Ctrl_pts.push(applysp2);


        var outlineapplysp2 = new THREE.Mesh(spapply, outlinematerialapply);
        outlineapplysp2.position.copy(new THREE.Vector3(form_appl2.x, form_appl2.y, form_appl2.z - 0.4));
        outlineapplysp2.scale.multiplyScalar(1.55);

        //dash line

        var apply_o22o22B = [];
        apply_o22o22B.push(form_appl2);
        apply_o22o22B.push(new THREE.Vector3(form_appl2.x, form_appl2.y, - 1.4));

        var apply_22_geo = new THREE.Geometry().setFromPoints(apply_o22o22B);
        var applyline_dash_form = new THREE.LineDashedMaterial({
            color: 0x009600,//color
            dashSize: 0.05,
            gapSize: 0.03,
            linewidth: 1

        });
        var applyline_o22B = new THREE.LineSegments(apply_22_geo, applyline_dash_form);
        applyline_o22B.computeLineDistances();//compute


        form_group.add(applysp2);
        form_group.add(outlineapplysp2);
        form_group.add(apply_arrow2);
        form_group.add(apply_arrow2_out);
        form_group.add(applyline_o22B);



        // apply load 3

        // arrow

        var form_appl3b = new THREE.Vector3(form_appl3.x, form_appl3.y, form_appl3.z - 0.4);
        var form_appl3c = new THREE.Vector3(form_appl3.x, form_appl3.y, form_appl3.z - 2.5);
        var form_appl3d = new THREE.Vector3(form_appl3.x, form_appl3.y, form_appl3.z + 0.4);

        var apply_arrow3 = createCylinderArrowMesh(form_appl3d, form_appl3, A_arrow_apply, 0.02, 0.05, 0.6);
        var apply_arrow3_out = createCylinderArrowMesh(form_appl3d, form_appl3, A_arrow_apply_out, 0.03, 0.06, 0.6);


        // node
        var applysp3 = new THREE.Mesh(spapply, materialapply);
        applysp3.position.copy(new THREE.Vector3(form_appl3.x, form_appl3.y, form_appl3.z - 0.4));
        applysp3.name = "sp8";//name
        Ctrl_pts.push(applysp3);

        var outlineapplysp3 = new THREE.Mesh(spapply, outlinematerialapply);
        outlineapplysp3.position.copy(new THREE.Vector3(form_appl3.x, form_appl3.y, form_appl3.z - 0.4));
        outlineapplysp3.scale.multiplyScalar(1.55);


        var apply_o32o32B = [];
        apply_o32o32B.push(form_appl3);
        apply_o32o32B.push(new THREE.Vector3(form_appl3.x, form_appl3.y, - 1.4));

        var apply_32_geo = new THREE.Geometry().setFromPoints(apply_o32o32B);
        var applyline_dash_form = new THREE.LineDashedMaterial({
            color: 0x009600,//color
            dashSize: 0.05,
            gapSize: 0.03,
            linewidth: 1

        });
        var applyline_o32B = new THREE.LineSegments(apply_32_geo, applyline_dash_form);
        applyline_o32B.computeLineDistances();//compute
        form_group.add(applysp3);
        form_group.add(outlineapplysp3);
        form_group.add(apply_arrow3);
        form_group.add(apply_arrow3_out);
        form_group.add(applyline_o32B);

        // react load 1

        var support_arrow1 = createCylinderArrowMesh(new THREE.Vector3(form_nsup1.x, form_nsup1.y, form_nsup1.z - 0.8), new THREE.Vector3(form_nsup1.x, form_nsup1.y, form_nsup1.z - 0.4), A_arrow_apply, 0.02, 0.05, 0.6);
        var support_arrow1_out = createCylinderArrowMesh(new THREE.Vector3(form_nsup1.x, form_nsup1.y, form_nsup1.z - 0.8), new THREE.Vector3(form_nsup1.x, form_nsup1.y, form_nsup1.z - 0.4),A_arrow_apply_out, 0.03, 0.06, 0.6);
        form_group.add(support_arrow1);
        form_group.add(support_arrow1_out);

        // react load 2

        var support_arrow2 = createCylinderArrowMesh(new THREE.Vector3(form_nsup2.x, form_nsup2.y, form_nsup2.z - 0.8), new THREE.Vector3(form_nsup2.x, form_nsup2.y, form_nsup2.z - 0.4), A_arrow_apply, 0.02, 0.05, 0.6);
        var support_arrow2_out = createCylinderArrowMesh(new THREE.Vector3(form_nsup2.x, form_nsup2.y, form_nsup2.z - 0.8), new THREE.Vector3(form_nsup2.x, form_nsup2.y, form_nsup2.z - 0.4),A_arrow_apply_out, 0.03, 0.06, 0.6);
        form_group.add(support_arrow2);
        form_group.add(support_arrow2_out);

        // react load 3

        var support_arrow3 = createCylinderArrowMesh(new THREE.Vector3(form_nsup3.x, form_nsup3.y, form_nsup3.z - 0.8), new THREE.Vector3(form_nsup3.x, form_nsup3.y, form_nsup3.z - 0.4), A_arrow_apply, 0.02, 0.05, 0.6);
        var support_arrow3_out = createCylinderArrowMesh(new THREE.Vector3(form_nsup3.x, form_nsup3.y, form_nsup3.z - 0.8), new THREE.Vector3(form_nsup3.x, form_nsup3.y, form_nsup3.z - 0.4),A_arrow_apply_out, 0.03, 0.06, 0.6);
        form_group.add(support_arrow3);
        form_group.add(support_arrow3_out);

        // react load 4

        var support_arrow4 = createCylinderArrowMesh(new THREE.Vector3(form_nsup4.x, form_nsup4.y, form_nsup4.z - 0.8), new THREE.Vector3(form_nsup4.x, form_nsup4.y, form_nsup4.z - 0.4), A_arrow_apply, 0.02, 0.05, 0.6);
        var support_arrow4_out = createCylinderArrowMesh(new THREE.Vector3(form_nsup4.x, form_nsup4.y, form_nsup4.z - 0.8), new THREE.Vector3(form_nsup4.x, form_nsup4.y, form_nsup4.z - 0.4),A_arrow_apply_out, 0.03, 0.06, 0.6);
        form_group.add(support_arrow4);
        form_group.add(support_arrow4_out);

        // react load 5
        var support_arrow5 = createCylinderArrowMesh(new THREE.Vector3(form_nsup5.x, form_nsup5.y, form_nsup5.z - 0.8), new THREE.Vector3(form_nsup5.x, form_nsup5.y, form_nsup5.z - 0.4), A_arrow_apply, 0.02, 0.05, 0.6);
        var support_arrow5_out = createCylinderArrowMesh(new THREE.Vector3(form_nsup5.x, form_nsup5.y, form_nsup5.z - 0.8), new THREE.Vector3(form_nsup5.x, form_nsup5.y, form_nsup5.z - 0.4),A_arrow_apply_out, 0.03, 0.06, 0.6);
        form_group.add(support_arrow5);
        form_group.add(support_arrow5_out);


        // form green faces

        function greenfaces(p1, p2, p3, p4) {
            var vertices = [
                p1, p2, p3, p4
            ];

            var faces = [
                new THREE.Face3(2, 1, 0),
                new THREE.Face3(3, 2, 0),

            ];

            var geom = new THREE.Geometry();
            geom.vertices = vertices;
            geom.faces = faces;
            geom.computeFaceNormals();
            var material_greenfaces = [
                //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                new THREE.MeshBasicMaterial({ color: "white", wireframe: false, transparent: true, opacity: 0.4 }),
                new THREE.MeshPhongMaterial({
                    color: 0x009600, transparent: true, opacity: 0.3, side: THREE.DoubleSide, depthWrite: false
                })
            ];

            var greenface_O2P3 = THREE.SceneUtils.createMultiMaterialObject(geom, material_greenfaces);

            form_group_faces.add(greenface_O2P3);
        }

        function yellowfaces(p1, p2, p3) {
            var vertices = [
                p1, p2, p3
            ];

            var faces = [
                new THREE.Face3(0, 1, 2),
            ];

            var geom = new THREE.Geometry();
            geom.vertices = vertices;
            geom.faces = faces;
            geom.computeFaceNormals();
            var material_greenfaces = [
                //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                new THREE.MeshBasicMaterial({ color: "black", wireframe: false, transparent: true, opacity: 0.4 }),
                new THREE.MeshPhongMaterial({
                    color: "yellow", transparent: true, opacity: 0.6, side: THREE.DoubleSide, depthWrite: false
                })
            ];

            var greenface_O2P3 = THREE.SceneUtils.createMultiMaterialObject(geom, material_greenfaces);

            form_group_faces.add(greenface_O2P3);
        }

        var Colorbar_blue_4 = new THREE.MeshPhongMaterial({
            color: 0x0F3150
        });
        var Colorbar_red_4 = new THREE.MeshPhongMaterial({
            color: 0x80002F
        });


        var gface1 = greenfaces(form_nsup1, new THREE.Vector3(form_appl1.x, form_appl1.y, form_appl1.z - 0.4), form_appl1, new THREE.Vector3(form_nsup1.x, form_nsup1.y, form_appl1.z))
        var gface2 = greenfaces(form_nsup2, new THREE.Vector3(form_appl1.x, form_appl1.y, form_appl1.z - 0.4), form_appl1, new THREE.Vector3(form_nsup2.x, form_nsup2.y, form_appl1.z))
        var gface3 = greenfaces(form_nsup3, new THREE.Vector3(form_appl1.x, form_appl1.y, form_appl1.z - 0.4), form_appl1, new THREE.Vector3(form_nsup3.x, form_nsup3.y, form_appl1.z))

        var gface4 = greenfaces(form_nsup2, new THREE.Vector3(form_appl2.x, form_appl2.y, form_appl2.z - 0.4), form_appl2, new THREE.Vector3(form_nsup2.x, form_nsup2.y, form_appl2.z))
        var gface5 = greenfaces(form_nsup3, new THREE.Vector3(form_appl2.x, form_appl2.y, form_appl2.z - 0.4), form_appl2, new THREE.Vector3(form_nsup3.x, form_nsup3.y, form_appl2.z))
        var gface6 = greenfaces(form_nsup4, new THREE.Vector3(form_appl2.x, form_appl2.y, form_appl2.z - 0.4), form_appl2, new THREE.Vector3(form_nsup4.x, form_nsup4.y, form_appl2.z))

        var gface7 = greenfaces(form_nsup2, new THREE.Vector3(form_appl3.x, form_appl3.y, form_appl3.z - 0.4), form_appl3, new THREE.Vector3(form_nsup2.x, form_nsup2.y, form_appl3.z))
        var gface8 = greenfaces(form_nsup4, new THREE.Vector3(form_appl3.x, form_appl3.y, form_appl3.z - 0.4), form_appl3, new THREE.Vector3(form_nsup4.x, form_nsup4.y, form_appl3.z))
        var gface9 = greenfaces(form_nsup5, new THREE.Vector3(form_appl3.x, form_appl3.y, form_appl3.z - 0.4), form_appl3, new THREE.Vector3(form_nsup5.x, form_nsup5.y, form_appl3.z))

        var gface10 = greenfaces(new THREE.Vector3(form_appl3.x, form_appl3.y, form_appl3.z - 0.4), new THREE.Vector3(form_appl2.x, form_appl2.y, form_appl2.z - 0.4), form_appl2, form_appl3)
        var gface11 = greenfaces(new THREE.Vector3(form_appl1.x, form_appl1.y, form_appl1.z - 0.4), new THREE.Vector3(form_appl2.x, form_appl2.y, form_appl2.z - 0.4), form_appl2, form_appl1)
        var gface12 = greenfaces(new THREE.Vector3(form_nsup1.x, form_nsup1.y, form_nsup1.z - 0.4), new THREE.Vector3(form_nsup2.x, form_nsup2.y, form_nsup2.z - 0.4), form_nsup2, form_nsup1)
        var gface13 = greenfaces(new THREE.Vector3(form_nsup1.x, form_nsup1.y, form_nsup1.z - 0.4), new THREE.Vector3(form_nsup3.x, form_nsup3.y, form_nsup3.z - 0.4), form_nsup3, form_nsup1)
        var gface14 = greenfaces(new THREE.Vector3(form_nsup2.x, form_nsup2.y, form_nsup2.z - 0.4), new THREE.Vector3(form_nsup3.x, form_nsup3.y, form_nsup3.z - 0.4), form_nsup3, form_nsup2)
        var gface15 = greenfaces(new THREE.Vector3(form_nsup2.x, form_nsup2.y, form_nsup2.z - 0.4), new THREE.Vector3(form_nsup3.x, form_nsup3.y, form_nsup3.z - 0.4), form_nsup3, form_nsup2)
        var gface16 = greenfaces(new THREE.Vector3(form_nsup4.x, form_nsup4.y, form_nsup4.z - 0.4), new THREE.Vector3(form_nsup3.x, form_nsup3.y, form_nsup3.z - 0.4), form_nsup3, form_nsup4)
        var gface17 = greenfaces(new THREE.Vector3(form_nsup4.x, form_nsup4.y, form_nsup4.z - 0.4), new THREE.Vector3(form_nsup5.x, form_nsup5.y, form_nsup5.z - 0.4), form_nsup5, form_nsup4)
        var gface18 = greenfaces(new THREE.Vector3(form_nsup2.x, form_nsup2.y, form_nsup2.z - 0.4), new THREE.Vector3(form_nsup5.x, form_nsup5.y, form_nsup5.z - 0.4), form_nsup5, form_nsup2)
        var gface19 = greenfaces(new THREE.Vector3(form_nsup2.x, form_nsup2.y, form_nsup2.z - 0.4), new THREE.Vector3(form_nsup4.x, form_nsup4.y, form_nsup4.z - 0.4), form_nsup4, form_nsup2)


        var yface1 = yellowfaces(form_nsup1, form_nsup2, new THREE.Vector3(form_appl1.x, form_appl1.y, form_appl1.z - 0.4))
        var yface2 = yellowfaces(form_nsup1, form_nsup3, new THREE.Vector3(form_appl1.x, form_appl1.y, form_appl1.z - 0.4))
        var yface3 = yellowfaces(form_nsup2, form_nsup3, new THREE.Vector3(form_appl1.x, form_appl1.y, form_appl1.z - 0.4))
        var yface4 = yellowfaces(form_nsup2, form_nsup3, new THREE.Vector3(form_appl2.x, form_appl2.y, form_appl2.z - 0.4))
        var yface5 = yellowfaces(form_nsup2, new THREE.Vector3(form_appl1.x, form_appl1.y, form_appl1.z - 0.4), new THREE.Vector3(form_appl2.x, form_appl2.y, form_appl2.z - 0.4))
        var yface6 = yellowfaces(form_nsup3, new THREE.Vector3(form_appl1.x, form_appl1.y, form_appl1.z - 0.4), new THREE.Vector3(form_appl2.x, form_appl2.y, form_appl2.z - 0.4))
        var yface7 = yellowfaces(form_nsup3, form_nsup4, new THREE.Vector3(form_appl2.x, form_appl2.y, form_appl2.z - 0.4))
        var yface8 = yellowfaces(form_nsup2, form_nsup4, new THREE.Vector3(form_appl2.x, form_appl2.y, form_appl2.z - 0.4))
        var yface9 = yellowfaces(form_nsup2, new THREE.Vector3(form_appl3.x, form_appl3.y, form_appl3.z - 0.4), new THREE.Vector3(form_appl2.x, form_appl2.y, form_appl2.z - 0.4))
        var yface10 = yellowfaces(form_nsup4, new THREE.Vector3(form_appl3.x, form_appl3.y, form_appl3.z - 0.4), new THREE.Vector3(form_appl2.x, form_appl2.y, form_appl2.z - 0.4))
        var yface11 = yellowfaces(form_nsup2, form_nsup4, new THREE.Vector3(form_appl3.x, form_appl3.y, form_appl3.z - 0.4))
        var yface12 = yellowfaces(form_nsup4, form_nsup5, new THREE.Vector3(form_appl3.x, form_appl3.y, form_appl3.z - 0.4))
        var yface13 = yellowfaces(form_nsup2, form_nsup5, new THREE.Vector3(form_appl3.x, form_appl3.y, form_appl3.z - 0.4))







        var tubeMesh_1t = createCylinderMesh(form_nsup1, form_nsup2, Colorbar_red_4, 0.02, 0.02);
        var tubeMesh_2t = createCylinderMesh(form_nsup1, form_nsup3, Colorbar_red_4, 0.02, 0.02);
        var tubeMesh_3t = createCylinderMesh(form_nsup2, form_nsup3, Colorbar_red_4, 0.02, 0.02);
        var tubeMesh_4t = createCylinderMesh(form_nsup3, form_nsup4, Colorbar_red_4, 0.02, 0.02);

        var tubeMesh_5t = createCylinderMesh(form_nsup2, form_nsup4, Colorbar_red_4, 0.02, 0.02);
        var tubeMesh_6t = createCylinderMesh(form_nsup2, form_nsup5, Colorbar_red_4, 0.02, 0.02);
        var tubeMesh_7t = createCylinderMesh(form_nsup4, form_nsup5, Colorbar_red_4, 0.02, 0.02);


        form_group.add(tubeMesh_1t);
        form_group.add(tubeMesh_2t);
        form_group.add(tubeMesh_3t);
        form_group.add(tubeMesh_4t);
        form_group.add(tubeMesh_5t);
        form_group.add(tubeMesh_6t);
        form_group.add(tubeMesh_7t);


        // support columns
        var Colorbar_c = new THREE.MeshPhongMaterial({
            color: "grey", opacity: 0.8, transparent: true
        });
        var tubeMesh_c1 = createCylinderMesh(form_nsup1, new THREE.Vector3(form_nsup1.x, form_nsup1.y, form_nsup1.z - 0.4), Colorbar_blue_4, 0.01, 0.01);
        var tubeMesh_c2 = createCylinderMesh(form_nsup2, new THREE.Vector3(form_nsup2.x, form_nsup2.y, form_nsup2.z - 0.4), Colorbar_blue_4, 0.01, 0.01);
        var tubeMesh_c3 = createCylinderMesh(form_nsup3, new THREE.Vector3(form_nsup3.x, form_nsup3.y, form_nsup3.z - 0.4), Colorbar_blue_4, 0.01, 0.01);
        var tubeMesh_c4 = createCylinderMesh(form_nsup4, new THREE.Vector3(form_nsup4.x, form_nsup4.y, form_nsup4.z - 0.4), Colorbar_blue_4, 0.01, 0.01);
        var tubeMesh_c5 = createCylinderMesh(form_nsup5, new THREE.Vector3(form_nsup5.x, form_nsup5.y, form_nsup5.z - 0.4), Colorbar_blue_4, 0.01, 0.01);

        var tubeMesh_a1 = createCylinderMesh(form_appl1, form_appl1b, Colorbar_blue_4, 0.01, 0.01);
        var tubeMesh_a2 = createCylinderMesh(form_appl2, form_appl2b, Colorbar_blue_4, 0.01, 0.01);
        var tubeMesh_a3 = createCylinderMesh(form_appl3, form_appl3b, Colorbar_blue_4, 0.01, 0.01);

        // form_group.add(tubeMesh_a1);
        // form_group.add(tubeMesh_a2);
        // form_group.add(tubeMesh_a3);

        function dashline(point1, point2){
        var line = [];
        line.push(point1);
        line.push(point2);

        var linegeo = new THREE.Geometry().setFromPoints(line);
        var linematerial = new THREE.LineDashedMaterial({
            color: 0x009600,//color
            dashSize: 0.05,
            gapSize: 0.03,
            linewidth: 1

        });
        var linefinal = new THREE.LineSegments(linegeo, linematerial);
        linefinal.computeLineDistances();//compute
        form_group.add(linefinal)
        }

        var support1 = dashline(form_nsup1, new THREE.Vector3(form_nsup1.x, form_nsup1.y, form_nsup1.z - 0.4))
        var support2 = dashline(form_nsup2, new THREE.Vector3(form_nsup2.x, form_nsup2.y, form_nsup2.z - 0.4))
        var support3 = dashline(form_nsup3, new THREE.Vector3(form_nsup3.x, form_nsup3.y, form_nsup3.z - 0.4))
        var support4 = dashline(form_nsup4, new THREE.Vector3(form_nsup4.x, form_nsup4.y, form_nsup4.z - 0.4))
        var support5 = dashline(form_nsup5, new THREE.Vector3(form_nsup5.x, form_nsup5.y, form_nsup5.z - 0.4))

        // form_group.add(tubeMesh_c1);
        // form_group.add(tubeMesh_c2);
        // form_group.add(tubeMesh_c3);
        // form_group.add(tubeMesh_c4);
        // form_group.add(tubeMesh_c5);


        // apply load cubes
        var Colorbar_c2 = new THREE.MeshPhongMaterial({
            color: "grey", opacity: 0.4, transparent: true
        });
        const applybox = new THREE.BoxGeometry(0.5, 0.5, 0.8);
        const applycube1 = new THREE.Mesh(applybox, Colorbar_c2);
        applycube1.position.copy(new THREE.Vector3(form_appl1.x, form_appl1.y, form_appl1.z))
        //form_group.add(applycube1);


        const applycube2 = new THREE.Mesh(applybox, Colorbar_c2);
        applycube2.position.copy(new THREE.Vector3(form_appl2.x, form_appl2.y, form_appl2.z))
        //form_group.add(applycube2);

        const applycube3 = new THREE.Mesh(applybox, Colorbar_c2);
        applycube3.position.copy(new THREE.Vector3(form_appl3.x, form_appl3.y, form_appl3.z))
        //form_group.add(applycube3);



        // form box
        var apply_z_max = Math.max(form_appl1.z, form_appl2.z, form_appl3.z)
        var form_box_p1 = new THREE.Vector3(-2.5, 1.5, -1.4)
        var form_box_p2 = new THREE.Vector3(-2.5, -1.5, -1.4)
        var form_box_p3 = new THREE.Vector3(2.5, -1.5, -1.4)
        var form_box_p4 = new THREE.Vector3(2.5, 1.5, -1.4)

        var form_box_p5 = new THREE.Vector3(-2.5, 1.5, apply_z_max )
        var form_box_p6 = new THREE.Vector3(-2.5, -1.5, apply_z_max )
        var form_box_p7 = new THREE.Vector3(2.5, -1.5, apply_z_max )
        var form_box_p8 = new THREE.Vector3(2.5, 1.5, apply_z_max )


        var form_box_edge = [];

        // bottom rect
        form_box_edge.push(form_box_p1);
        form_box_edge.push(form_box_p2);

        form_box_edge.push(form_box_p2);
        form_box_edge.push(form_box_p3);

        form_box_edge.push(form_box_p3);
        form_box_edge.push(form_box_p4);

        form_box_edge.push(form_box_p4);
        form_box_edge.push(form_box_p1);


        // upper rec
        form_box_edge.push(form_box_p5);
        form_box_edge.push(form_box_p6);

        form_box_edge.push(form_box_p6);
        form_box_edge.push(form_box_p7);

        form_box_edge.push(form_box_p7);
        form_box_edge.push(form_box_p8);

        form_box_edge.push(form_box_p8);
        form_box_edge.push(form_box_p5);

        // side
        form_box_edge.push(form_box_p1);
        form_box_edge.push(form_box_p5);

        form_box_edge.push(form_box_p2);
        form_box_edge.push(form_box_p6);

        form_box_edge.push(form_box_p3);
        form_box_edge.push(form_box_p7);

        form_box_edge.push(form_box_p4);
        form_box_edge.push(form_box_p8);


        var form_box_geo1 = new THREE.Geometry().setFromPoints(form_box_edge);
        var form_box_m = new THREE.LineDashedMaterial({
            color: "grey",//color
            dashSize: 0.05,
            gapSize: 0.03,
            linewidth: 1

        });
        var applyline_box1 = new THREE.LineSegments(form_box_geo1, form_box_m);

        form_group.add(applyline_box1);




        var tubeMesh_test2 = createCylinderMesh(form_nsup1, new THREE.Vector3(form_appl1.x, form_appl1.y, form_appl1.z - 0.4), Colorbar_blue_4, 0.02, 0.02)
        var tubeMesh_test3 = createCylinderMesh(form_nsup2, new THREE.Vector3(form_appl1.x, form_appl1.y, form_appl1.z - 0.4), Colorbar_blue_4, 0.02, 0.02)
        var tubeMesh_test4 = createCylinderMesh(form_nsup3, new THREE.Vector3(form_appl1.x, form_appl1.y, form_appl1.z - 0.4), Colorbar_blue_4, 0.02, 0.02)
        var tubeMesh_test5 = createCylinderMesh(form_nsup2, new THREE.Vector3(form_appl2.x, form_appl2.y, form_appl2.z - 0.4), Colorbar_blue_4, 0.02, 0.02)
        var tubeMesh_test6 = createCylinderMesh(form_nsup3, new THREE.Vector3(form_appl2.x, form_appl2.y, form_appl2.z - 0.4), Colorbar_blue_4, 0.02, 0.02)
        var tubeMesh_test7 = createCylinderMesh(form_nsup4, new THREE.Vector3(form_appl2.x, form_appl2.y, form_appl2.z - 0.4), Colorbar_blue_4, 0.02, 0.02)

        var tubeMesh_test8 = createCylinderMesh(form_nsup2, new THREE.Vector3(form_appl3.x, form_appl3.y, form_appl3.z - 0.4), Colorbar_blue_4, 0.02, 0.02)
        var tubeMesh_test9 = createCylinderMesh(form_nsup4, new THREE.Vector3(form_appl3.x, form_appl3.y, form_appl3.z - 0.4), Colorbar_blue_4, 0.02, 0.02)
        var tubeMesh_test10 = createCylinderMesh(form_nsup5, new THREE.Vector3(form_appl3.x, form_appl3.y, form_appl3.z - 0.4), Colorbar_blue_4, 0.02, 0.02)

        var tubeMesh_test11 = createCylinderMesh(new THREE.Vector3(form_appl1.x, form_appl1.y, form_appl1.z - 0.4), new THREE.Vector3(form_appl2.x, form_appl2.y, form_appl2.z - 0.4), Colorbar_blue_4, 0.02, 0.02)
        var tubeMesh_test12 = createCylinderMesh(new THREE.Vector3(form_appl2.x, form_appl2.y, form_appl2.z - 0.4), new THREE.Vector3(form_appl3.x, form_appl3.y, form_appl3.z - 0.4), Colorbar_blue_4, 0.02, 0.02)

        form_group.add(tubeMesh_test2);
        form_group.add(tubeMesh_test3);
        form_group.add(tubeMesh_test4);
        form_group.add(tubeMesh_test5);
        form_group.add(tubeMesh_test6);
        form_group.add(tubeMesh_test7);

        form_group.add(tubeMesh_test8);
        form_group.add(tubeMesh_test9);
        form_group.add(tubeMesh_test10);
        form_group.add(tubeMesh_test11);
        form_group.add(tubeMesh_test12);






        //force diagram

        //point 1 & 2

        var force_test1 = new THREE.Vector3(-1, 1, 0)
        var force_test2 = Cal_Vec_2(form_appl1, form_appl1b, form_nsup1, 0.5);
        var force_test2end = new THREE.Vector3(force_test1.x - forcescale_1.l * force_test2.x, force_test1.y - forcescale_1.l  * force_test2.y, force_test1.z - forcescale_1.l  * force_test2.z);

        //point 3

        var force_test3 = Cal_Vec_2(form_appl1, form_appl1b, form_nsup3, 0.5);
        var force_test3end = new THREE.Vector3(force_test2end.x - forcescale_2.l * force_test3.x, force_test2end.y - forcescale_2.l * force_test3.y, force_test2end.z - forcescale_2.l * force_test3.z);


        //point 4

        var force_test4_1 = Cal_Vec_2(form_appl1, form_appl1b, form_nsup2, 0.5);
        var force_test4end = new THREE.Vector3(force_test1.x - 2 * force_test4_1.x, force_test1.y - 2 * force_test4_1.y, force_test1.z - 2 * force_test4_1.z);

        var force_test4_2 = Cal_Vec_2(form_appl1, form_appl1b, form_appl2, 0.5);
        var force_test4_2end = new THREE.Vector3(force_test3end.x - 2 * force_test4_2.x, force_test3end.y - 2 * force_test4_2.y, force_test3end.z - 2 * force_test4_2.z);

        var dir1 = new THREE.Vector3(); // create once an reuse it

        dir1.subVectors(force_test1, force_test4end).normalize();

        var dir2 = new THREE.Vector3(); // create once an reuse it

        dir2.subVectors(force_test4_2end, force_test3end).normalize();
        var force_test4 = LinesSectPt(dir1, force_test1, dir2, force_test3end);

        //point 5

        var force_test5 = Cal_Vec_2(form_appl2, form_appl2b, form_nsup3, 0.5);
        var force_test5end = new THREE.Vector3(force_test3end.x - forcescale_3.l * force_test5.x, force_test3end.y - forcescale_3.l * force_test5.y, force_test3end.z - forcescale_3.l * force_test5.z);

        //point 6

        var force_test6 = Cal_Vec_2(form_appl2, form_appl2b, form_nsup4, 0.5);
        var force_test6end = new THREE.Vector3(force_test5end.x - forcescale_4.l * force_test6.x, force_test5end.y - forcescale_4.l * force_test6.y, force_test5end.z - forcescale_4.l * force_test6.z);


        //point 7

        var force_test7_1 = Cal_Vec_2(form_appl2, form_appl2b, form_nsup2, 0.5);
        var force_test7end = new THREE.Vector3(force_test4.x - 2 * force_test7_1.x, force_test4.y - 2 * force_test7_1.y, force_test4.z - 2 * force_test7_1.z);

        var force_test7_2 = Cal_Vec_2(form_appl2, form_appl2b, form_appl3, 0.5);
        var force_test7_2end = new THREE.Vector3(force_test6end.x - 2 * force_test7_2.x, force_test6end.y - 2 * force_test7_2.y, force_test6end.z - 2 * force_test7_2.z);

        var dir1 = new THREE.Vector3(); // create once an reuse it

        dir1.subVectors(force_test4, force_test7end).normalize();

        var dir2 = new THREE.Vector3(); // create once an reuse it

        dir2.subVectors(force_test7_2end, force_test6end).normalize();
        var force_test7 = LinesSectPt(dir1, force_test4, dir2, force_test6end);

        //point 8

        var force_test8 = Cal_Vec_2(form_appl3, form_appl3b, form_nsup4, 0.5);
        var force_test8end = new THREE.Vector3(force_test6end.x - forcescale_5.l * force_test8.x, force_test6end.y - forcescale_5.l * force_test8.y, force_test6end.z - forcescale_5.l * force_test8.z);

        //point 9


        var force_test9_1 = Cal_Vec_2(form_appl3, form_appl3b, form_nsup2, 0.5);
        var force_test9end = new THREE.Vector3(force_test7.x - 2 * force_test9_1.x, force_test7.y - 2 * force_test9_1.y, force_test7.z - 2 * force_test9_1.z);

        var force_test9_2 = Cal_Vec_2(form_appl3, form_appl3b, form_nsup5, 0.5);
        var force_test9_2end = new THREE.Vector3(force_test8end.x - 2 * force_test9_2.x, force_test8end.y - 2 * force_test9_2.y, force_test8end.z - 2 * force_test9_2.z);

        var dir1 = new THREE.Vector3(); // create once an reuse it

        dir1.subVectors(force_test7, force_test9end).normalize();

        var dir2 = new THREE.Vector3(); // create once an reuse it

        dir2.subVectors(force_test9_2end, force_test8end).normalize();
        var force_test9 = LinesSectPt(dir1, force_test7, dir2, force_test8end);

        //find bottom point 1


        var force_test12_a = Cal_Vec_2(form_appl1, form_nsup1, form_nsup3, 0.5);
        var force_test12end = new THREE.Vector3(force_test2end.x - 2 * force_test12_a.x, force_test2end.y - 2 * force_test12_a.y, force_test2end.z - 2 * force_test12_a.z);

        var force_test12_b = Cal_Vec_2(form_appl1, form_nsup1, form_nsup2, 0.5);
        var force_test12endb = new THREE.Vector3(force_test1.x - 2 * force_test12_b.x, force_test1.y - 2 * force_test12_b.y, force_test1.z - 2 * force_test12_b.z);

        var dir1 = new THREE.Vector3(); // create once an reuse it

        dir1.subVectors(force_test12end, force_test2end).normalize();

        var dir2 = new THREE.Vector3(); // create once an reuse it

        dir2.subVectors(force_test12endb, force_test1).normalize();
        var force_test12b = LinesSectPt(dir1, force_test2end, dir2, force_test1);

        //find bottom point 2


        var force_test34_a = Cal_Vec_2(form_appl1, form_appl2, form_nsup3, 0.5);
        var force_test34end = new THREE.Vector3(force_test3end.x - 2 * force_test34_a.x, force_test3end.y - 2 * force_test34_a.y, force_test3end.z - 2 * force_test34_a.z);

        var force_test34_b = Cal_Vec_2(form_appl1, form_appl2, form_nsup2, 0.5);
        var force_test34endb = new THREE.Vector3(force_test4.x - 2 * force_test34_b.x, force_test4.y - 2 * force_test34_b.y, force_test4.z - 2 * force_test34_b.z);

        var dir1 = new THREE.Vector3(); // create once an reuse it

        dir1.subVectors(force_test34end, force_test3end).normalize();

        var dir2 = new THREE.Vector3(); // create once an reuse it

        dir2.subVectors(force_test34endb, force_test4).normalize();
        var force_test34b = LinesSectPt(dir1, force_test3end, dir2, force_test4);


        //find bottom point 3


        var force_test35_a = Cal_Vec_2(form_appl2, form_nsup2, form_nsup3, 0.5);
        var force_test35end = new THREE.Vector3(force_test34b.x - 2 * force_test35_a.x, force_test34b.y - 2 * force_test35_a.y, force_test34b.z - 2 * force_test35_a.z);

        var force_test35_b = Cal_Vec_2(form_appl2, form_nsup4, form_nsup3, 0.5);
        var force_test35endb = new THREE.Vector3(force_test5end.x - 2 * force_test35_b.x, force_test5end.y - 2 * force_test35_b.y, force_test5end.z - 2 * force_test35_b.z);

        var dir1 = new THREE.Vector3(); // create once an reuse it

        dir1.subVectors(force_test35end, force_test34b).normalize();

        var dir2 = new THREE.Vector3(); // create once an reuse it

        dir2.subVectors(force_test35endb, force_test5end).normalize();
        var force_test35b = LinesSectPt(dir1, force_test35end, dir2, force_test5end);

        //find bottom point 4

        var force_test67_a = Cal_Vec_2(form_appl2, form_appl3, form_nsup2, 0.5);
        var force_test67end = new THREE.Vector3(force_test7.x - 2 * force_test67_a.x, force_test7.y - 2 * force_test67_a.y, force_test7.z - 2 * force_test67_a.z);

        var force_test67_b = Cal_Vec_2(form_appl2, form_nsup4, form_appl3, 0.5);
        var force_test67endb = new THREE.Vector3(force_test6end.x - 2 * force_test67_b.x, force_test6end.y - 2 * force_test67_b.y, force_test6end.z - 2 * force_test67_b.z);

        var dir1 = new THREE.Vector3(); // create once an reuse it

        dir1.subVectors(force_test67end, force_test7).normalize();

        var dir2 = new THREE.Vector3(); // create once an reuse it

        dir2.subVectors(force_test67endb, force_test6end).normalize();
        var force_test67b = LinesSectPt(dir1, force_test67end, dir2, force_test6end);

        //find bottom point 5

        var force_test68_a = Cal_Vec_2(form_appl3, form_nsup4, form_nsup2, 0.5);
        var force_test68end = new THREE.Vector3(force_test67b.x - 2 * force_test68_a.x, force_test67b.y - 2 * force_test68_a.y, force_test67b.z - 2 * force_test68_a.z);

        var force_test68_b = Cal_Vec_2(form_appl3, form_nsup4, form_nsup5, 0.5);
        var force_test68endb = new THREE.Vector3(force_test8end.x - 2 * force_test68_b.x, force_test8end.y - 2 * force_test68_b.y, force_test8end.z - 2 * force_test68_b.z);

        var dir1 = new THREE.Vector3(); // create once an reuse it

        dir1.subVectors(force_test67b, force_test68end).normalize();

        var dir2 = new THREE.Vector3(); // create once an reuse it

        dir2.subVectors(force_test68endb, force_test8end).normalize();
        var force_test68b = LinesSectPt(dir1, force_test67b, dir2, force_test8end);


        // final force points

        var force_p1 = force_test1
        var force_p2 = force_test2end
        var force_p3 = force_test3end
        var force_p4 = force_test4
        var force_p5 = force_test5end
        var force_p6 = force_test6end
        var force_p7 = force_test7
        var force_p8 = force_test8end
        var force_p9 = force_test9

        var force_b1 = force_test12b
        var force_b2 = force_test34b
        var force_b3 = force_test35b
        var force_b4 = force_test67b
        var force_b5 = force_test68b

        var force_b1a = new THREE.Vector3(force_b1.x,force_b1.y,force_test1.z)
        var force_b3a = new THREE.Vector3(force_b3.x,force_b3.y,force_test1.z)
        var force_b5a = new THREE.Vector3(force_b5.x,force_b5.y,force_test1.z)

        // apply loads


        //load 1
        var force_arrowp1 = new THREE.Vector3((force_p1.x+force_p2.x+force_p3.x+force_p4.x)/4,(force_p1.y+force_p2.y+force_p3.y+force_p4.y)/4,(force_p1.z+force_p2.z+force_p3.z+force_p4.z)/4)

        var force_arrow1 = createCylinderArrowMesh(new THREE.Vector3(force_arrowp1.x, force_arrowp1.y, force_arrowp1.z + 0.4), force_arrowp1, Force_arrow_apply, 0.02, 0.05, 0.6);
        var force_arrow1_out = createCylinderArrowMesh(new THREE.Vector3(force_arrowp1.x, force_arrowp1.y, force_arrowp1.z + 0.4), force_arrowp1,Force_arrow_apply_out, 0.03, 0.06, 0.6);
        // force_group_test.add(force_arrow1);
        // force_group_test.add(force_arrow1_out);

        //load 2
        var force_arrowp2 = new THREE.Vector3((force_p3.x+force_p4.x+force_p5.x+force_p6.x+force_p7.x)/5,(force_p3.y+force_p4.y+force_p5.y+force_p6.y+force_p7.y)/5,(force_p3.z+force_p4.z+force_p5.z+force_p6.z+force_p7.z)/5)

        var force_arrow2 = createCylinderArrowMesh(new THREE.Vector3(force_arrowp2.x, force_arrowp2.y, force_arrowp2.z + 0.4), force_arrowp2, Force_arrow_apply, 0.02, 0.05, 0.6);
        var force_arrow2_out = createCylinderArrowMesh(new THREE.Vector3(force_arrowp2.x, force_arrowp2.y, force_arrowp2.z + 0.4), force_arrowp2,Force_arrow_apply_out, 0.03, 0.06, 0.6);
        // force_group_test.add(force_arrow2);
        // force_group_test.add(force_arrow2_out);

        //load 3
        var force_arrowp3 = new THREE.Vector3((force_p6.x+force_p7.x+force_p8.x+force_p9.x)/4,(force_p6.y+force_p7.y+force_p8.y+force_p9.y)/4,(force_p6.z+force_p7.z+force_p8.z+force_p9.z)/4)

        var force_arrow3 = createCylinderArrowMesh(new THREE.Vector3(force_arrowp3.x, force_arrowp3.y, force_arrowp3.z + 0.4), force_arrowp3, Force_arrow_apply, 0.02, 0.05, 0.6);
        var force_arrow3_out = createCylinderArrowMesh(new THREE.Vector3(force_arrowp3.x, force_arrowp3.y, force_arrowp3.z + 0.4), force_arrowp3,Force_arrow_apply_out, 0.03, 0.06, 0.6);
        // force_group_test.add(force_arrow3);
        // force_group_test.add(force_arrow3_out);








        // loads number


        function create_force_face_area(point1,point2,pointO){
            var face_area = new THREE.Vector3().crossVectors(
               new THREE.Vector3().subVectors( point1, pointO ),
               new THREE.Vector3().subVectors( point2, pointO ),
               ).length()/2

            return face_area
        }

        //f 1

        //load 1 area (f1 condition)

        var force_load1_area1 = create_force_face_area(force_p1,force_p2,force_p4)
        var force_load1_area2 = create_force_face_area(force_p3,force_p2,force_p4)

        var force_load1_area = force_load1_area1 + force_load1_area2

        var force_load1 = (applyload_1.l).toFixed(1)

        var TXMeshA=createSpriteText_loads("f","1","=",force_load1,"KN",form_appl1d);
        form_group_forces.add(TXMeshA);

        // var TXMeshB=createSpriteText_r2("\u03b3","1","=",(force_load1/force_load1_area).toFixed(1),new THREE.Vector3(0.8,0,-2));
        // force_group_test.add(TXMeshB);

        // var TXMeshQ=createSpriteText_r2("\u03c3","1","=",((force_load1/force_load1_area)/minkscale1.l).toFixed(1),new THREE.Vector3(2,0,-2));
        // force_group_test.add(TXMeshQ);

        var TXMeshQ22=createSpriteText_r3("\u03c3","1","=",((force_load1/force_load1_area)/minkscale1.l).toFixed(1),new THREE.Vector2(1,0));
        form_sigima_1.add(TXMeshQ22);

        var TXMeshB=createSpriteText_r3("\u03b3","1","=",(force_load1/force_load1_area).toFixed(1),new THREE.Vector3(0.8,0,-2));
        force_gamma_1.add(TXMeshB);




        // var TXStill1=createCharacterLabel2(((force_load1/force_load1_area)/minkscale1.l).toFixed(1));
        // force_group_test.add(TXStill1);

        // var text2 = document.createElement('div');
        // text2.style.position = 'absolute';
        // //text2.style.zIndex = 1;    // if you still don't see the label, try uncommenting this
        // text2.style.width = 100;
        // text2.style.height = 100;
        // text2.style.backgroundColor = "transparent";
        // text2.innerHTML = ((force_load1/force_load1_area)/minkscale1.l).toFixed(1);
        // text2.style.top = 200 + 'px';
        // text2.style.left = 200 + 'px';
        // if ($("#form_forces_f1").prop('checked')){
        //     document.body.appendChild(text2);
        // }
        // else{
       
        // }

           

     
  
           
        // function createCharacterLabel2( text ) {

        //     var canvas1 = document.createElement('canvas');
        //     canvas1.width = 800;
        //     canvas1.height = 800;
        //     var context1 = canvas1.getContext('2d');
        //     context1.font = "Bold 10px Arial";
        //     context1.fillStyle = "black";
        //     context1.fillText(text, 400, 400);
           

        // //     // canvas contents will be used for a texture
        // //     var texture1 = new THREE.CanvasTexture(canvas1)
        // //     texture1.needsUpdate = true;

        // //     var material1 = new THREE.MeshBasicMaterial({ map: texture1, depthWrite:false});
        // //     material1.transparent = true;

        // //     var mesh1 = new THREE.Mesh(
        // //         new THREE.PlaneGeometry(100, 100),
        // //         material1
        // //       );
        // //     mesh1.position.set(0, 0);
        // //     mesh1.rotation.x = -0.9;
        
        // // force_group_test.add(mesh1);
        // }

        function createCharacterLabel( text ) {

        const textCanvas = document.createElement( 'canvas' );
	    textCanvas.height = 34;
        const ctx = textCanvas.getContext( '2d' );
        const font = '24px grobold';
        
        ctx.font = font;
        textCanvas.width = Math.ceil( ctx.measureText( text ).width + 16 );
        
        ctx.font = font;
        ctx.strokeStyle = '#222';
        ctx.lineWidth = 8;
        ctx.lineJoin = 'miter';
        ctx.miterLimit = 3;
        ctx.strokeText( text, 8, 26 );
        ctx.fillStyle = 'white';
        ctx.fillText( text, 8, 26 );
        
        const spriteMap = new THREE.Texture( ctx.getImageData( 0, 0, textCanvas.width, textCanvas.height ) );
        spriteMap.minFilter = THREE.LinearFilter;
        spriteMap.generateMipmaps = false;
        spriteMap.needsUpdate = true;
        
        // const sprite = new THREE.Sprite( new THREE.SpriteMaterial( { map: spriteMap, depthWrite:false } ) );
        // sprite.scale.set( 0.12 * textCanvas.width / textCanvas.height, 0.12, 1 );
        // sprite.position.y = 0.7 ;
        
        force_group_test.add(spriteMap);
        }

        


        //load 2 area (f1 condition)

        var force_load2_area1 = create_force_face_area(force_p3,force_p4,force_p7)
        var force_load2_area2 = create_force_face_area(force_p3,force_p5,force_p7)
        var force_load2_area3 = create_force_face_area(force_p5,force_p6,force_p7)

        var force_load2_area = force_load2_area1 + force_load2_area2+ force_load2_area3


        var num = force_load2_area/force_load1_area

        var force_load2 = (applyload_1.l*(num)).toFixed(1)

        var TXMeshA2=createSpriteText_loads("f","2","=",force_load2,"KN",form_appl2d);
        form_group_forces.add(TXMeshA2);

        //load 3 area (f1 condition)

        var force_load3_area1 = create_force_face_area(force_p7,force_p6,force_p8)
        var force_load3_area2 = create_force_face_area(force_p7,force_p8,force_p9)

        var force_load3_area = force_load3_area1 + force_load3_area2

        num2 = (force_load3_area/force_load1_area).toFixed(2)

        var force_load3 = (applyload_1.l*(num2)).toFixed(1)

        var TXMeshA3=createSpriteText_loads("f","3","=",force_load3,"KN",form_appl3d);
        form_group_forces.add(TXMeshA3);

        //f 2
        // load 2

        var force_load2_2 = (applyload_2.l).toFixed(1)

        var TXMeshf2=createSpriteText_loads("f","2","=",force_load2_2,"KN",form_appl2d);
        form_group_forces2.add(TXMeshf2);

        // var TXMeshB_2=createSpriteText_r2("\u03b3","2","=",(force_load2_2/force_load2_area).toFixed(1),new THREE.Vector3(0.8,0,-2.2));
        // force_group_test.add(TXMeshB_2);

        // var TXMeshQ2=createSpriteText_r2("\u03c3","2","=",((force_load2_2/force_load2_area)/minkscale1.l).toFixed(1),new THREE.Vector3(2,0,-2.2));
        // force_group_test.add(TXMeshQ2);

        var TXMeshQ2_2=createSpriteText_r3("\u03c3","2","=",((force_load2_2/force_load2_area)/minkscale1.l).toFixed(1),new THREE.Vector3(2,0,-2.2));
        form_sigima_2.add(TXMeshQ2_2);

        var TXMeshB_2=createSpriteText_r3("\u03b3","2","=",(force_load2_2/force_load2_area).toFixed(1),new THREE.Vector3(0.8,0,-2.2));
        force_gamma_2.add(TXMeshB_2);

        // load 1

        var num_1 = force_load1_area/force_load2_area

        var force_load1_1 = (applyload_2.l*(num_1)).toFixed(1)

        var TXMeshA2_1=createSpriteText_loads("f","1","=",force_load1_1,"KN",form_appl1d);
        form_group_forces2.add(TXMeshA2_1);

        // load 3

        num2_2 = (force_load3_area/force_load2_area).toFixed(2)

        var force_load3_2 = (applyload_2.l*(num2_2)).toFixed(1)

        var TXMeshA3_2=createSpriteText_loads("f","3","=",force_load3_2,"KN",form_appl3d);
        form_group_forces2.add(TXMeshA3_2);


        //f 3
        // load 3

        var force_load3_3 = (applyload_3.l).toFixed(1)

        var TXMeshf3=createSpriteText_loads("f","3","=",force_load3_3,"KN",form_appl3d);
        form_group_forces3.add(TXMeshf3);

        // var TXMeshB_3=createSpriteText_r2("\u03b3","3","=",(force_load3_3/force_load3_area).toFixed(1),new THREE.Vector3(0.8,0,-2.4));
        // force_group_test.add(TXMeshB_3);

        // var TXMeshQ3=createSpriteText_r2("\u03c3","3","=",((force_load3_3/force_load3_area)/minkscale1.l).toFixed(1),new THREE.Vector3(2,0,-2.4));
        // force_group_test.add(TXMeshQ3);

        // load 1

        var num_12 = force_load1_area/force_load3_area

        var force_load1_12 = (applyload_3.l*(num_12)).toFixed(1)

        var TXMeshA2_12=createSpriteText_loads("f","1","=",force_load1_12,"KN",form_appl1d);
        form_group_forces3.add(TXMeshA2_12);

        // load 2

        num2_22 = (force_load2_area/force_load3_area).toFixed(2)

        var force_load2_22 = (applyload_3.l*(num2_22)).toFixed(1)

        var TXMeshA3_22=createSpriteText_loads("f","2","=",force_load2_22,"KN",form_appl2d);
        form_group_forces3.add(TXMeshA3_22);




        //reaction 1 area

        var force_re1_area1 = create_force_face_area(force_p1,force_p2,force_b1a)

        var force_re1_area = force_re1_area1

        num3 = (force_re1_area/force_load1_area).toFixed(2)

        var force_re1 = (applyload_1.l*(num3)).toFixed(1)


        var TXMeshB1=createSpriteText_loads("r","1","=",force_re1,"KN",new THREE.Vector3(form_nsup1.x, form_nsup1.y, form_nsup1.z - 1.1));
        form_group_forces.add(TXMeshB1);

        num32 = (force_re1_area/force_load2_area).toFixed(2)

        var force_re12 = (applyload_2.l*(num32)).toFixed(1)


        var TXMeshB12=createSpriteText_loads("r","1","=",force_re12,"KN",new THREE.Vector3(form_nsup1.x, form_nsup1.y, form_nsup1.z - 1.1));
        form_group_forces2.add(TXMeshB12);

        num33 = (force_re1_area/force_load3_area).toFixed(2)

        var force_re13 = (applyload_3.l*(num3)).toFixed(1)


        var TXMeshB13=createSpriteText_loads("r","1","=",force_re13,"KN",new THREE.Vector3(form_nsup1.x, form_nsup1.y, form_nsup1.z - 1.1));
        form_group_forces3.add(TXMeshB13);

        //reaction 2 area

        var force_re2_area1 = create_force_face_area(force_p1,force_p4,force_b1a)
        var force_re2_area2 = create_force_face_area(force_b3a,force_p4,force_b1a)
        var force_re2_area3 = create_force_face_area(force_b3a,force_p4,force_p7)
        var force_re2_area4 = create_force_face_area(force_b3a,force_p7,force_b5a)
        var force_re2_area5 = create_force_face_area(force_b5a,force_p7,force_p9)

        var force_re2_area = force_re2_area1 + force_re2_area2 + force_re2_area3 + force_re2_area4 + force_re2_area5

        num4 = (force_re2_area/force_load1_area).toFixed(2)

        var force_re2 = (applyload_1.l*(num4)).toFixed(1)

        var TXMeshB2=createSpriteText_loads("r","2","=",force_re2,"KN",new THREE.Vector3(form_nsup2.x, form_nsup2.y, form_nsup2.z - 1.1));
        form_group_forces.add(TXMeshB2);

        num42 = (force_re2_area/force_load2_area).toFixed(2)

        var force_re22 = (applyload_2.l*(num4)).toFixed(1)

        var TXMeshB22=createSpriteText_loads("r","2","=",force_re22,"KN",new THREE.Vector3(form_nsup2.x, form_nsup2.y, form_nsup2.z - 1.1));
        form_group_forces2.add(TXMeshB22);

        num43 = (force_re2_area/force_load3_area).toFixed(2)

        var force_re23 = (applyload_3.l*(num43)).toFixed(1)

        var TXMeshB23=createSpriteText_loads("r","2","=",force_re23,"KN",new THREE.Vector3(form_nsup2.x, form_nsup2.y, form_nsup2.z - 1.1));
        form_group_forces3.add(TXMeshB23);


        //reaction 3 area

        var force_re3_area1 = create_force_face_area(force_p2,force_p3,force_b1a)
        var force_re3_area2 = create_force_face_area(force_b3a,force_p3,force_b1a)
        var force_re3_area3 = create_force_face_area(force_b3a,force_p5,force_p3)

        var force_re3_area = force_re3_area1 + force_re3_area2 + force_re3_area3

        num5 = (force_re3_area/force_load1_area).toFixed(2)

        var force_re3 = (applyload_1.l*(num5)).toFixed(1)

        var TXMeshB3=createSpriteText_loads("r","3","=",force_re3,"KN",new THREE.Vector3(form_nsup3.x, form_nsup3.y, form_nsup3.z - 1.1));
        form_group_forces.add(TXMeshB3);

        num52 = (force_re3_area/force_load2_area).toFixed(2)

        var force_re32 = (applyload_2.l*(num52)).toFixed(1)
        
        var TXMeshB32=createSpriteText_loads("r","3","=",force_re32,"KN",new THREE.Vector3(form_nsup3.x, form_nsup3.y, form_nsup3.z - 1.1));
        form_group_forces2.add(TXMeshB32);

        num53 = (force_re3_area/force_load3_area).toFixed(2)

        var force_re33 = (applyload_3.l*(num53)).toFixed(1)
        
        var TXMeshB33=createSpriteText_loads("r","3","=",force_re3,"KN",new THREE.Vector3(form_nsup3.x, form_nsup3.y, form_nsup3.z - 1.1));
        form_group_forces3.add(TXMeshB33);

        //reaction 4 area

        var force_re4_area1 = create_force_face_area(force_p5,force_p6,force_b3a)
        var force_re4_area2 = create_force_face_area(force_b3a,force_p6,force_b5a)
        var force_re4_area3 = create_force_face_area(force_b5a,force_p6,force_p8)

        var force_re4_area = force_re4_area1 + force_re4_area2 + force_re4_area3

        num6 = (force_re4_area/force_load1_area).toFixed(2)

        var force_re4 = (applyload_1.l*(num6)).toFixed(1)

        var TXMeshB4=createSpriteText_loads("r","4","=",force_re4,"KN",new THREE.Vector3(form_nsup4.x, form_nsup4.y, form_nsup4.z - 1.1));
        form_group_forces.add(TXMeshB4);

        num62 = (force_re4_area/force_load2_area).toFixed(2)

        var force_re42 = (applyload_2.l*(num62)).toFixed(1)
        
        var TXMeshB42=createSpriteText_loads("r","4","=",force_re42,"KN",new THREE.Vector3(form_nsup4.x, form_nsup4.y, form_nsup4.z - 1.1));
        form_group_forces2.add(TXMeshB42);

        num63 = (force_re4_area/force_load3_area).toFixed(2)

        var force_re43 = (applyload_3.l*(num63)).toFixed(1)
        
        var TXMeshB43=createSpriteText_loads("r","4","=",force_re43,"KN",new THREE.Vector3(form_nsup4.x, form_nsup4.y, form_nsup4.z - 1.1));
        form_group_forces3.add(TXMeshB43);

        //reaction 5 area
        var force_re5_area1 = create_force_face_area(force_p8,force_p9,force_b5a)
        var force_re5_area = force_re5_area1

        num7 = (force_re5_area/force_load1_area).toFixed(2)

        var force_re5 = (applyload_1.l*(num7)).toFixed(1)

        var TXMeshB5=createSpriteText_loads("r","5","=",force_re5,"KN",new THREE.Vector3(form_nsup5.x, form_nsup5.y, form_nsup5.z - 1.1));
        form_group_forces.add(TXMeshB5);

        num72 = (force_re5_area/force_load2_area).toFixed(2)

        var force_re52 = (applyload_2.l*(num72)).toFixed(1)
        
        var TXMeshB52=createSpriteText_loads("r","5","=",force_re52,"KN",new THREE.Vector3(form_nsup5.x, form_nsup5.y, form_nsup5.z - 1.1));
        form_group_forces2.add(TXMeshB52);

        num73 = (force_re5_area/force_load3_area).toFixed(2)

        var force_re53 = (applyload_3.l*(num73)).toFixed(1)
        
        var TXMeshB53=createSpriteText_loads("r","5","=",force_re53,"KN",new THREE.Vector3(form_nsup5.x, form_nsup5.y, form_nsup5.z - 1.1));
        form_group_forces3.add(TXMeshB53);

        

        //edge1
        var force_e1_area1 = create_force_face_area(force_p1,force_p2,force_b1)
        var force_e1_area = force_e1_area1

        nume1 = (force_e1_area/force_load1_area).toFixed(2)

        var force_e1 = (applyload_1.l*(nume1)).toFixed(1)

        var TXMeshe1=createSpriteText1(force_e1,"KN",new THREE.Vector3((form_nsup1.x+form_appl1b.x)/2, (form_nsup1.y+form_appl1b.y)/2, (form_nsup1.z+form_appl1b.z)/2+0.1));
        form_group_forces.add(TXMeshe1);

        nume1_2 = (force_e1_area/force_load2_area).toFixed(2)

        var force_e1_2 = (applyload_2.l*(nume1_2)).toFixed(1)
        
        var TXMeshe1_2=createSpriteText1(force_e1_2,"KN",new THREE.Vector3((form_nsup1.x+form_appl1b.x)/2, (form_nsup1.y+form_appl1b.y)/2, (form_nsup1.z+form_appl1b.z)/2+0.1));
        form_group_forces2.add(TXMeshe1_2);

        nume1_3 = (force_e1_area/force_load3_area).toFixed(2)

        var force_e1_3 = (applyload_3.l*(nume1_3)).toFixed(1)
        
        var TXMeshe1_3=createSpriteText1(force_e1_3,"KN",new THREE.Vector3((form_nsup1.x+form_appl1b.x)/2, (form_nsup1.y+form_appl1b.y)/2, (form_nsup1.z+form_appl1b.z)/2+0.1));
        form_group_forces3.add(TXMeshe1_3);

        //edge2
        var force_e2_area1 = create_force_face_area(force_p3,force_p2,force_b1)
        var force_e2_area2 = create_force_face_area(force_p3,force_b2,force_b1)
        var force_e2_area = force_e2_area1 + force_e2_area2


        nume2 = (force_e2_area/force_load1_area).toFixed(2)

        var force_e2 =(applyload_1.l*(nume2)).toFixed(1)

        var TXMeshe2=createSpriteText1(force_e2,"KN",new THREE.Vector3((form_nsup3.x+form_appl1b.x)/2, (form_nsup3.y+form_appl1b.y)/2, (form_nsup3.z+form_appl1b.z)/2+0.1));
        form_group_forces.add(TXMeshe2);

        
        nume2_2 = (force_e2_area/force_load2_area).toFixed(2)

        var force_e2_2 =(applyload_2.l*(nume2_2)).toFixed(1)

        var TXMeshe2_2=createSpriteText1(force_e2_2,"KN",new THREE.Vector3((form_nsup3.x+form_appl1b.x)/2, (form_nsup3.y+form_appl1b.y)/2, (form_nsup3.z+form_appl1b.z)/2+0.1));
        form_group_forces2.add(TXMeshe2_2);

        nume2_3 = (force_e2_area/force_load3_area).toFixed(2)

        var force_e2_3 =(applyload_3.l*(nume2_3)).toFixed(1)
        
        var TXMeshe2_3=createSpriteText1(force_e2_3,"KN",new THREE.Vector3((form_nsup3.x+form_appl1b.x)/2, (form_nsup3.y+form_appl1b.y)/2, (form_nsup3.z+form_appl1b.z)/2+0.1));
        form_group_forces3.add(TXMeshe2_3);

        //edge3
        var force_e3_area1 = create_force_face_area(force_p1,force_p4,force_b1)
        var force_e3_area2 = create_force_face_area(force_p4,force_b2,force_b1)
        var force_e3_area = force_e3_area1 + force_e3_area2

        nume3 = (force_e3_area/force_load1_area).toFixed(2)

        var force_e3 = (applyload_1.l*(nume3)).toFixed(1)

        var TXMeshe3=createSpriteText1(force_e3,"KN",new THREE.Vector3((form_nsup2.x+form_appl1b.x)/2, (form_nsup2.y+form_appl1b.y)/2, (form_nsup2.z+form_appl1b.z)/2+0.1));
        form_group_forces.add(TXMeshe3);

        nume3_2 = (force_e3_area/force_load2_area).toFixed(2)

        var force_e3_2 = (applyload_2.l*(nume3_2)).toFixed(1)
        
        var TXMeshe3_2=createSpriteText1(force_e3_2,"KN",new THREE.Vector3((form_nsup2.x+form_appl1b.x)/2, (form_nsup2.y+form_appl1b.y)/2, (form_nsup2.z+form_appl1b.z)/2+0.1));
        form_group_forces2.add(TXMeshe3_2);

        nume3_3 = (force_e3_area/force_load3_area).toFixed(2)

        var force_e3_3 = (applyload_3.l*(nume3_3)).toFixed(1)
        
        var TXMeshe3_3=createSpriteText1(force_e3_3,"KN",new THREE.Vector3((form_nsup2.x+form_appl1b.x)/2, (form_nsup2.y+form_appl1b.y)/2, (form_nsup2.z+form_appl1b.z)/2+0.1));
        form_group_forces3.add(TXMeshe3_3);


        //edge4
        var force_e4_area1 = create_force_face_area(force_p3,force_p4,force_b2)
        var force_e4_area = force_e4_area1

        nume4 = (force_e4_area/force_load1_area).toFixed(2)

        var force_e4 = (applyload_1.l*(nume4)).toFixed(1)

        var TXMeshe4=createSpriteText1(force_e4,"KN",new THREE.Vector3((form_appl2b.x+form_appl1b.x)/2, (form_appl2b.y+form_appl1b.y)/2, (form_appl2b.z+form_appl1b.z)/2+0.1));
        form_group_forces.add(TXMeshe4);

        nume4_2 = (force_e4_area/force_load2_area).toFixed(2)

        var force_e4_2 = (applyload_2.l*(nume4_2)).toFixed(1)
        
        var TXMeshe4_2=createSpriteText1(force_e4_2,"KN",new THREE.Vector3((form_appl2b.x+form_appl1b.x)/2, (form_appl2b.y+form_appl1b.y)/2, (form_appl2b.z+form_appl1b.z)/2+0.1));
        form_group_forces2.add(TXMeshe4_2);

        nume4_3 = (force_e4_area/force_load3_area).toFixed(2)

        var force_e4_3 = (applyload_3.l*(nume4_3)).toFixed(1)
        
        var TXMeshe4_3=createSpriteText1(force_e4_3,"KN",new THREE.Vector3((form_appl2b.x+form_appl1b.x)/2, (form_appl2b.y+form_appl1b.y)/2, (form_appl2b.z+form_appl1b.z)/2+0.1));
        form_group_forces3.add(TXMeshe4_3);

        //edge5
        var force_e5_area1 = create_force_face_area(force_p3,force_p5,force_b2)
        var force_e5_area2 = create_force_face_area(force_p5,force_b2,force_b1)
        var force_e5_area = force_e5_area1 + force_e5_area2

        nume5 = (force_e5_area/force_load1_area).toFixed(2)

        var force_e5 = (applyload_1.l*(nume5)).toFixed(1)

        var TXMeshe5=createSpriteText1(force_e5,"KN",new THREE.Vector3((form_nsup3.x+form_appl2b.x)/2, (form_nsup3.y+form_appl2b.y)/2, (form_nsup3.z+form_appl2b.z)/2+0.1));
        form_group_forces.add(TXMeshe5);

        nume5_2 = (force_e5_area/force_load2_area).toFixed(2)

        var force_e5_2 = (applyload_2.l*(nume5_2)).toFixed(1)
        
        var TXMeshe5_2=createSpriteText1(force_e5_2,"KN",new THREE.Vector3((form_nsup3.x+form_appl2b.x)/2, (form_nsup3.y+form_appl2b.y)/2, (form_nsup3.z+form_appl2b.z)/2+0.1));
        form_group_forces2.add(TXMeshe5_2);

        nume5_3 = (force_e5_area/force_load3_area).toFixed(2)

        var force_e5_3 = (applyload_3.l*(nume5_3)).toFixed(1)
        
        var TXMeshe5_3=createSpriteText1(force_e5_3,"KN",new THREE.Vector3((form_nsup3.x+form_appl2b.x)/2, (form_nsup3.y+form_appl2b.y)/2, (form_nsup3.z+form_appl2b.z)/2+0.1));
        form_group_forces3.add(TXMeshe5_3);

        //edge6
        var force_e6_area1 = create_force_face_area(force_p5,force_p6,force_b3)
        var force_e6_area2 = create_force_face_area(force_p6,force_b3,force_b4)
        var force_e6_area = force_e6_area1 + force_e6_area2

        nume6 = (force_e6_area/force_load1_area).toFixed(2)

        var force_e6 = (applyload_1.l*(nume6)).toFixed(1)

        var TXMeshe6=createSpriteText1(force_e6,"KN",new THREE.Vector3((form_nsup4.x+form_appl2b.x)/2, (form_nsup4.y+form_appl2b.y)/2, (form_nsup4.z+form_appl2b.z)/2+0.1));
        form_group_forces.add(TXMeshe6);

        nume6_2 = (force_e6_area/force_load2_area).toFixed(2)

        var force_e6_2 = (applyload_2.l*(nume6_2)).toFixed(1)
        
        var TXMeshe6_2=createSpriteText1(force_e6_2,"KN",new THREE.Vector3((form_nsup4.x+form_appl2b.x)/2, (form_nsup4.y+form_appl2b.y)/2, (form_nsup4.z+form_appl2b.z)/2+0.1));
        form_group_forces2.add(TXMeshe6_2);

        nume6_3 = (force_e6_area/force_load3_area).toFixed(2)

        var force_e6_3 = (applyload_3.l*(nume6_3)).toFixed(1)
        
        var TXMeshe6_3=createSpriteText1(force_e6_3,"KN",new THREE.Vector3((form_nsup4.x+form_appl2b.x)/2, (form_nsup4.y+form_appl2b.y)/2, (form_nsup4.z+form_appl2b.z)/2+0.1));
        form_group_forces3.add(TXMeshe6_3);


        //edge7
        var force_e7_area1 = create_force_face_area(force_p4,force_p7,force_b2)
        var force_e7_area2 = create_force_face_area(force_p7,force_b2,force_b3)
        var force_e7_area3 = create_force_face_area(force_p7,force_b3,force_b4)
        var force_e7_area = force_e7_area1 + force_e7_area2 + force_e7_area3

        nume7 = (force_e7_area/force_load1_area).toFixed(2)

        var force_e7 = (applyload_1.l*(nume7)).toFixed(1)

        var TXMeshe7=createSpriteText1(force_e7,"KN",new THREE.Vector3((form_nsup2.x+form_appl2b.x)/2, (form_nsup2.y+form_appl2b.y)/2, (form_nsup2.z+form_appl2b.z)/2+0.1));
        form_group_forces.add(TXMeshe7);

        nume7_2 = (force_e7_area/force_load2_area).toFixed(2)

        var force_e7_2 = (applyload_2.l*(nume7_2)).toFixed(1)
        
        var TXMeshe7_2=createSpriteText1(force_e7_2,"KN",new THREE.Vector3((form_nsup2.x+form_appl2b.x)/2, (form_nsup2.y+form_appl2b.y)/2, (form_nsup2.z+form_appl2b.z)/2+0.1));
        form_group_forces2.add(TXMeshe7_2);

        nume7_3 = (force_e7_area/force_load3_area).toFixed(2)

        var force_e7_3 = (applyload_3.l*(nume7_3)).toFixed(1)
        
        var TXMeshe7_3=createSpriteText1(force_e7_3,"KN",new THREE.Vector3((form_nsup2.x+form_appl2b.x)/2, (form_nsup2.y+form_appl2b.y)/2, (form_nsup2.z+form_appl2b.z)/2+0.1));
        form_group_forces3.add(TXMeshe7_3);


        //edge8
        var force_e8_area1 = create_force_face_area(force_p6,force_p7,force_b4)
        var force_e8_area = force_e8_area1

        nume8 = (force_e8_area/force_load1_area).toFixed(2)

        var force_e8 = (applyload_1.l*(nume8)).toFixed(1)

        var TXMeshe8=createSpriteText1(force_e8,"KN",new THREE.Vector3((form_appl2b.x+form_appl3b.x)/2, (form_appl2b.y+form_appl3b.y)/2, (form_appl2b.z+form_appl3b.z)/2+0.1));
        form_group_forces.add(TXMeshe8);

        nume8_2 = (force_e8_area/force_load2_area).toFixed(2)

        var force_e8_2 = (applyload_2.l*(nume8_2)).toFixed(1)
        
        var TXMeshe8_2=createSpriteText1(force_e8_2,"KN",new THREE.Vector3((form_appl2b.x+form_appl3b.x)/2, (form_appl2b.y+form_appl3b.y)/2, (form_appl2b.z+form_appl3b.z)/2+0.1));
        form_group_forces2.add(TXMeshe8_2);

        nume8_3 = (force_e8_area/force_load3_area).toFixed(2)

        var force_e8_3 = (applyload_3.l*(nume8_3)).toFixed(1)
        
        var TXMeshe8_3=createSpriteText1(force_e8_3,"KN",new THREE.Vector3((form_appl2b.x+form_appl3b.x)/2, (form_appl2b.y+form_appl3b.y)/2, (form_appl2b.z+form_appl3b.z)/2+0.1));
        form_group_forces3.add(TXMeshe8_3);


        //edge9
        var force_e9_area1 = create_force_face_area(force_p6,force_p8,force_b4)
        var force_e9_area2 = create_force_face_area(force_p8,force_b4,force_b5)
        var force_e9_area = force_e9_area1 + force_e9_area2

        nume9 = (force_e9_area/force_load1_area).toFixed(2)

        var force_e9 = (applyload_1.l*(nume9)).toFixed(1)

        var TXMeshe9=createSpriteText1(force_e9,"KN",new THREE.Vector3((form_nsup4.x+form_appl3b.x)/2, (form_nsup4.y+form_appl3b.y)/2, (form_nsup4.z+form_appl3b.z)/2+0.1));
        form_group_forces.add(TXMeshe9);

        nume9_2 = (force_e9_area/force_load2_area).toFixed(2)

        var force_e9_2 = (applyload_2.l*(nume9_2)).toFixed(1)

        var TXMeshe9_2=createSpriteText1(force_e9_2,"KN",new THREE.Vector3((form_nsup4.x+form_appl3b.x)/2, (form_nsup4.y+form_appl3b.y)/2, (form_nsup4.z+form_appl3b.z)/2+0.1));
        form_group_forces2.add(TXMeshe9_2);

        nume9_3 = (force_e9_area/force_load3_area).toFixed(2)

        var force_e9_3 = (applyload_3.l*(nume9_3)).toFixed(1)
        
        var TXMeshe9_3=createSpriteText1(force_e9_3,"KN",new THREE.Vector3((form_nsup4.x+form_appl3b.x)/2, (form_nsup4.y+form_appl3b.y)/2, (form_nsup4.z+form_appl3b.z)/2+0.1));
        form_group_forces3.add(TXMeshe9_3);

        //edge10
        var force_e10_area1 = create_force_face_area(force_p8,force_p9,force_b5)

        var force_e10_area = force_e10_area1

        nume10 = (force_e10_area/force_load1_area).toFixed(2)

        var force_e10 = (applyload_1.l*(nume10)).toFixed(1)

        var TXMeshe10=createSpriteText1(force_e10,"KN",new THREE.Vector3((form_nsup5.x+form_appl3b.x)/2, (form_nsup5.y+form_appl3b.y)/2, (form_nsup5.z+form_appl3b.z)/2+0.1));
        form_group_forces.add(TXMeshe10);

        nume10_2 = (force_e10_area/force_load2_area).toFixed(2)

        var force_e10_2 = (applyload_2.l*(nume10_2)).toFixed(1)
        
        var TXMeshe10_2=createSpriteText1(force_e10_2,"KN",new THREE.Vector3((form_nsup5.x+form_appl3b.x)/2, (form_nsup5.y+form_appl3b.y)/2, (form_nsup5.z+form_appl3b.z)/2+0.1));
        form_group_forces2.add(TXMeshe10_2);

        nume10_3 = (force_e10_area/force_load3_area).toFixed(2)

        var force_e10_3 = (applyload_3.l*(nume10_3)).toFixed(1)
        
        var TXMeshe10_3=createSpriteText1(force_e10_3,"KN",new THREE.Vector3((form_nsup5.x+form_appl3b.x)/2, (form_nsup5.y+form_appl3b.y)/2, (form_nsup5.z+form_appl3b.z)/2+0.1));
        form_group_forces3.add(TXMeshe10_3);

        //edge11
        var force_e11_area1 = create_force_face_area(force_p7,force_p9,force_b4)
        var force_e11_area2 = create_force_face_area(force_p9,force_b4,force_b5)
        var force_e11_area = force_e11_area1 + force_e11_area2

        nume11 = (force_e11_area/force_load1_area).toFixed(2)

        var force_e11 = (applyload_1.l*(nume11)).toFixed(1)

        var TXMeshe11=createSpriteText1(force_e11,"KN",new THREE.Vector3((form_nsup2.x+form_appl3b.x)/2, (form_nsup2.y+form_appl3b.y)/2, (form_nsup2.z+form_appl3b.z)/2+0.1));
        form_group_forces.add(TXMeshe11);

        nume11_2 = (force_e11_area/force_load2_area).toFixed(2)

        var force_e11_2 = (applyload_2.l*(nume11_2)).toFixed(1)

        var TXMeshe11_2=createSpriteText1(force_e11_2,"KN",new THREE.Vector3((form_nsup2.x+form_appl3b.x)/2, (form_nsup2.y+form_appl3b.y)/2, (form_nsup2.z+form_appl3b.z)/2+0.1));
        form_group_forces2.add(TXMeshe11_2);

        nume11_3 = (force_e11_area/force_load3_area).toFixed(2)

        var force_e11_3 = (applyload_3.l*(nume11_3)).toFixed(1)
        
        var TXMeshe11_3=createSpriteText1(force_e11_3,"KN",new THREE.Vector3((form_nsup2.x+form_appl3b.x)/2, (form_nsup2.y+form_appl3b.y)/2, (form_nsup2.z+form_appl3b.z)/2+0.1));
        form_group_forces3.add(TXMeshe11_3);

        //edge12

        var force_e12_area1 = create_force_face_area(force_p2,force_b1a,force_b1)

        var force_e12_area = force_e12_area1

        nume12 = (force_e12_area/force_load1_area).toFixed(2)

        var force_e12 = (applyload_1.l*(nume12)).toFixed(1)

        var TXMeshe12=createSpriteText1(force_e12,"KN",new THREE.Vector3((form_nsup3.x+form_nsup1.x)/2, (form_nsup3.y+form_nsup1.y)/2, (form_nsup3.z+form_nsup1.z)/2+0.1));
        form_group_forces.add(TXMeshe12);

        nume12_2 = (force_e12_area/force_load2_area).toFixed(2)

        var force_e12_2 = (applyload_2.l*(nume12_2)).toFixed(1)

        var TXMeshe12_2=createSpriteText1(force_e12_2,"KN",new THREE.Vector3((form_nsup3.x+form_nsup1.x)/2, (form_nsup3.y+form_nsup1.y)/2, (form_nsup3.z+form_nsup1.z)/2+0.1));
        form_group_forces2.add(TXMeshe12_2);

        nume12_3 = (force_e12_area/force_load3_area).toFixed(2)

        var force_e12_3 = (applyload_3.l*(nume12_3)).toFixed(1)
        
        var TXMeshe12_3=createSpriteText1(force_e12_3,"KN",new THREE.Vector3((form_nsup3.x+form_nsup1.x)/2, (form_nsup3.y+form_nsup1.y)/2, (form_nsup3.z+form_nsup1.z)/2+0.1));
        form_group_forces3.add(TXMeshe12_3);

        //edge13
        var force_e13_area1 = create_force_face_area(force_p1,force_b1a,force_b1)

        var force_e13_area = force_e13_area1

        nume13 = (force_e13_area/force_load1_area).toFixed(2)

        var force_e13 = (applyload_1.l*(nume13)).toFixed(1)


        var TXMeshe13=createSpriteText1(force_e13,"KN",new THREE.Vector3((form_nsup2.x+form_nsup1.x)/2, (form_nsup2.y+form_nsup1.y)/2, (form_nsup2.z+form_nsup1.z)/2+0.1));
        form_group_forces.add(TXMeshe13);

        nume13_2 = (force_e13_area/force_load2_area).toFixed(2)

        var force_e13_2 = (applyload_2.l*(nume13_2)).toFixed(1)
        
        var TXMeshe13_2=createSpriteText1(force_e13_2,"KN",new THREE.Vector3((form_nsup2.x+form_nsup1.x)/2, (form_nsup2.y+form_nsup1.y)/2, (form_nsup2.z+form_nsup1.z)/2+0.1));
        form_group_forces2.add(TXMeshe13_2);

        nume13_3 = (force_e13_area/force_load3_area).toFixed(2)

        var force_e13_3 = (applyload_3.l*(nume13_3)).toFixed(1)
        
        var TXMeshe13_3=createSpriteText1(force_e13_3,"KN",new THREE.Vector3((form_nsup2.x+form_nsup1.x)/2, (form_nsup2.y+form_nsup1.y)/2, (form_nsup2.z+form_nsup1.z)/2+0.1));
        form_group_forces3.add(TXMeshe13_3);

         //edge14
         var force_e14_area1 = create_force_face_area(force_b1a,force_b1,force_b2)
         var force_e14_area2 = create_force_face_area(force_b1a,force_b2,force_b3a)
         var force_e14_area3 = create_force_face_area(force_b3a,force_b2,force_b3)

        var force_e14_area = force_e14_area1 + force_e14_area2 + force_e14_area3

        nume14 = (force_e14_area/force_load1_area).toFixed(2)

        var force_e14 = (applyload_1.l*(nume14)).toFixed(1)

        var TXMeshe14=createSpriteText1(force_e14,"KN",new THREE.Vector3((form_nsup2.x+form_nsup3.x)/2, (form_nsup2.y+form_nsup3.y)/2, (form_nsup2.z+form_nsup3.z)/2+0.1));
        form_group_forces.add(TXMeshe14);

        nume14_2 = (force_e14_area/force_load2_area).toFixed(2)

        var force_e14_2 = (applyload_2.l*(nume14_2)).toFixed(1)
        
        var TXMeshe14_2=createSpriteText1(force_e14_2,"KN",new THREE.Vector3((form_nsup2.x+form_nsup3.x)/2, (form_nsup2.y+form_nsup3.y)/2, (form_nsup2.z+form_nsup3.z)/2+0.1));
        form_group_forces2.add(TXMeshe14_2);

        nume14_3 = (force_e14_area/force_load3_area).toFixed(2)

        var force_e14_3 = (applyload_3.l*(nume14_3)).toFixed(1)
        
        var TXMeshe14_3=createSpriteText1(force_e14_3,"KN",new THREE.Vector3((form_nsup2.x+form_nsup3.x)/2, (form_nsup2.y+form_nsup3.y)/2, (form_nsup2.z+form_nsup3.z)/2+0.1));
        form_group_forces3.add(TXMeshe14_3);

         //edge15
         var force_e15_area1 = create_force_face_area(force_b3a,force_p5,force_b3)


        var force_e15_area = force_e15_area1

        nume15 = (force_e15_area/force_load1_area).toFixed(2)

        var force_e15 = (applyload_1.l*(nume15)).toFixed(1)

        var TXMeshe15=createSpriteText1(force_e15,"KN",new THREE.Vector3((form_nsup4.x+form_nsup3.x)/2, (form_nsup4.y+form_nsup3.y)/2, (form_nsup4.z+form_nsup3.z)/2+0.1));
        form_group_forces.add(TXMeshe15);

        nume15_2 = (force_e15_area/force_load2_area).toFixed(2)

        var force_e15_2 = (applyload_2.l*(nume15_2)).toFixed(1)
        
        var TXMeshe15_2=createSpriteText1(force_e15_2,"KN",new THREE.Vector3((form_nsup4.x+form_nsup3.x)/2, (form_nsup4.y+form_nsup3.y)/2, (form_nsup4.z+form_nsup3.z)/2+0.1));
        form_group_forces2.add(TXMeshe15_2);

        nume15_3 = (force_e15_area/force_load3_area).toFixed(2)

        var force_e15_3 = (applyload_3.l*(nume15_3)).toFixed(1)
        
        var TXMeshe15_3=createSpriteText1(force_e15_3,"KN",new THREE.Vector3((form_nsup4.x+form_nsup3.x)/2, (form_nsup4.y+form_nsup3.y)/2, (form_nsup4.z+form_nsup3.z)/2+0.1));
        form_group_forces3.add(TXMeshe15_3);

           //edge16
         var force_e16_area1 = create_force_face_area(force_b3a,force_b3,force_b4)
         var force_e16_area2 = create_force_face_area(force_b3a,force_b4,force_b5a)
         var force_e16_area3 = create_force_face_area(force_b5a,force_b4,force_b5)

        var force_e16_area = force_e16_area1 + force_e16_area2 + force_e16_area3

        nume16 = (force_e16_area/force_load1_area).toFixed(2)

        var force_e16 = (applyload_1.l*(nume16)).toFixed(1)

        var TXMeshe16=createSpriteText1(force_e16,"KN",new THREE.Vector3((form_nsup4.x+form_nsup2.x)/2, (form_nsup4.y+form_nsup2.y)/2, (form_nsup4.z+form_nsup2.z)/2+0.1));
        form_group_forces.add(TXMeshe16);

        nume16_2 = (force_e16_area/force_load2_area).toFixed(2)

        var force_e16_2 = (applyload_2.l*(nume16_2)).toFixed(1)
        
        var TXMeshe16_2 =createSpriteText1(force_e16_2,"KN",new THREE.Vector3((form_nsup4.x+form_nsup2.x)/2, (form_nsup4.y+form_nsup2.y)/2, (form_nsup4.z+form_nsup2.z)/2+0.1));
        form_group_forces2.add(TXMeshe16_2);

        nume16_3 = (force_e16_area/force_load3_area).toFixed(2)

        var force_e16_3 = (applyload_3.l*(nume16_3)).toFixed(1)
        
        var TXMeshe16_3 =createSpriteText1(force_e16_3,"KN",new THREE.Vector3((form_nsup4.x+form_nsup2.x)/2, (form_nsup4.y+form_nsup2.y)/2, (form_nsup4.z+form_nsup2.z)/2+0.1));
        form_group_forces3.add(TXMeshe16_3);


         //edge17
         var force_e17_area1 = create_force_face_area(force_b5a,force_p8,force_b5)


        var force_e17_area = force_e17_area1

        nume17 = (force_e17_area/force_load1_area).toFixed(2)

        var force_e17 = (applyload_1.l*(nume17)).toFixed(1)

        var TXMeshe17=createSpriteText1(force_e17,"KN",new THREE.Vector3((form_nsup4.x+form_nsup5.x)/2, (form_nsup4.y+form_nsup5.y)/2, (form_nsup4.z+form_nsup5.z)/2+0.1));
        form_group_forces.add(TXMeshe17);

        nume17_2 = (force_e17_area/force_load2_area).toFixed(2)

        var force_e17_2 = (applyload_2.l*(nume17_2)).toFixed(1)

        var TXMeshe17_2=createSpriteText1(force_e17_2,"KN",new THREE.Vector3((form_nsup4.x+form_nsup5.x)/2, (form_nsup4.y+form_nsup5.y)/2, (form_nsup4.z+form_nsup5.z)/2+0.1));
        form_group_forces2.add(TXMeshe17_2);

        nume17_3 = (force_e17_area/force_load3_area).toFixed(2)

        var force_e17_3 = (applyload_3.l*(nume17_3)).toFixed(1)
        
        var TXMeshe17_3=createSpriteText1(force_e17_3,"KN",new THREE.Vector3((form_nsup4.x+form_nsup5.x)/2, (form_nsup4.y+form_nsup5.y)/2, (form_nsup4.z+form_nsup5.z)/2+0.1));
        form_group_forces3.add(TXMeshe17_3);


         //edge18
         var force_e18_area1 = create_force_face_area(force_b5a,force_p9,force_b5)


        var force_e18_area = force_e18_area1

        nume18 = (force_e18_area/force_load1_area).toFixed(2)

        var force_e18 = (applyload_1.l*(nume18)).toFixed(1)

        var TXMeshe18=createSpriteText1(force_e18,"KN",new THREE.Vector3((form_nsup2.x+form_nsup5.x)/2, (form_nsup2.y+form_nsup5.y)/2, (form_nsup2.z+form_nsup5.z)/2+0.1));
        form_group_forces.add(TXMeshe18);

        nume18_2 = (force_e18_area/force_load2_area).toFixed(2)

        var force_e18_2 = (applyload_2.l*(nume18_2)).toFixed(1)
        
        var TXMeshe18_2=createSpriteText1(force_e18_2,"KN",new THREE.Vector3((form_nsup2.x+form_nsup5.x)/2, (form_nsup2.y+form_nsup5.y)/2, (form_nsup2.z+form_nsup5.z)/2+0.1));
        form_group_forces2.add(TXMeshe18_2);

        nume18_3 = (force_e18_area/force_load3_area).toFixed(2)

        var force_e18_3 = (applyload_3.l*(nume18_3)).toFixed(1)
        
        var TXMeshe18_3=createSpriteText1(force_e18_3,"KN",new THREE.Vector3((form_nsup2.x+form_nsup5.x)/2, (form_nsup2.y+form_nsup5.y)/2, (form_nsup2.z+form_nsup5.z)/2+0.1));
        form_group_forces3.add(TXMeshe18_3);


        var force_edge = [];

        force_edge.push(force_p1);
        force_edge.push(force_b1);

        force_edge.push(force_p2);
        force_edge.push(force_b1);

        force_edge.push(force_p3);
        force_edge.push(force_b2);

        force_edge.push(force_p3);
        force_edge.push(force_p4);

        force_edge.push(force_p4);
        force_edge.push(force_b2);

        force_edge.push(force_b1);
        force_edge.push(force_b2);

        force_edge.push(force_b2);
        force_edge.push(force_b3);

        force_edge.push(force_p5);
        force_edge.push(force_b3);

        force_edge.push(force_p6);
        force_edge.push(force_b4);

        force_edge.push(force_p6);
        force_edge.push(force_p7);

        force_edge.push(force_p7);
        force_edge.push(force_b4);

        force_edge.push(force_b3);
        force_edge.push(force_b4);

        force_edge.push(force_b4);
        force_edge.push(force_b5);

        force_edge.push(force_p8);
        force_edge.push(force_b5);

        force_edge.push(force_p9);
        force_edge.push(force_b5);

        var force_geo1 = new THREE.Geometry().setFromPoints(force_edge);
        var force_m = new THREE.LineDashedMaterial({
            color: 0x0F3150,//color
            dashSize: 0.05,
            gapSize: 0.03,
            linewidth: 1

        });
        var force_edges = new THREE.LineSegments(force_geo1, force_m);

        force_group_test.add(force_edges);

        var force_edge2 = [];

        force_edge2.push(force_b1a);
        force_edge2.push(force_p1);

        force_edge2.push(force_b1a);
        force_edge2.push(force_p2);

        force_edge2.push(force_b1a);
        force_edge2.push(force_b3a);

        force_edge2.push(force_b3a);
        force_edge2.push(force_p5);

        force_edge2.push(force_b3a);
        force_edge2.push(force_b5a);

        force_edge2.push(force_b5a);
        force_edge2.push(force_p9);

        force_edge2.push(force_b5a);
        force_edge2.push(force_p8);

        var force_geo2 = new THREE.Geometry().setFromPoints(force_edge2);
        var force_t = new THREE.LineDashedMaterial({
            color: 0x80002F,//color
            dashSize: 0.05,
            gapSize: 0.03,
            linewidth: 1

        });
        var force_edges2 = new THREE.LineSegments(force_geo2, force_t);

        force_group_test.add(force_edges2);

        function force_4greenfaces(p1, p2, p3, p4) {
            var vertices = [
                p1, p2, p3, p4
            ];

            var faces = [
                new THREE.Face3(2, 1, 0),
                new THREE.Face3(3, 2, 0),

            ];

            var geom = new THREE.Geometry();
            geom.vertices = vertices;
            geom.faces = faces;
            geom.computeFaceNormals();
            var material_greenfaces = [
                //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                new THREE.MeshBasicMaterial({ color: "white", wireframe: false, transparent: true, opacity: 0.4 }),
                new THREE.MeshPhongMaterial({
                    color: 0x009600, transparent: true, opacity: 0.3, side: THREE.DoubleSide, depthWrite: false
                })
            ];

            var greenface_O2P3 = THREE.SceneUtils.createMultiMaterialObject(geom, material_greenfaces);

            force_group_test.add(greenface_O2P3);
        }

        function force_3greenfaces(p1, p2, p3) {
            var vertices = [
                p1, p2, p3
            ];

            var faces = [
                new THREE.Face3(2, 1, 0),
            ];

            var geom = new THREE.Geometry();
            geom.vertices = vertices;
            geom.faces = faces;
            geom.computeFaceNormals();
            var material_greenfaces = [
                //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                new THREE.MeshBasicMaterial({ color: "white", wireframe: false, transparent: true, opacity: 0.4 }),
                new THREE.MeshPhongMaterial({
                    color: 0x009600, transparent: true, opacity: 0.3, side: THREE.DoubleSide, depthWrite: false
                })
            ];

            var greenface_O2P3 = THREE.SceneUtils.createMultiMaterialObject(geom, material_greenfaces);

            force_group_test.add(greenface_O2P3);
        }

        function force_4bluefaces(p1, p2, p3, p4) {
            var vertices = [
                p1, p2, p3, p4
            ];

            var faces = [
                new THREE.Face3(2, 1, 0),
                new THREE.Face3(3, 2, 0),

            ];

            var geom = new THREE.Geometry();
            geom.vertices = vertices;
            geom.faces = faces;
            geom.computeFaceNormals();
            var material_greenfaces = [
                //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                new THREE.MeshBasicMaterial({ color: "white", wireframe: false, transparent: true, opacity: 0.4 }),
                new THREE.MeshPhongMaterial({
                    color: 0x0F3150, transparent: true, opacity: 0.3, side: THREE.DoubleSide, depthWrite: false
                })
            ];

            var greenface_O2P3 = THREE.SceneUtils.createMultiMaterialObject(geom, material_greenfaces);

            force_group_test.add(greenface_O2P3);
        }

        function form_4bluefaces(p1, p2, p3, p4) {
            var vertices = [
                p1, p2, p3, p4
            ];

            var faces = [
                new THREE.Face3(2, 1, 0),
                new THREE.Face3(3, 2, 0),

            ];

            var geom = new THREE.Geometry();
            geom.vertices = vertices;
            geom.faces = faces;
            geom.computeFaceNormals();
            var material_greenfaces = [
                //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                new THREE.MeshBasicMaterial({ color: "white", wireframe: false, transparent: true, opacity: 0.4 }),
                new THREE.MeshPhongMaterial({
                    color: 0x0F3150, transparent: true, opacity: 0.3, side: THREE.DoubleSide, depthWrite: false
                })
            ];

            var greenface_O2P3 = THREE.SceneUtils.createMultiMaterialObject(geom, material_greenfaces);

            form_group_mink.add(greenface_O2P3);
        }
        function force_3bluefaces(p1, p2, p3) {
            var vertices = [
                p1, p2, p3
            ];

            var faces = [
                new THREE.Face3(2, 1, 0),

            ];

            var geom = new THREE.Geometry();
            geom.vertices = vertices;
            geom.faces = faces;
            geom.computeFaceNormals();
            var material_greenfaces = [
                //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                new THREE.MeshBasicMaterial({ color: "white", wireframe: false, transparent: true, opacity: 0.4 }),
                new THREE.MeshPhongMaterial({
                    color: 0x0F3150, transparent: true, opacity: 0.3, side: THREE.DoubleSide, depthWrite: false
                })
            ];

            var greenface_O2P3 = THREE.SceneUtils.createMultiMaterialObject(geom, material_greenfaces);

            force_group_test.add(greenface_O2P3);
        }

        function form_3bluefaces(p1, p2, p3) {
            var vertices = [
                p1, p2, p3
            ];

            var faces = [
                new THREE.Face3(2, 1, 0),

            ];

            var geom = new THREE.Geometry();
            geom.vertices = vertices;
            geom.faces = faces;
            geom.computeFaceNormals();
            var material_greenfaces = [
                //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                new THREE.MeshBasicMaterial({ color: "white", wireframe: false, transparent: true, opacity: 0.4 }),
                new THREE.MeshPhongMaterial({
                    color: 0x0F3150, transparent: true, opacity: 0.3, side: THREE.DoubleSide, depthWrite: false
                })
            ];

            var greenface_O2P3 = THREE.SceneUtils.createMultiMaterialObject(geom, material_greenfaces);

            form_group_mink.add(greenface_O2P3);
        }

        function force_3redfaces(p1, p2, p3) {
            var vertices = [
                p1, p2, p3
            ];

            var faces = [
                new THREE.Face3(2, 1, 0),

            ];

            var geom = new THREE.Geometry();
            geom.vertices = vertices;
            geom.faces = faces;
            geom.computeFaceNormals();
            var material_greenfaces = [
                //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                new THREE.MeshBasicMaterial({ color: "white", wireframe: false, transparent: true, opacity: 0.4 }),
                new THREE.MeshPhongMaterial({
                    color: 0x80002F, transparent: true, opacity: 0.3, side: THREE.DoubleSide, depthWrite: false
                })
            ];

            var greenface_O2P3 = THREE.SceneUtils.createMultiMaterialObject(geom, material_greenfaces);

            force_group_test.add(greenface_O2P3);
        }
        function force_4redfaces(p1, p2, p3, p4) {
            var vertices = [
                p1, p2, p3, p4
            ];

            var faces = [
                new THREE.Face3(2, 1, 0),
                new THREE.Face3(3, 2, 0),

            ];

            var geom = new THREE.Geometry();
            geom.vertices = vertices;
            geom.faces = faces;
            geom.computeFaceNormals();
            var material_greenfaces = [
                //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                new THREE.MeshBasicMaterial({ color: "white", wireframe: false, transparent: true, opacity: 0.4 }),
                new THREE.MeshPhongMaterial({
                    color: 0x80002F, transparent: true, opacity: 0.3, side: THREE.DoubleSide, depthWrite: false
                })
            ];

            var greenface_O2P3 = THREE.SceneUtils.createMultiMaterialObject(geom, material_greenfaces);

            force_group_test.add(greenface_O2P3);
        }
        function form_4redfaces(p1, p2, p3, p4) {
            var vertices = [
                p1, p2, p3, p4
            ];

            var faces = [
                new THREE.Face3(2, 1, 0),
                new THREE.Face3(3, 2, 0),

            ];

            var geom = new THREE.Geometry();
            geom.vertices = vertices;
            geom.faces = faces;
            geom.computeFaceNormals();
            var material_greenfaces = [
                //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                new THREE.MeshBasicMaterial({ color: "white", wireframe: false, transparent: true, opacity: 0.4 }),
                new THREE.MeshPhongMaterial({
                    color: 0x80002F, transparent: true, opacity: 0.3, side: THREE.DoubleSide, depthWrite: false
                })
            ];

            var greenface_O2P3 = THREE.SceneUtils.createMultiMaterialObject(geom, material_greenfaces);

            form_group_mink.add(greenface_O2P3);
        }
        function form_3redfaces(p1, p2, p3) {
            var vertices = [
                p1, p2, p3
            ];

            var faces = [
                new THREE.Face3(2, 1, 0),

            ];

            var geom = new THREE.Geometry();
            geom.vertices = vertices;
            geom.faces = faces;
            geom.computeFaceNormals();
            var material_greenfaces = [
                //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                new THREE.MeshBasicMaterial({ color: "white", wireframe: false, transparent: true, opacity: 0.4 }),
                new THREE.MeshPhongMaterial({
                    color: 0x80002F, transparent: true, opacity: 0.3, side: THREE.DoubleSide, depthWrite: false
                })
            ];

            var greenface_O2P3 = THREE.SceneUtils.createMultiMaterialObject(geom, material_greenfaces);

            form_group_mink.add(greenface_O2P3);
        }
        function form_4greenfaces(p1, p2, p3, p4) {
            var vertices = [
                p1, p2, p3, p4
            ];

            var faces = [
                new THREE.Face3(2, 1, 0),
                new THREE.Face3(3, 2, 0),

            ];

            var geom = new THREE.Geometry();
            geom.vertices = vertices;
            geom.faces = faces;
            geom.computeFaceNormals();
            var material_greenfaces = [
                //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                new THREE.MeshBasicMaterial({ color: "white", wireframe: false, transparent: true, opacity: 0.4 }),
                new THREE.MeshPhongMaterial({
                    color: 0x009600, transparent: true, opacity: 0.3, side: THREE.DoubleSide, depthWrite: false
                })
            ];

            var greenface_O2P3 = THREE.SceneUtils.createMultiMaterialObject(geom, material_greenfaces);

            form_group_mink.add(greenface_O2P3);
        }

        function form_3greenfaces(p1, p2, p3) {
            var vertices = [
                p1, p2, p3
            ];

            var faces = [
                new THREE.Face3(2, 1, 0),
            ];

            var geom = new THREE.Geometry();
            geom.vertices = vertices;
            geom.faces = faces;
            geom.computeFaceNormals();
            var material_greenfaces = [
                //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                new THREE.MeshBasicMaterial({ color: "white", wireframe: false, transparent: true, opacity: 0.4 }),
                new THREE.MeshPhongMaterial({
                    color: 0x009600, transparent: true, opacity: 0.3, side: THREE.DoubleSide, depthWrite: false
                })
            ];

            var greenface_O2P3 = THREE.SceneUtils.createMultiMaterialObject(geom, material_greenfaces);

            form_group_mink.add(greenface_O2P3);
        }

        var force_f1 = force_3greenfaces(force_p1,force_p2,force_p4)
        var force_f1a = force_3greenfaces(force_p2,force_p3,force_p4)
        var force_f2a = force_3greenfaces(force_p3,force_p5,force_p4)
        var force_f2b = force_3greenfaces(force_p4,force_p5,force_p7)
        var force_f2c = force_3greenfaces(force_p7,force_p5,force_p6)
        var force_f3 = force_3greenfaces(force_p7,force_p6,force_p9)
        var force_f3b = force_3greenfaces(force_p9,force_p6,force_p8)

        var force_cf1 = force_3bluefaces(force_b1,force_p2,force_p1)
        var force_cf2 = force_4bluefaces(force_p1,force_b1,force_b2,force_p4)
        var force_cf3 = force_4bluefaces(force_p3,force_b2,force_b1,force_p2)
        var force_cf4 = force_3bluefaces(force_b2,force_p3,force_p4)
        var force_cf5 = force_4bluefaces(force_p5,force_b3,force_b2,force_p3)
        var force_cf6a = force_4bluefaces(force_p7,force_p4,force_b2,force_b3)
        var force_cf6b = force_3bluefaces(force_b4,force_p7,force_b3)
        var force_cf7 = force_4bluefaces(force_p6,force_b4,force_b3,force_p5)
        var force_cf8 = force_3bluefaces(force_p7,force_b4,force_p6)
        var force_cf9 = force_4bluefaces(force_p8,force_b5,force_b4,force_p6)
        var force_cf10 = force_4bluefaces(force_p7,force_b4,force_b5,force_p9)
        var force_cf11 = force_3bluefaces(force_p9,force_b5,force_p8)

        var force_tf1 = force_3redfaces(force_b1a,force_b1,force_p1)
        var force_tf2 = force_3redfaces(force_b1a,force_b1,force_p2)
        var force_tf3a = force_4redfaces(force_b1a,force_b1,force_b2,force_b3a)
        var force_tf3b = force_3redfaces(force_b3a,force_b2,force_b3)
        var force_tf4 = force_3redfaces(force_b3a,force_p5,force_b3)
        var force_tf5a = force_4redfaces(force_b3a,force_b3,force_b4,force_b5a)
        var force_tf5b = force_3redfaces(force_b5a,force_b4,force_b5)
        var force_tf6 = force_3redfaces(force_b5a,force_b5,force_p8)
        var force_tf7 = force_3redfaces(force_b5a,force_b5,force_p9)



        //minkowski test

        //edge 1

        var form_mink_1 = new THREE.Vector3(force_test12b.x - force_test2end.x, force_test12b.y - force_test2end.y, force_test12b.z - force_test2end.z);


        var form_mink_1_1 = new THREE.Vector3(form_nsup1.x - minkscale1.l * form_mink_1.x, form_nsup1.y - minkscale1.l * form_mink_1.y, form_nsup1.z - minkscale1.l * form_mink_1.z);
        var form_mink_12_1 = new THREE.Vector3(form_appl1b.x - minkscale1.l * form_mink_1.x, form_appl1b.y - minkscale1.l * form_mink_1.y, form_appl1b.z - minkscale1.l * form_mink_1.z);
        var form_mink_13_1 = new THREE.Vector3(form_nsup3.x - minkscale1.l * form_mink_1.x, form_nsup3.y - minkscale1.l * form_mink_1.y, form_nsup3.z - minkscale1.l * form_mink_1.z);

        //edge 2

        var form_mink_2 = new THREE.Vector3(force_test1.x - force_test12b.x, force_test1.y - force_test12b.y, force_test1.z - force_test12b.z);

        var form_mink_2_1 = new THREE.Vector3(form_nsup1.x + minkscale1.l * form_mink_2.x, form_nsup1.y + minkscale1.l * form_mink_2.y, form_nsup1.z + minkscale1.l * form_mink_2.z);
        var form_mink_22_1 = new THREE.Vector3(form_appl1b.x + minkscale1.l * form_mink_2.x, form_appl1b.y + minkscale1.l * form_mink_2.y, form_appl1b.z + minkscale1.l * form_mink_2.z);
        var form_mink_23_1 = new THREE.Vector3(form_nsup2.x + minkscale1.l * form_mink_2.x, form_nsup2.y + minkscale1.l * form_mink_2.y, form_nsup2.z + minkscale1.l * form_mink_2.z);

        //edge 3

        var form_mink_3 = new THREE.Vector3(force_test34b.x - force_test12b.x, force_test34b.y - force_test12b.y, force_test34b.z - force_test12b.z);

        var form_mink_3_1 = new THREE.Vector3(form_appl1b.x + minkscale1.l * form_mink_3.x, form_appl1b.y + minkscale1.l * form_mink_3.y, form_appl1b.z + minkscale1.l * form_mink_3.z);
        var form_mink_32_1 = new THREE.Vector3(form_nsup2.x + minkscale1.l * form_mink_3.x, form_nsup2.y + minkscale1.l * form_mink_3.y, form_nsup2.z + minkscale1.l * form_mink_3.z);
        var form_mink_33_1 = new THREE.Vector3(form_nsup3.x + minkscale1.l * form_mink_3.x, form_nsup3.y + minkscale1.l * form_mink_3.y, form_nsup3.z + minkscale1.l * form_mink_3.z);

        //edge 4

        var form_mink_4 = new THREE.Vector3(force_test34b.x - force_test3end.x, force_test34b.y - force_test3end.y, force_test34b.z - force_test3end.z);

        var form_mink_4end = new THREE.Vector3(form_mink_3_1.x - 2 * form_mink_4.x, form_mink_3_1.y - 2 * form_mink_4.y, form_mink_3_1.z - 2 * form_mink_4.z);
        var form_mink_4end2 = new THREE.Vector3(form_mink_33_1.x - 2 * form_mink_4.x, form_mink_33_1.y - 2 * form_mink_4.y, form_mink_33_1.z - 2 * form_mink_4.z);

        var form_mink_5 = new THREE.Vector3(force_test2end.x - force_test3end.x, force_test2end.y - force_test3end.y, force_test2end.z - force_test3end.z);

        var form_mink_5end = new THREE.Vector3(form_mink_12_1.x - 2 * form_mink_5.x, form_mink_12_1.y - 2 * form_mink_5.y, form_mink_12_1.z - 2 * form_mink_5.z);
        var form_mink_5end2 = new THREE.Vector3(form_mink_13_1.x - 2 * form_mink_5.x, form_mink_13_1.y - 2 * form_mink_5.y, form_mink_13_1.z - 2 * form_mink_5.z);

        var dir1 = new THREE.Vector3(); // create once an reuse it

        dir1.subVectors(form_mink_3_1, form_mink_4end).normalize();

        var dir2 = new THREE.Vector3(); // create once an reuse it

        dir2.subVectors(form_mink_12_1, form_mink_5end).normalize();
        var form_mink_4_1 = LinesSectPt(dir1, form_mink_4end, dir2, form_mink_5end);

        var dir12 = new THREE.Vector3(); // create once an reuse it

        dir12.subVectors(form_mink_33_1, form_mink_4end2).normalize();

        var dir22 = new THREE.Vector3(); // create once an reuse it

        dir22.subVectors(form_mink_13_1, form_mink_5end2).normalize();
        var form_mink_42_1 = LinesSectPt(dir12, form_mink_4end2, dir22, form_mink_5end2);

        //edge 5

        var form_mink_6 = new THREE.Vector3(force_test34b.x - force_test4.x, force_test34b.y - force_test4.y, force_test34b.z - force_test4.z);

        var form_mink_6end = new THREE.Vector3(form_mink_3_1.x - 2 * form_mink_6.x, form_mink_3_1.y - 2 * form_mink_6.y, form_mink_3_1.z - 2 * form_mink_6.z);
        var form_mink_6end2 = new THREE.Vector3(form_mink_32_1.x - 2 * form_mink_6.x, form_mink_32_1.y - 2 * form_mink_6.y, form_mink_32_1.z - 2 * form_mink_6.z);

        var form_mink_7 = new THREE.Vector3(force_test1.x - force_test4.x, force_test1.y - force_test4.y, force_test1.z - force_test4.z);

        var form_mink_7end = new THREE.Vector3(form_mink_22_1.x - 2 * form_mink_7.x, form_mink_22_1.y - 2 * form_mink_7.y, form_mink_22_1.z - 2 * form_mink_7.z);
        var form_mink_7end2 = new THREE.Vector3(form_mink_23_1.x - 2 * form_mink_7.x, form_mink_23_1.y - 2 * form_mink_7.y, form_mink_23_1.z - 2 * form_mink_7.z);

        var dir1 = new THREE.Vector3(); // create once an reuse it

        dir1.subVectors(form_mink_3_1, form_mink_6end).normalize();

        var dir2 = new THREE.Vector3(); // create once an reuse it

        dir2.subVectors(form_mink_22_1, form_mink_7end).normalize();
        var form_mink_5_1 = LinesSectPt(dir1, form_mink_6end, dir2, form_mink_7end);


        var dir12 = new THREE.Vector3(); // create once an reuse it

        dir12.subVectors(form_mink_32_1, form_mink_6end2).normalize();

        var dir22 = new THREE.Vector3(); // create once an reuse it

        dir22.subVectors(form_mink_23_1, form_mink_7end2).normalize();
        var form_mink_52_1 = LinesSectPt(dir12, form_mink_6end2, dir22, form_mink_7end2);

        //edge 6

        var form_mink_8 = new THREE.Vector3(force_p3.x - force_p5.x, force_p3.y - force_p5.y, force_p3.z - force_p5.z);

        var form_mink_8_1= new THREE.Vector3(form_mink_42_1.x - minkscale1.l * form_mink_8.x, form_mink_42_1.y - minkscale1.l * form_mink_8.y, form_mink_42_1.z - minkscale1.l * form_mink_8.z);

        //edge 7

        var form_mink_9 = new THREE.Vector3(force_b2.x - force_b3.x, force_b2.y - force_b3.y, force_b2.z - force_b3.z);

        var form_mink_9_1= new THREE.Vector3(form_mink_33_1.x - minkscale1.l * form_mink_9.x, form_mink_33_1.y - minkscale1.l * form_mink_9.y, form_mink_33_1.z - minkscale1.l * form_mink_9.z);
        var form_mink_9_2= new THREE.Vector3(form_mink_32_1.x - minkscale1.l * form_mink_9.x, form_mink_32_1.y - minkscale1.l * form_mink_9.y, form_mink_32_1.z - minkscale1.l * form_mink_9.z);

        //edge 8

        var form_mink_10 = new THREE.Vector3(form_appl2.x - form_nsup3.x, form_appl2.y - form_nsup3.y, (form_appl2.z-0.4) - form_nsup3.z);

        var form_mink_10_1 = new THREE.Vector3(form_mink_42_1.x + form_mink_10.x,form_mink_42_1.y + form_mink_10.y,form_mink_42_1.z + form_mink_10.z)
        var form_mink_10_2 = new THREE.Vector3(form_mink_33_1.x + form_mink_10.x,form_mink_33_1.y + form_mink_10.y,form_mink_33_1.z + form_mink_10.z)
        var form_mink_10_3 = new THREE.Vector3(form_mink_8_1.x + form_mink_10.x,form_mink_8_1.y + form_mink_10.y,form_mink_8_1.z + form_mink_10.z)
        var form_mink_10_4 = new THREE.Vector3(form_mink_9_1.x + form_mink_10.x,form_mink_9_1.y + form_mink_10.y,form_mink_9_1.z + form_mink_10.z)

        //edge 9

        var form_mink_11 = new THREE.Vector3(form_appl2.x - form_appl1.x, form_appl2.y - form_appl1.y, form_appl2.z - form_appl1.z);
        var form_mink_11_1 = new THREE.Vector3(form_mink_4_1.x + form_mink_11.x,form_mink_4_1.y + form_mink_11.y,form_mink_4_1.z + form_mink_11.z)
        // form_mink_11_1 is the same point as form_mink_10_1
        var form_mink_11_2 = new THREE.Vector3(form_mink_5_1.x + form_mink_11.x,form_mink_5_1.y + form_mink_11.y,form_mink_5_1.z + form_mink_11.z)

        //edge 10

        var form_mink12 = new THREE.Vector3(force_p4.x - force_p7.x, force_p4.y - force_p7.y, force_p4.z - force_p7.z);
        var form_mink12_1 = new THREE.Vector3(form_mink_52_1.x - minkscale1.l * form_mink12.x, form_mink_52_1.y - minkscale1.l * form_mink12.y, form_mink_52_1.z - minkscale1.l * form_mink12.z);
        var form_mink12_2 = new THREE.Vector3(form_mink_32_1.x - minkscale1.l * form_mink12.x, form_mink_32_1.y - minkscale1.l * form_mink12.y, form_mink_32_1.z - minkscale1.l * form_mink12.z);

        //edge 11

        var form_mink13 = new THREE.Vector3(form_appl2.x - form_nsup2.x, form_appl2.y - form_nsup2.y, (form_appl2.z-0.4) - form_nsup2.z);
        var form_mink13_1 = new THREE.Vector3(form_mink12_1.x + form_mink13.x,form_mink12_1.y + form_mink13.y,form_mink12_1.z + form_mink13.z)

        //edge 11
        var form_mink14 = new THREE.Vector3(force_b3.x - force_b4.x, force_b3.y - force_b4.y, force_b3.z - force_b4.z);
        var form_mink14_1 = new THREE.Vector3(form_mink_9_2.x - minkscale1.l * form_mink14.x, form_mink_9_2.y - minkscale1.l * form_mink14.y, form_mink_9_2.z - minkscale1.l * form_mink14.z);
        var form_mink14_2 = new THREE.Vector3(form_mink14_1.x + form_mink13.x,form_mink14_1.y + form_mink13.y,form_mink14_1.z + form_mink13.z)

        //edge 12
        var form_mink15 = new THREE.Vector3(force_p5.x - force_p6.x, force_p5.y - force_p6.y, force_p5.z - force_p6.z);
        var form_mink15_1 = new THREE.Vector3(form_mink_10_3.x - minkscale1.l * form_mink15.x, form_mink_10_3.y - minkscale1.l * form_mink15.y, form_mink_10_3.z - minkscale1.l * form_mink15.z);

        //edge 13
        var form_mink16 = new THREE.Vector3(form_appl3.x - form_appl2.x, form_appl3.y - form_appl2.y, form_appl3.z - form_appl2.z);
        var form_mink16_1 = new THREE.Vector3(form_mink15_1.x + form_mink16.x, form_mink15_1.y +form_mink16.y, form_mink15_1.z +form_mink16.z);
        var form_mink16_2 = new THREE.Vector3(form_mink14_2.x + form_mink16.x, form_mink14_2.y +form_mink16.y, form_mink14_2.z +form_mink16.z);
        var form_mink16_3 = new THREE.Vector3(form_mink13_1.x + form_mink16.x, form_mink13_1.y +form_mink16.y, form_mink13_1.z +form_mink16.z);

        //edge 14
        var form_mink17 = new THREE.Vector3(form_appl2.x - form_nsup4.x, form_appl2.y - form_nsup4.y, (form_appl2.z-0.4) - form_nsup4.z);
        var form_mink17_1 = new THREE.Vector3(form_mink_10_3.x - form_mink17.x, form_mink_10_3.y -form_mink17.y, form_mink_10_3.z -form_mink17.z);
        var form_mink17_2 = new THREE.Vector3(form_mink15_1.x - form_mink17.x, form_mink15_1.y -form_mink17.y, form_mink15_1.z -form_mink17.z);
        var form_mink17_3 = new THREE.Vector3(form_mink_10_4.x - form_mink17.x, form_mink_10_4.y -form_mink17.y, form_mink_10_4.z -form_mink17.z);
        var form_mink17_4 = new THREE.Vector3(form_mink14_2.x - form_mink17.x, form_mink14_2.y -form_mink17.y, form_mink14_2.z -form_mink17.z);

        //edge 15
        var form_mink18 = new THREE.Vector3(force_p6.x - force_p8.x, force_p6.y - force_p8.y, force_p6.z - force_p8.z);
        var form_mink18_1 = new THREE.Vector3(form_mink16_1.x - minkscale1.l * form_mink18.x, form_mink16_1.y - minkscale1.l * form_mink18.y, form_mink16_1.z - minkscale1.l * form_mink18.z);

        //edge 16
        var form_mink19 = new THREE.Vector3(force_p7.x - force_p9.x, force_p7.y - force_p9.y, force_p7.z - force_p9.z);
        var form_mink19_1 = new THREE.Vector3(form_mink16_3.x - minkscale1.l * form_mink19.x, form_mink16_3.y - minkscale1.l * form_mink19.y, form_mink16_3.z - minkscale1.l * form_mink19.z);

        //edge 17
        var form_mink20 = new THREE.Vector3(force_p9.x - force_b5.x, force_p9.y - force_b5.y, force_p9.z - force_b5.z);
        var form_mink20_1 = new THREE.Vector3(form_mink19_1.x - minkscale1.l * form_mink20.x, form_mink19_1.y - minkscale1.l * form_mink20.y, form_mink19_1.z - minkscale1.l * form_mink20.z);

        //edge 18
        var form_mink21 = new THREE.Vector3(form_appl3.x - form_nsup2.x, form_appl3.y - form_nsup2.y, (form_appl3.z-0.4) - form_nsup2.z);
        var form_mink21_1 = new THREE.Vector3(form_mink19_1.x - form_mink21.x, form_mink19_1.y -form_mink21.y, form_mink19_1.z -form_mink21.z);
        var form_mink21_2 = new THREE.Vector3(form_mink20_1.x - form_mink21.x, form_mink20_1.y -form_mink21.y, form_mink20_1.z -form_mink21.z);

        //edge 19
        var form_mink22 = new THREE.Vector3(form_appl3.x - form_nsup4.x, form_appl3.y - form_nsup4.y, (form_appl3.z-0.4) - form_nsup4.z);
        var form_mink22_1 = new THREE.Vector3(form_mink18_1.x - form_mink22.x, form_mink18_1.y -form_mink22.y, form_mink18_1.z -form_mink22.z);
        var form_mink22_2 = new THREE.Vector3(form_mink20_1.x - form_mink22.x, form_mink20_1.y -form_mink22.y, form_mink20_1.z -form_mink22.z);

        //edge 20
        var form_mink23 = new THREE.Vector3(form_appl3.x - form_nsup5.x, form_appl3.y - form_nsup5.y, (form_appl3.z-0.4) - form_nsup5.z);
        var form_mink23_1 = new THREE.Vector3(form_mink18_1.x - form_mink23.x, form_mink18_1.y -form_mink23.y, form_mink18_1.z -form_mink23.z);
        var form_mink23_2 = new THREE.Vector3(form_mink20_1.x - form_mink23.x, form_mink20_1.y -form_mink23.y, form_mink20_1.z -form_mink23.z);
        var form_mink23_3 = new THREE.Vector3(form_mink19_1.x - form_mink23.x, form_mink19_1.y -form_mink23.y, form_mink19_1.z -form_mink23.z);

        //apply loads 3
        var form_mink24_1 = new THREE.Vector3(form_mink16_1.x,form_mink16_1.y,form_mink16_1.z+0.4)
        var form_mink24_2 = new THREE.Vector3(form_mink16_3.x,form_mink16_3.y,form_mink16_3.z+0.4)
        var form_mink24_3 = new THREE.Vector3(form_mink19_1.x,form_mink19_1.y,form_mink19_1.z+0.4)
        var form_mink24_4 = new THREE.Vector3(form_mink18_1.x,form_mink18_1.y,form_mink18_1.z+0.4)

        //apply loads 2
        var form_mink25_1 = new THREE.Vector3(form_mink_10_1.x,form_mink_10_1.y,form_mink_10_1.z+0.4)
        var form_mink25_2 = new THREE.Vector3(form_mink_10_3.x,form_mink_10_3.y,form_mink_10_3.z+0.4)
        var form_mink25_3 = new THREE.Vector3(form_mink15_1.x,form_mink15_1.y,form_mink15_1.z+0.4)
        var form_mink25_4 = new THREE.Vector3(form_mink13_1.x,form_mink13_1.y,form_mink13_1.z+0.4)
        var form_mink25_5 = new THREE.Vector3(form_mink_11_2.x,form_mink_11_2.y,form_mink_11_2.z+0.4)

        //apply loads 1
        var form_mink26_1 = new THREE.Vector3(form_mink_12_1.x,form_mink_12_1.y,form_mink_12_1.z+0.4)
        var form_mink26_2 = new THREE.Vector3(form_mink_4_1.x,form_mink_4_1.y,form_mink_4_1.z+0.4)
        var form_mink26_3 = new THREE.Vector3(form_mink_5_1.x,form_mink_5_1.y,form_mink_5_1.z+0.4)
        var form_mink26_4 = new THREE.Vector3(form_mink_22_1.x,form_mink_22_1.y,form_mink_22_1.z+0.4)

        //tension edge 1
        var form_mink27 = new THREE.Vector3(force_b1.x - force_b1a.x, force_b1.y - force_b1a.y, force_b1.z - force_b1a.z);
        var form_mink27_1 = new THREE.Vector3(form_nsup1.x - minkscale1.l * form_mink27.x, form_nsup1.y - minkscale1.l * form_mink27.y, form_nsup1.z - minkscale1.l * form_mink27.z);
        var form_mink27_2 = new THREE.Vector3(form_nsup3.x - minkscale1.l * form_mink27.x, form_nsup3.y - minkscale1.l * form_mink27.y, form_nsup3.z - minkscale1.l * form_mink27.z);
        var form_mink27_3 = new THREE.Vector3(form_nsup2.x - minkscale1.l * form_mink27.x, form_nsup2.y - minkscale1.l * form_mink27.y, form_nsup2.z - minkscale1.l * form_mink27.z);

        //tension edge 2
        var form_mink28 = new THREE.Vector3(force_b3.x - force_b3a.x, force_b3.y - force_b3a.y, force_b3.z - force_b3a.z);
        var form_mink28_1 = new THREE.Vector3(form_mink_9_1.x - minkscale1.l * form_mink28.x, form_mink_9_1.y - minkscale1.l * form_mink28.y, form_mink_9_1.z - minkscale1.l * form_mink28.z);
        var form_mink28_2 = new THREE.Vector3(form_mink_9_2.x - minkscale1.l * form_mink28.x, form_mink_9_2.y - minkscale1.l * form_mink28.y, form_mink_9_2.z - minkscale1.l * form_mink28.z);
        var form_mink28_3 = new THREE.Vector3(form_mink17_3.x - minkscale1.l * form_mink28.x, form_mink17_3.y - minkscale1.l * form_mink28.y, form_mink17_3.z - minkscale1.l * form_mink28.z);

        //tension edge 3
        var form_mink29 = new THREE.Vector3(force_b5.x - force_b5a.x, force_b5.y - force_b5a.y, force_b5.z - force_b5a.z);
        var form_mink29_1 = new THREE.Vector3(form_mink22_2.x - minkscale1.l * form_mink29.x, form_mink22_2.y - minkscale1.l * form_mink29.y, form_mink22_2.z - minkscale1.l * form_mink29.z);
        var form_mink29_2 = new THREE.Vector3(form_mink21_2.x - minkscale1.l * form_mink29.x, form_mink21_2.y - minkscale1.l * form_mink29.y, form_mink21_2.z - minkscale1.l * form_mink29.z);
        var form_mink29_3 = new THREE.Vector3(form_mink23_2.x - minkscale1.l * form_mink29.x, form_mink23_2.y - minkscale1.l * form_mink29.y, form_mink23_2.z - minkscale1.l * form_mink29.z);

        //mink supports 1 (nsup1)
        var form_mink30_1 = new THREE.Vector3(form_mink_1_1.x, form_mink_1_1.y, form_mink_1_1.z-0.4);
        var form_mink30_2 = new THREE.Vector3(form_mink_2_1.x, form_mink_2_1.y, form_mink_2_1.z-0.4);
        var form_mink30_3 = new THREE.Vector3(form_mink27_1.x, form_mink27_1.y, form_mink27_1.z-0.4);

        //mink supports 2 (nsup3)
        var form_mink31_1 = new THREE.Vector3(form_mink_13_1.x, form_mink_13_1.y, form_mink_13_1.z-0.4);
        var form_mink31_2 = new THREE.Vector3(form_mink27_2.x, form_mink27_2.y, form_mink27_2.z-0.4);
        var form_mink31_3 = new THREE.Vector3(form_mink28_1.x, form_mink28_1.y, form_mink28_1.z-0.4);
        var form_mink31_4 = new THREE.Vector3(form_mink_8_1.x, form_mink_8_1.y, form_mink_8_1.z-0.4);
        var form_mink31_5 = new THREE.Vector3(form_mink_42_1.x, form_mink_42_1.y, form_mink_42_1.z-0.4);

        //mink supports 3 (nsup4)
        var form_mink32_1 = new THREE.Vector3(form_mink17_1.x, form_mink17_1.y, form_mink17_1.z-0.4);
        var form_mink32_2 = new THREE.Vector3(form_mink28_3.x, form_mink28_3.y, form_mink28_3.z-0.4);
        var form_mink32_3 = new THREE.Vector3(form_mink29_1.x, form_mink29_1.y, form_mink29_1.z-0.4);
        var form_mink32_4 = new THREE.Vector3(form_mink22_1.x, form_mink22_1.y, form_mink22_1.z-0.4);
        var form_mink32_5 = new THREE.Vector3(form_mink17_2.x, form_mink17_2.y, form_mink17_2.z-0.4);

        //mink supports 4 (nsup5)
        var form_mink33_1 = new THREE.Vector3(form_mink23_1.x, form_mink23_1.y, form_mink23_1.z-0.4);
        var form_mink33_2 = new THREE.Vector3(form_mink23_3.x, form_mink23_3.y, form_mink23_3.z-0.4);
        var form_mink33_3 = new THREE.Vector3(form_mink29_3.x, form_mink29_3.y, form_mink29_3.z-0.4);

        //mink supports 4 (nsup2)
        var form_mink34_1 = new THREE.Vector3(form_mink_23_1.x, form_mink_23_1.y, form_mink_23_1.z-0.4);
        var form_mink34_2 = new THREE.Vector3(form_mink27_3.x, form_mink27_3.y, form_mink27_3.z-0.4);
        var form_mink34_3 = new THREE.Vector3(form_mink28_2.x, form_mink28_2.y, form_mink28_2.z-0.4);
        var form_mink34_4 = new THREE.Vector3(form_mink29_2.x, form_mink29_2.y, form_mink29_2.z-0.4);
        var form_mink34_5 = new THREE.Vector3(form_mink21_1.x, form_mink21_1.y, form_mink21_1.z-0.4);
        var form_mink34_6 = new THREE.Vector3(form_mink12_1.x, form_mink12_1.y, form_mink12_1.z-0.4);
        var form_mink34_7 = new THREE.Vector3(form_mink_52_1.x, form_mink_52_1.y, form_mink_52_1.z-0.4);







        //minkow face

        var form_mf1 = form_3bluefaces(form_nsup1,form_mink_1_1,form_mink_2_1)
        var form_mf2 = form_4bluefaces(form_nsup1,form_mink_1_1,form_mink_12_1,form_appl1b)
        var form_mf3 = form_4bluefaces(form_nsup1,form_mink_2_1,form_mink_22_1,form_appl1b)
        var form_mf4 = form_4bluefaces(form_mink_2_1,form_mink_22_1,form_mink_12_1,form_mink_1_1)
        var form_mf5 = form_3bluefaces(form_appl1b,form_mink_22_1,form_mink_12_1)

        var form_mf6 = form_4bluefaces(form_mink_12_1,form_mink_22_1,form_mink_5_1,form_mink_4_1)
        var form_mf7 = form_4bluefaces(form_mink_12_1,form_appl1b,form_mink_3_1,form_mink_4_1)
        var form_mf8 = form_4bluefaces(form_mink_22_1,form_appl1b,form_mink_3_1,form_mink_5_1)
        var form_mf9 = form_3bluefaces(form_mink_3_1,form_mink_5_1,form_mink_4_1)

        var form_mf10 = form_4bluefaces(form_mink_13_1,form_nsup3,form_mink_33_1,form_mink_42_1)
        var form_mf11 = form_4bluefaces(form_mink_13_1,form_mink_12_1,form_appl1b,form_nsup3)
        var form_mf12 = form_4bluefaces(form_mink_33_1,form_mink_3_1,form_appl1b,form_nsup3)
        var form_mf13 = form_4bluefaces(form_mink_33_1,form_mink_3_1,form_mink_4_1,form_mink_42_1)
        var form_mf14 = form_4bluefaces(form_mink_13_1,form_mink_12_1,form_mink_4_1,form_mink_42_1)

        var form_mf15 = form_4bluefaces(form_mink_52_1,form_mink_32_1,form_nsup2,form_mink_23_1)
        var form_mf16 = form_4bluefaces(form_mink_52_1,form_mink_32_1,form_mink_3_1,form_mink_5_1)
        var form_mf17 = form_4bluefaces(form_mink_52_1,form_mink_5_1,form_mink_22_1,form_mink_23_1)
        var form_mf18 = form_4bluefaces(form_nsup2,form_appl1b,form_mink_22_1,form_mink_23_1)
        var form_mf19 = form_4bluefaces(form_nsup2,form_appl1b,form_mink_3_1,form_mink_32_1)

        var form_mf20 = form_4bluefaces(form_mink_33_1,form_mink_42_1,form_mink_8_1,form_mink_9_1)
        var form_mf21 = form_4bluefaces(form_mink_33_1,form_mink_42_1,form_mink_10_1,form_mink_10_2)
        var form_mf22 = form_4bluefaces(form_mink_42_1,form_mink_10_1,form_mink_10_3,form_mink_8_1)
        var form_mf23 = form_4bluefaces(form_mink_9_1,form_mink_10_4,form_mink_10_3,form_mink_8_1)
        var form_mf24 = form_4bluefaces(form_mink_9_1,form_mink_10_4,form_mink_10_2,form_mink_33_1)

        var form_mf25 = form_4bluefaces(form_mink_5_1,form_mink_11_2,form_mink_10_1,form_mink_4_1)
        var form_mf26 = form_3bluefaces(form_mink_10_1,form_mink_11_2,form_mink_10_2)
        var form_mf27 = form_4bluefaces(form_mink_4_1,form_mink_3_1,form_mink_10_2,form_mink_10_1)
        var form_mf28 = form_4bluefaces(form_mink_5_1,form_mink_3_1,form_mink_10_2,form_mink_11_2)


        var form_mf29 = form_4bluefaces(form_mink_52_1,form_mink_32_1,form_mink_10_2,form_mink_11_2)
        var form_mf30 = form_4bluefaces(form_mink13_1,form_mink12_1,form_mink_52_1,form_mink_11_2)
        var form_mf31 = form_4bluefaces(form_mink13_1,form_mink14_2,form_mink14_1,form_mink12_1)
        var form_mf32 = form_4bluefaces(form_mink_52_1,form_mink_32_1,form_mink_9_2,form_mink12_1)
        var form_mf33 = form_3bluefaces(form_mink12_1,form_mink_9_2,form_mink14_1)
        var form_mf34 = form_4bluefaces(form_mink_11_2,form_mink_10_2,form_mink_10_4,form_mink13_1)
        var form_mf35 = form_3bluefaces(form_mink13_1,form_mink_10_4,form_mink14_2)
        var form_mf36 = form_4bluefaces(form_mink_10_1,form_mink_10_3,form_mink_10_4,form_mink_10_2)
        var form_mf37 = form_4bluefaces(form_mink_10_4,form_mink_9_2,form_mink14_1,form_mink14_2)
        var form_mf38 = form_4bluefaces(form_mink_10_4,form_mink_9_2,form_mink_32_1,form_mink_10_2)

        var form_mf39 = form_4bluefaces(form_mink_11_2,form_mink13_1,form_mink_10_3,form_mink_10_1)
        var form_mf40 = form_3bluefaces(form_mink13_1,form_mink15_1,form_mink_10_3)
        var form_mf41 = form_4bluefaces(form_mink15_1,form_mink14_2,form_mink_10_4,form_mink_10_3)
        var form_mf42 = form_3bluefaces(form_mink13_1,form_mink14_2,form_mink15_1)

        var form_mf43 = form_4bluefaces(form_mink_10_3,form_mink_10_4,form_mink17_3,form_mink17_1)
        var form_mf44 = form_4bluefaces(form_mink_10_3,form_mink15_1,form_mink17_2,form_mink17_1)
        var form_mf45 = form_4bluefaces(form_mink17_1,form_mink17_2,form_mink17_4,form_mink17_3)
        var form_mf46 = form_4bluefaces(form_mink15_1,form_mink14_2,form_mink17_4,form_mink17_2)
        var form_mf47 = form_4bluefaces(form_mink_10_4,form_mink14_2,form_mink17_4,form_mink17_3)

        var form_mf48 = form_4bluefaces(form_mink15_1,form_mink13_1,form_mink16_3,form_mink16_1)
        var form_mf49 = form_4bluefaces(form_mink15_1,form_mink14_2,form_mink16_2,form_mink16_1)
        var form_mf50 = form_4bluefaces(form_mink13_1,form_mink16_3,form_mink16_2,form_mink14_2)
        var form_mf51 = form_3bluefaces(form_mink16_1,form_mink16_3,form_mink16_2)

        var form_mf52 = form_4bluefaces(form_mink16_3,form_mink19_1,form_mink18_1,form_mink16_1)
        var form_mf53 = form_4bluefaces(form_mink16_3,form_mink19_1,form_mink20_1,form_mink16_2)
        var form_mf54 = form_4bluefaces(form_mink16_1,form_mink16_2,form_mink20_1,form_mink18_1)
        var form_mf55 = form_3bluefaces(form_mink16_1,form_mink16_3,form_mink16_2)

        var form_mf56 = form_4bluefaces(form_mink16_1,form_mink18_1,form_mink22_1,form_mink17_2)
        var form_mf57 = form_4bluefaces(form_mink16_1,form_mink16_2,form_mink17_4,form_mink17_2)
        var form_mf58 = form_4bluefaces(form_mink16_2,form_mink20_1,form_mink22_2,form_mink17_4)
        var form_mf59 = form_4bluefaces(form_mink22_2,form_mink20_1,form_mink18_1,form_mink22_1)
        var form_mf60 = form_4bluefaces(form_mink17_2,form_mink22_1,form_mink22_2,form_mink17_4)

        var form_mf61 = form_4bluefaces(form_mink16_3,form_mink12_1,form_mink21_1,form_mink19_1)
        var form_mf62 = form_4bluefaces(form_mink16_3,form_mink16_2,form_mink14_1,form_mink12_1)
        var form_mf63 = form_4bluefaces(form_mink14_1,form_mink21_2,form_mink20_1,form_mink16_2)
        var form_mf64 = form_4bluefaces(form_mink21_1,form_mink19_1,form_mink20_1,form_mink21_2)
        var form_mf65 = form_4bluefaces(form_mink12_1,form_mink14_1,form_mink21_2,form_mink21_1)

        var form_mf66 = form_4bluefaces(form_mink19_1,form_mink23_3,form_mink23_1,form_mink18_1)
        var form_mf67 = form_3bluefaces(form_mink20_1,form_mink19_1,form_mink18_1)
        var form_mf68 = form_4bluefaces(form_mink20_1,form_mink18_1,form_mink23_1,form_mink23_2)
        var form_mf69 = form_4bluefaces(form_mink19_1,form_mink23_3,form_mink23_2,form_mink20_1)
        var form_mf70 = form_3bluefaces(form_mink23_1,form_mink23_3,form_mink23_2)

        var form_mf71 = form_4greenfaces(form_mink24_1,form_mink24_2,form_mink24_3,form_mink24_4)
        var form_mf72 = form_4greenfaces(form_mink16_1,form_mink24_1,form_mink24_4,form_mink18_1)
        var form_mf73 = form_4greenfaces(form_mink18_1,form_mink24_4,form_mink24_3,form_mink19_1)
        var form_mf74 = form_4greenfaces(form_mink19_1,form_mink24_3,form_mink24_2,form_mink16_3)
        var form_mf75 = form_4greenfaces(form_mink24_2,form_mink24_1,form_mink16_1,form_mink16_3)

        //load 1
        var form_arrowp1 = new THREE.Vector3((form_mink24_1.x+form_mink24_2.x+form_mink24_3.x+form_mink24_4.x)/4,(form_mink24_1.y+form_mink24_2.y+form_mink24_3.y+form_mink24_4.y)/4,(form_mink24_1.z+form_mink24_2.z+form_mink24_3.z+form_mink24_4.z)/4)

        var form_arrow1 = createCylinderArrowMesh(new THREE.Vector3(form_arrowp1.x, form_arrowp1.y, form_arrowp1.z + 0.4), form_arrowp1, arrow_apply, 0.02, 0.05, 0.6);
        var form_arrow1_out = createCylinderArrowMesh(new THREE.Vector3(form_arrowp1.x, form_arrowp1.y, form_arrowp1.z + 0.4), form_arrowp1,arrow_apply_out, 0.03, 0.06, 0.6);
        form_group_mink.add(form_arrow1);
        form_group_mink.add(form_arrow1_out);

        var form_mf76 = form_4greenfaces(form_mink25_1,form_mink25_5,form_mink25_4,form_mink25_2)
        var form_mf77 = form_3greenfaces(form_mink25_2,form_mink25_4,form_mink25_3)
        var form_mf78 = form_4greenfaces(form_mink_10_3,form_mink25_2,form_mink25_3,form_mink15_1)
        var form_mf79 = form_4greenfaces(form_mink15_1,form_mink25_3,form_mink25_4,form_mink13_1)
        var form_mf80 = form_4greenfaces(form_mink13_1,form_mink25_4,form_mink25_5,form_mink_11_2)
        var form_mf81 = form_4greenfaces(form_mink_11_2,form_mink25_5,form_mink25_1,form_mink_10_1)
        var form_mf82 = form_4greenfaces(form_mink_10_1,form_mink25_1,form_mink25_2,form_mink_10_3)

        //load 1
        var form_arrowp2 = new THREE.Vector3((form_mink25_1.x+form_mink25_2.x+form_mink25_3.x+form_mink25_4.x+form_mink25_5.x)/5,(form_mink25_1.y+form_mink25_2.y+form_mink25_3.y+form_mink25_4.y+form_mink25_5.y)/5,(form_mink25_1.z+form_mink25_2.z+form_mink25_3.z+form_mink25_4.z+form_mink25_5.z)/5)

        var form_arrow2 = createCylinderArrowMesh(new THREE.Vector3(form_arrowp2.x, form_arrowp2.y, form_arrowp2.z + 0.4), form_arrowp2, arrow_apply, 0.02, 0.05, 0.6);
        var form_arrow2_out = createCylinderArrowMesh(new THREE.Vector3(form_arrowp2.x, form_arrowp2.y, form_arrowp2.z + 0.4), form_arrowp2,arrow_apply_out, 0.03, 0.06, 0.6);
        form_group_mink.add(form_arrow2);
        form_group_mink.add(form_arrow2_out);

        var form_mf83 = form_4greenfaces(form_mink26_1,form_mink26_4,form_mink26_3,form_mink26_2)
        var form_mf84 = form_4greenfaces(form_mink_12_1,form_mink26_1,form_mink26_2,form_mink_4_1)
        var form_mf85 = form_4greenfaces(form_mink_4_1,form_mink26_2,form_mink26_3,form_mink_5_1)
        var form_mf86 = form_4greenfaces(form_mink_5_1,form_mink26_3,form_mink26_4,form_mink_22_1)
        var form_mf87 = form_4greenfaces(form_mink_22_1,form_mink26_4,form_mink26_1,form_mink_12_1)

        //load 1
        var form_arrowp3 = new THREE.Vector3((form_mink26_1.x+form_mink26_2.x+form_mink26_3.x+form_mink26_4.x)/4,(form_mink26_1.y+form_mink26_2.y+form_mink26_3.y+form_mink26_4.y)/4,(form_mink26_1.z+form_mink26_2.z+form_mink26_3.z+form_mink26_4.z)/4)

        var form_arrow3 = createCylinderArrowMesh(new THREE.Vector3(form_arrowp3.x, form_arrowp3.y, form_arrowp3.z + 0.4), form_arrowp3, arrow_apply, 0.02, 0.05, 0.6);
        var form_arrow3_out = createCylinderArrowMesh(new THREE.Vector3(form_arrowp3.x, form_arrowp3.y, form_arrowp3.z + 0.4), form_arrowp3,arrow_apply_out, 0.03, 0.06, 0.6);
        form_group_mink.add(form_arrow3);
        form_group_mink.add(form_arrow3_out);

        //tension
        var form_mtf1 = form_4redfaces(form_mink27_1,form_nsup1,form_nsup3,form_mink27_2)
        var form_mtf2 = form_4redfaces(form_mink27_1,form_mink27_2,form_mink_13_1,form_mink_1_1)
        var form_mtf3 = form_4redfaces(form_mink_1_1,form_mink_13_1,form_nsup3,form_nsup1)

        var form_mtf4 = form_4redfaces(form_mink27_1,form_mink27_3,form_mink_23_1,form_mink_2_1)
        var form_mtf5 = form_4redfaces(form_mink27_1,form_mink27_3,form_nsup2,form_nsup1)
        var form_mtf6 = form_4redfaces(form_mink_2_1,form_mink_23_1,form_nsup2,form_nsup1)

        var form_mtf7 = form_4redfaces(form_mink27_2,form_mink27_3,form_nsup2,form_nsup3)
        var form_mtf8 = form_4redfaces(form_nsup3,form_nsup2,form_mink_32_1,form_mink_33_1)
        var form_mtf9 = form_4redfaces(form_mink_9_1,form_mink_9_2,form_mink_32_1,form_mink_33_1)
        var form_mtf10 = form_4redfaces(form_mink_9_1,form_mink_9_2,form_mink28_2,form_mink28_1)
        var form_mtf11 = form_4redfaces(form_mink27_2,form_mink27_3,form_mink28_2,form_mink28_1)

        var form_mtf12 = form_4redfaces(form_mink28_1,form_mink28_3,form_mink17_1,form_mink_8_1)
        var form_mtf13 = form_4redfaces(form_mink28_1,form_mink28_3,form_mink17_3,form_mink_9_1)
        var form_mtf14 = form_4redfaces(form_mink_8_1,form_mink17_1,form_mink17_3,form_mink_9_1)

        var form_mtf15 = form_4redfaces(form_mink28_2,form_mink29_2,form_mink29_1,form_mink28_3)
        var form_mtf16 = form_4redfaces(form_mink28_2,form_mink28_3,form_mink17_3,form_mink_9_2)
        var form_mtf17 = form_4redfaces(form_mink14_1,form_mink17_4,form_mink17_3,form_mink_9_2)
        var form_mtf18 = form_4redfaces(form_mink14_1,form_mink21_2,form_mink22_2,form_mink17_4)
        var form_mtf19 = form_4redfaces(form_mink29_2,form_mink21_2,form_mink22_2,form_mink29_1)

        var form_mtf20 = form_4redfaces(form_mink29_1,form_mink29_3,form_mink23_1,form_mink22_1)
        var form_mtf21 = form_4redfaces(form_mink29_1,form_mink29_3,form_mink23_2,form_mink22_2)
        var form_mtf22 = form_4redfaces(form_mink22_1,form_mink23_1,form_mink23_2,form_mink22_2)

        var form_mtf23 = form_4redfaces(form_mink29_2,form_mink29_3,form_mink23_2,form_mink21_2)
        var form_mtf24 = form_4redfaces(form_mink29_2,form_mink21_1,form_mink23_3,form_mink29_3)
        var form_mtf25 = form_4redfaces(form_mink21_1,form_mink23_3,form_mink23_2,form_mink21_2)

        //supports
        var form_msf1 = form_4greenfaces(form_mink_1_1,form_mink27_1,form_mink30_3,form_mink30_1)
        var form_msf2 = form_4greenfaces(form_mink_2_1,form_mink27_1,form_mink30_3,form_mink30_2)
        var form_msf3 = form_4greenfaces(form_mink_2_1,form_mink_1_1,form_mink30_1,form_mink30_2)
        var form_msf4 = form_3greenfaces(form_mink30_2,form_mink30_1,form_mink30_3)

        //supports 2
        var form_msf5 = form_4greenfaces(form_mink_42_1,form_mink27_2,form_mink28_1,form_mink_8_1)
        var form_msf6 = form_3greenfaces(form_mink_13_1,form_mink27_2,form_mink_42_1)
        var form_msf7 = form_4greenfaces(form_mink_13_1,form_mink27_2,form_mink31_2,form_mink31_1)
        var form_msf8 = form_4greenfaces(form_mink27_2,form_mink28_1,form_mink31_3,form_mink31_2)
        var form_msf9 = form_4greenfaces(form_mink_8_1,form_mink28_1,form_mink31_3,form_mink31_4)
        var form_msf10 = form_4greenfaces(form_mink_8_1,form_mink31_4,form_mink31_5,form_mink_42_1)
        var form_msf11 = form_4greenfaces(form_mink_13_1,form_mink_42_1,form_mink31_5,form_mink31_1)
        var form_msf12 = form_4greenfaces(form_mink31_5,form_mink31_2,form_mink31_3,form_mink31_4)
        var form_msf13 = form_3greenfaces(form_mink31_1,form_mink31_2,form_mink31_5)

        //supports 3
        var form_msf14 = form_4greenfaces(form_mink17_1,form_mink28_3,form_mink29_1,form_mink17_2)
        var form_msf15 = form_3greenfaces(form_mink22_1,form_mink17_2,form_mink29_1)
        var form_msf16 = form_4greenfaces(form_mink17_1,form_mink28_3,form_mink32_2,form_mink32_1)
        var form_msf17 = form_4greenfaces(form_mink28_3,form_mink29_1,form_mink32_3,form_mink32_2)
        var form_msf18 = form_4greenfaces(form_mink29_1,form_mink22_1,form_mink32_4,form_mink32_3)
        var form_msf19 = form_4greenfaces(form_mink22_1,form_mink32_4,form_mink32_5,form_mink17_2)
        var form_msf20 = form_4greenfaces(form_mink17_1,form_mink17_2,form_mink32_5,form_mink32_1)
        var form_msf21 = form_4greenfaces(form_mink32_1,form_mink32_2,form_mink32_3,form_mink32_5)
        var form_msf22 = form_3greenfaces(form_mink32_4,form_mink32_5,form_mink32_3)

        //supports 4
        var form_msf23 = form_4greenfaces(form_mink23_1,form_mink29_3,form_mink33_3,form_mink33_1)
        var form_msf24 = form_4greenfaces(form_mink29_3,form_mink23_3,form_mink33_2,form_mink33_3)
        var form_msf25 = form_4greenfaces(form_mink23_1,form_mink23_3,form_mink33_2,form_mink33_1)
        var form_msf26 = form_3greenfaces(form_mink33_2,form_mink33_1,form_mink33_3)

        //supports 5
        var form_msf27 = form_3greenfaces(form_mink_23_1,form_mink_52_1,form_mink27_3)
        var form_msf28 = form_3greenfaces(form_mink27_3,form_mink_52_1,form_mink28_2)
        var form_msf29 = form_3greenfaces(form_mink28_2,form_mink_52_1,form_mink12_1)
        var form_msf30 = form_3greenfaces(form_mink28_2,form_mink12_1,form_mink29_2)
        var form_msf31 = form_3greenfaces(form_mink29_2,form_mink12_1,form_mink21_1)

        var form_msf32 = form_4greenfaces(form_mink27_3,form_mink_23_1,form_mink34_1,form_mink34_2)
        var form_msf33 = form_4greenfaces(form_mink27_3,form_mink28_2,form_mink34_3,form_mink34_2)
        var form_msf34 = form_4greenfaces(form_mink28_2,form_mink29_2,form_mink34_4,form_mink34_3)
        var form_msf35 = form_4greenfaces(form_mink29_2,form_mink21_1,form_mink34_5,form_mink34_4)
        var form_msf36 = form_4greenfaces(form_mink12_1,form_mink34_6,form_mink34_5,form_mink21_1)
        var form_msf37 = form_4greenfaces(form_mink12_1,form_mink_52_1,form_mink34_7,form_mink34_6)
        var form_msf38 = form_4greenfaces(form_mink_52_1,form_mink_23_1,form_mink34_1,form_mink34_7)

        var form_msf39 = form_3greenfaces(form_mink34_1,form_mink34_7,form_mink34_2)
        var form_msf40 = form_3greenfaces(form_mink34_2,form_mink34_7,form_mink34_3)
        var form_msf41 = form_3greenfaces(form_mink34_3,form_mink34_7,form_mink34_6)
        var form_msf42 = form_3greenfaces(form_mink34_3,form_mink34_6,form_mink34_4)
        var form_msf43 = form_3greenfaces(form_mink34_4,form_mink34_6,form_mink34_5)


















        //support load 1
        var form_arrowsp1 = new THREE.Vector3((form_mink30_1.x+form_mink30_2.x+form_mink30_3.x)/3,(form_mink30_1.y+form_mink30_2.y+form_mink30_3.y)/3,(form_mink30_1.z+form_mink30_2.z+form_mink30_3.z)/3)

        var form_arrows1 = createCylinderArrowMesh(new THREE.Vector3(form_arrowsp1.x, form_arrowsp1.y, form_arrowsp1.z - 0.4), form_arrowsp1, arrow_apply, 0.02, 0.05, 0.6);
        var form_arrows1_out = createCylinderArrowMesh(new THREE.Vector3(form_arrowsp1.x, form_arrowsp1.y, form_arrowsp1.z - 0.4), form_arrowsp1,arrow_apply_out, 0.03, 0.06, 0.6);
        form_group_mink.add(form_arrows1);
        form_group_mink.add(form_arrows1_out);

        //support load 2
        var form_arrowsp2 = new THREE.Vector3((form_mink31_2.x+form_mink31_3.x+form_mink31_5.x)/3,(form_mink31_2.y+form_mink31_3.y+form_mink31_5.y)/3,(form_mink31_2.z+form_mink31_3.z+form_mink31_5.z)/3)

        var form_arrows2 = createCylinderArrowMesh(new THREE.Vector3(form_arrowsp2.x, form_arrowsp2.y, form_arrowsp2.z - 0.4), form_arrowsp2, arrow_apply, 0.02, 0.05, 0.6);
        var form_arrows2_out = createCylinderArrowMesh(new THREE.Vector3(form_arrowsp2.x, form_arrowsp2.y, form_arrowsp2.z - 0.4), form_arrowsp2,arrow_apply_out, 0.03, 0.06, 0.6);
        form_group_mink.add(form_arrows2);
        form_group_mink.add(form_arrows2_out);

        //support load 3
        var form_arrowsp3 = new THREE.Vector3((form_mink32_2.x+form_mink32_3.x+form_mink32_5.x)/3,(form_mink32_2.y+form_mink32_3.y+form_mink32_5.y)/3,(form_mink32_2.z+form_mink32_3.z+form_mink32_5.z)/3)

        var form_arrows3 = createCylinderArrowMesh(new THREE.Vector3(form_arrowsp3.x, form_arrowsp3.y, form_arrowsp3.z - 0.4), form_arrowsp3, arrow_apply, 0.02, 0.05, 0.6);
        var form_arrows3_out = createCylinderArrowMesh(new THREE.Vector3(form_arrowsp3.x, form_arrowsp3.y, form_arrowsp3.z - 0.4), form_arrowsp3,arrow_apply_out, 0.03, 0.06, 0.6);
        form_group_mink.add(form_arrows3);
        form_group_mink.add(form_arrows3_out);

        //support load 4
        var form_arrowsp4 = new THREE.Vector3((form_mink33_1.x+form_mink33_2.x+form_mink33_3.x)/3,(form_mink33_1.y+form_mink33_2.y+form_mink33_3.y)/3,(form_mink33_1.z+form_mink33_2.z+form_mink33_3.z)/3)

        var form_arrows4 = createCylinderArrowMesh(new THREE.Vector3(form_arrowsp4.x, form_arrowsp4.y, form_arrowsp4.z - 0.4), form_arrowsp4, arrow_apply, 0.02, 0.05, 0.6);
        var form_arrows4_out = createCylinderArrowMesh(new THREE.Vector3(form_arrowsp4.x, form_arrowsp4.y, form_arrowsp4.z - 0.4), form_arrowsp4,arrow_apply_out, 0.03, 0.06, 0.6);
        form_group_mink.add(form_arrows4);
        form_group_mink.add(form_arrows4_out);

        //support load 5
        var form_arrowsp5 = new THREE.Vector3((form_mink34_2.x+form_mink34_3.x+form_mink34_4.x+form_mink34_6.x+form_mink34_7.x)/5,(form_mink34_2.y+form_mink34_3.y+form_mink34_4.y+form_mink34_6.y+form_mink34_7.y)/5,(form_mink34_2.z+form_mink34_3.z+form_mink34_4.z+form_mink34_6.z+form_mink34_7.z)/5)

        var form_arrows5 = createCylinderArrowMesh(new THREE.Vector3(form_arrowsp5.x, form_arrowsp5.y, form_arrowsp5.z - 0.4), form_arrowsp5, arrow_apply, 0.02, 0.05, 0.6);
        var form_arrows5_out = createCylinderArrowMesh(new THREE.Vector3(form_arrowsp5.x, form_arrowsp5.y, form_arrowsp5.z - 0.4), form_arrowsp5,arrow_apply_out, 0.03, 0.06, 0.6);
        form_group_mink.add(form_arrows5);
        form_group_mink.add(form_arrows5_out);





        // minkowski box
        var edge_1_min_x1 = Math.min(form_mink_1_1.x, form_mink_2_1.x)
        var edge_1_min_x2 = Math.max(form_mink22_1.x, form_mink23_1.x)

        var edge_1_min_y1 = Math.max(form_mink21_1.y, form_mink23_3.y)
        var edge_1_min_y2 = Math.min(form_mink_8_1.y, form_mink17_1.y,form_mink22_1.y,form_mink23_1.y,form_mink_13_1.y)

        var mink_apply_z_max = Math.max(form_mink26_1.z,form_mink26_2.z,form_mink26_3.z,form_mink26_4.z,
        form_mink25_1.z,form_mink25_2.z,form_mink25_3.z,form_mink25_4.z,form_mink25_5.z,
        form_mink24_1.z,form_mink24_2.z,form_mink24_3.z,form_mink24_4.z,)

        var mink_box_p1 = new THREE.Vector3(edge_1_min_x1-0.2, edge_1_min_y1+0.2, form_nsup1.z-0.4)
        var mink_box_p2 = new THREE.Vector3(edge_1_min_x1-0.2, edge_1_min_y2-0.2, form_nsup1.z-0.4)

        var mink_box_p3 = new THREE.Vector3(edge_1_min_x2+0.2, edge_1_min_y2-0.2, form_nsup1.z-0.4)
        var mink_box_p4 = new THREE.Vector3(edge_1_min_x2+0.2, edge_1_min_y1+0.2, form_nsup1.z-0.4)

        var mink_box_p5 = new THREE.Vector3(mink_box_p1.x, mink_box_p1.y, mink_apply_z_max)
        var mink_box_p6 = new THREE.Vector3(mink_box_p2.x, mink_box_p2.y, mink_apply_z_max)
        var mink_box_p7 = new THREE.Vector3(mink_box_p3.x, mink_box_p3.y, mink_apply_z_max)
        var mink_box_p8 = new THREE.Vector3(mink_box_p4.x, mink_box_p4.y, mink_apply_z_max)


        var mink_box_edge = [];

        // bottom rect
        mink_box_edge.push(mink_box_p1);
        mink_box_edge.push(mink_box_p2);

        mink_box_edge.push(mink_box_p2);
        mink_box_edge.push(mink_box_p3);

        mink_box_edge.push(mink_box_p3);
        mink_box_edge.push(mink_box_p4);

        mink_box_edge.push(mink_box_p4);
        mink_box_edge.push(mink_box_p1);

        // up rect
        mink_box_edge.push(mink_box_p5);
        mink_box_edge.push(mink_box_p6);

        mink_box_edge.push(mink_box_p6);
        mink_box_edge.push(mink_box_p7);

        mink_box_edge.push(mink_box_p7);
        mink_box_edge.push(mink_box_p8);

        mink_box_edge.push(mink_box_p8);
        mink_box_edge.push(mink_box_p5);

        // side rect

        mink_box_edge.push(mink_box_p1);
        mink_box_edge.push(mink_box_p5);

        mink_box_edge.push(mink_box_p2);
        mink_box_edge.push(mink_box_p6);

        mink_box_edge.push(mink_box_p3);
        mink_box_edge.push(mink_box_p7);

        mink_box_edge.push(mink_box_p4);
        mink_box_edge.push(mink_box_p8);


        var mink_box_geo1 = new THREE.Geometry().setFromPoints(mink_box_edge);
        var mink_box_m = new THREE.LineDashedMaterial({
          color: "grey",//color
          dashSize: 0.05,
          gapSize: 0.03,
          linewidth: 1

        });
        var mink_box1 = new THREE.LineSegments(mink_box_geo1, mink_box_m);

        form_group_mink.add(mink_box1);









        var form_mink = [];

        //part 1
        form_mink.push(form_nsup1);
        form_mink.push(form_mink_1_1);

        form_mink.push(form_nsup1);
        form_mink.push(form_mink_2_1);

        form_mink.push(form_mink_1_1);
        form_mink.push(form_mink_2_1);

        form_mink.push(form_appl1b);
        form_mink.push(form_mink_12_1);

        form_mink.push(form_appl1b);
        form_mink.push(form_mink_22_1);

        form_mink.push(form_mink_12_1);
        form_mink.push(form_mink_22_1);

        form_mink.push(form_mink_1_1);
        form_mink.push(form_mink_12_1);

        form_mink.push(form_mink_2_1);
        form_mink.push(form_mink_22_1);

        form_mink.push(form_nsup1);
        form_mink.push(form_appl1b);

        form_mink.push(form_mink_1_1);
        form_mink.push(form_mink30_1);

        form_mink.push(form_mink_2_1);
        form_mink.push(form_mink30_2);

        form_mink.push(form_nsup1);
        form_mink.push(form_mink30_3);

        form_mink.push(form_mink_1_1);
        form_mink.push(form_mink27_1);

        form_mink.push(form_mink_2_1);
        form_mink.push(form_mink27_1);

        //part 2-1

        form_mink.push(form_appl1b);
        form_mink.push(form_mink_3_1);

        form_mink.push(form_mink_4_1);
        form_mink.push(form_mink_3_1);

        form_mink.push(form_mink_5_1);
        form_mink.push(form_mink_3_1);

        form_mink.push(form_mink_4_1);
        form_mink.push(form_mink_12_1);

        form_mink.push(form_mink_5_1);
        form_mink.push(form_mink_22_1);

        form_mink.push(form_mink_4_1);
        form_mink.push(form_mink_5_1);

        //part 2-2

        form_mink.push(form_mink26_1);
        form_mink.push(form_mink_12_1);

        form_mink.push(form_mink26_4);
        form_mink.push(form_mink_22_1);

        form_mink.push(form_mink26_3);
        form_mink.push(form_mink_5_1);

        form_mink.push(form_mink26_2);
        form_mink.push(form_mink_4_1);

        //part 3-1

        form_mink.push(form_mink_33_1);
        form_mink.push(form_mink_42_1);

        form_mink.push(form_mink_42_1);
        form_mink.push(form_mink_13_1);

        form_mink.push(form_mink_13_1);
        form_mink.push(form_nsup3);

        form_mink.push(form_nsup3);
        form_mink.push(form_mink_33_1);

        //part 3-2

        form_mink.push(form_mink_33_1);
        form_mink.push(form_mink_3_1);

        form_mink.push(form_mink_42_1);
        form_mink.push(form_mink_4_1);

        form_mink.push(form_mink_13_1);
        form_mink.push(form_mink_12_1);

        form_mink.push(form_nsup3);
        form_mink.push(form_appl1b);

        //part 3-3

        form_mink.push(form_mink_42_1);
        form_mink.push(form_mink_8_1);

        form_mink.push(form_mink_8_1);
        form_mink.push(form_mink_9_1);

        form_mink.push(form_mink_9_1);
        form_mink.push(form_mink_33_1);

        //part 3-4

        form_mink.push(form_mink_42_1);
        form_mink.push(form_mink_10_1);

        form_mink.push(form_mink_33_1);
        form_mink.push(form_mink_10_2);

        form_mink.push(form_mink_9_1);
        form_mink.push(form_mink_10_4);

        form_mink.push(form_mink_8_1);
        form_mink.push(form_mink_10_3);

        //part 3-5

        form_mink.push(form_mink_13_1);
        form_mink.push(form_mink27_2);

        form_mink.push(form_mink27_2);
        form_mink.push(form_mink28_1);

        form_mink.push(form_mink28_1);
        form_mink.push(form_mink_8_1);

        //part 3-6

        form_mink.push(form_mink_13_1);
        form_mink.push(form_mink31_1);

        form_mink.push(form_nsup3);
        form_mink.push(form_mink31_2);

        form_mink.push(form_mink_9_1);
        form_mink.push(form_mink31_3);

        form_mink.push(form_mink_8_1);
        form_mink.push(form_mink31_4);

        form_mink.push(form_mink_42_1);
        form_mink.push(form_mink31_5);

        //part 4-1

        form_mink.push(form_mink_4_1);
        form_mink.push(form_mink_10_1);

        form_mink.push(form_mink_5_1);
        form_mink.push(form_mink_11_2);

        form_mink.push(form_mink_3_1);
        form_mink.push(form_mink_10_2);

        //part 4-2

        form_mink.push(form_mink_10_3);
        form_mink.push(form_mink15_1);

        form_mink.push(form_mink15_1);
        form_mink.push(form_mink13_1);

        form_mink.push(form_mink13_1);
        form_mink.push(form_mink_11_2);

        form_mink.push(form_mink_11_2);
        form_mink.push(form_mink_10_1);

        form_mink.push(form_mink_10_1);
        form_mink.push(form_mink_10_3);

        //part 4-3

        form_mink.push(form_mink_10_1);
        form_mink.push(form_mink_10_2);

        form_mink.push(form_mink_11_2);
        form_mink.push(form_mink_10_2);

        form_mink.push(form_mink_10_3);
        form_mink.push(form_mink_10_4);

        form_mink.push(form_mink15_1);
        form_mink.push(form_mink14_2);

        form_mink.push(form_mink13_1);
        form_mink.push(form_mink14_2);

        form_mink.push(form_mink_10_4);
        form_mink.push(form_mink14_2);

        form_mink.push(form_mink_10_4);
        form_mink.push(form_mink_10_2);

        //part 4-4

        form_mink.push(form_mink_10_1);
        form_mink.push(form_mink25_1);

        form_mink.push(form_mink_10_3);
        form_mink.push(form_mink25_2);

        form_mink.push(form_mink15_1);
        form_mink.push(form_mink25_3);

        form_mink.push(form_mink13_1);
        form_mink.push(form_mink25_4);

        form_mink.push(form_mink_11_2);
        form_mink.push(form_mink25_5);

        //part 5-1

        form_mink.push(form_mink_10_3);
        form_mink.push(form_mink17_1);

        form_mink.push(form_mink17_2);
        form_mink.push(form_mink15_1);

        form_mink.push(form_mink_10_4);
        form_mink.push(form_mink17_3);

        form_mink.push(form_mink14_2);
        form_mink.push(form_mink17_4);

        //part 5-2

        form_mink.push(form_mink17_1);
        form_mink.push(form_mink17_2);

        form_mink.push(form_mink17_2);
        form_mink.push(form_mink17_4);

        form_mink.push(form_mink17_3);
        form_mink.push(form_mink17_4);

        form_mink.push(form_mink17_1);
        form_mink.push(form_mink17_3);

        //part 6-1

        form_mink.push(form_mink18_1);
        form_mink.push(form_mink22_1);

        form_mink.push(form_mink20_1);
        form_mink.push(form_mink22_2);

        form_mink.push(form_mink16_1);
        form_mink.push(form_mink17_2);

        form_mink.push(form_mink16_2);
        form_mink.push(form_mink17_4);

        form_mink.push(form_mink17_2);
        form_mink.push(form_mink22_1);

        form_mink.push(form_mink22_2);
        form_mink.push(form_mink22_1);

        form_mink.push(form_mink17_4);
        form_mink.push(form_mink22_2);

        //part 6-2 (support)

        form_mink.push(form_mink17_1);
        form_mink.push(form_mink32_1);

        form_mink.push(form_mink17_3);
        form_mink.push(form_mink32_2);

        form_mink.push(form_mink22_2);
        form_mink.push(form_mink32_3);

        form_mink.push(form_mink22_1);
        form_mink.push(form_mink32_4);

        form_mink.push(form_mink17_2);
        form_mink.push(form_mink32_5);


        form_mink.push(form_mink17_1);
        form_mink.push(form_mink28_3);

        form_mink.push(form_mink29_1);
        form_mink.push(form_mink28_3);

        form_mink.push(form_mink29_1);
        form_mink.push(form_mink22_1);

        //part 7

        form_mink.push(form_mink16_1);
        form_mink.push(form_mink18_1);

        form_mink.push(form_mink18_1);
        form_mink.push(form_mink19_1);

        form_mink.push(form_mink16_3);
        form_mink.push(form_mink19_1);

        form_mink.push(form_mink16_1);
        form_mink.push(form_mink16_3);

        form_mink.push(form_mink16_1);
        form_mink.push(form_mink16_2);

        form_mink.push(form_mink16_2);
        form_mink.push(form_mink16_3);

        form_mink.push(form_mink20_1);
        form_mink.push(form_mink19_1);

        form_mink.push(form_mink20_1);
        form_mink.push(form_mink18_1);

        form_mink.push(form_mink20_1);
        form_mink.push(form_mink16_2);

        form_mink.push(form_mink24_1);
        form_mink.push(form_mink16_1);

        form_mink.push(form_mink24_4);
        form_mink.push(form_mink18_1);

        form_mink.push(form_mink24_3);
        form_mink.push(form_mink19_1);

        form_mink.push(form_mink24_2);
        form_mink.push(form_mink16_3);

        //part 9

        form_mink.push(form_mink18_1);
        form_mink.push(form_mink23_1);

        form_mink.push(form_mink20_1);
        form_mink.push(form_mink23_2);

        form_mink.push(form_mink19_1);
        form_mink.push(form_mink23_3);

        form_mink.push(form_mink23_1);
        form_mink.push(form_mink23_3);

        form_mink.push(form_mink23_1);
        form_mink.push(form_mink23_2);

        form_mink.push(form_mink23_2);
        form_mink.push(form_mink23_3);

        form_mink.push(form_mink23_1);
        form_mink.push(form_mink33_1);

        form_mink.push(form_mink23_3);
        form_mink.push(form_mink33_2);

        form_mink.push(form_mink23_2);
        form_mink.push(form_mink33_3);

        form_mink.push(form_mink23_1);
        form_mink.push(form_mink29_3);

        form_mink.push(form_mink23_3);
        form_mink.push(form_mink29_3);

        //part 10-1

        form_mink.push(form_mink20_1);
        form_mink.push(form_mink21_2);

        form_mink.push(form_mink19_1);
        form_mink.push(form_mink21_1);

        form_mink.push(form_mink16_3);
        form_mink.push(form_mink12_1);

        form_mink.push(form_mink16_2);
        form_mink.push(form_mink14_1);

        //part 10-2

        form_mink.push(form_mink21_1);
        form_mink.push(form_mink12_1);

        form_mink.push(form_mink14_1);
        form_mink.push(form_mink12_1);

        form_mink.push(form_mink14_1);
        form_mink.push(form_mink21_2);

        form_mink.push(form_mink21_1);
        form_mink.push(form_mink21_2);

        //part 11-1

        form_mink.push(form_mink_52_1);
        form_mink.push(form_mink_32_1);

        form_mink.push(form_mink_52_1);
        form_mink.push(form_mink12_1);

        form_mink.push(form_mink_32_1);
        form_mink.push(form_mink_9_2)

        form_mink.push(form_mink14_1);
        form_mink.push(form_mink_9_2);

        //part 11-2

        form_mink.push(form_mink13_1);
        form_mink.push(form_mink12_1);

        form_mink.push(form_mink14_1);
        form_mink.push(form_mink14_2);

        form_mink.push(form_mink_11_2);
        form_mink.push(form_mink_52_1);

        form_mink.push(form_mink_10_2);
        form_mink.push(form_mink_32_1);

        form_mink.push(form_mink_10_4);
        form_mink.push(form_mink_9_2);

        //part 12

        form_mink.push(form_mink16_1);
        form_mink.push(form_mink15_1);

        form_mink.push(form_mink16_2);
        form_mink.push(form_mink14_2);

        form_mink.push(form_mink16_3);
        form_mink.push(form_mink13_1);

        //part 13-1

        form_mink.push(form_nsup2);
        form_mink.push(form_mink_23_1);

        form_mink.push(form_nsup2);
        form_mink.push(form_mink_32_1);

        form_mink.push(form_mink_23_1);
        form_mink.push(form_mink_52_1);

        //part 13-2

        form_mink.push(form_mink_5_1);
        form_mink.push(form_mink_52_1);

        form_mink.push(form_mink_10_1);
        form_mink.push(form_mink_32_1);

        form_mink.push(form_mink_22_1);
        form_mink.push(form_mink_23_1);

        form_mink.push(form_nsup2);
        form_mink.push(form_appl1b);

        //part 14

        form_mink.push(form_mink21_1);
        form_mink.push(form_mink34_5);

        form_mink.push(form_mink21_2);
        form_mink.push(form_mink34_4);

        form_mink.push(form_mink_9_2);
        form_mink.push(form_mink34_3);

        form_mink.push(form_nsup2);
        form_mink.push(form_mink34_2);

        form_mink.push(form_mink_23_1);
        form_mink.push(form_mink34_1);

        form_mink.push(form_mink_52_1);
        form_mink.push(form_mink34_7);

        form_mink.push(form_mink12_1);
        form_mink.push(form_mink34_6);

        form_mink.push(form_mink21_1);
        form_mink.push(form_mink29_2);

        form_mink.push(form_mink28_2);
        form_mink.push(form_mink29_2);

        form_mink.push(form_mink28_2);
        form_mink.push(form_mink27_3);

        form_mink.push(form_mink_23_1);
        form_mink.push(form_mink27_3);





        var form_geo1 = new THREE.Geometry().setFromPoints(form_mink);
        var form_m = new THREE.LineDashedMaterial({
            color: 0x0F3150,//color
            dashSize: 0.05,
            gapSize: 0.03,
            linewidth: 1

        });
        var form_minkow = new THREE.LineSegments(form_geo1, form_m);

        form_group_mink.add(form_minkow);


        var form_mink_red = [];

        //part 1

        form_mink_red.push(form_mink27_1);
        form_mink_red.push(form_nsup1);

        form_mink_red.push(form_mink_1_1);
        form_mink_red.push(form_mink_13_1);

        form_mink_red.push(form_mink27_1);
        form_mink_red.push(form_mink27_2);

        form_mink_red.push(form_nsup1);
        form_mink_red.push(form_nsup3);

        form_mink_red.push(form_mink27_2);
        form_mink_red.push(form_nsup3);

         //part 2

        form_mink_red.push(form_mink_2_1);
        form_mink_red.push(form_mink_23_1);

        form_mink_red.push(form_nsup1);
        form_mink_red.push(form_nsup2);

        form_mink_red.push(form_mink27_3);
        form_mink_red.push(form_mink27_1);

        form_mink_red.push(form_mink27_3);
        form_mink_red.push(form_nsup2);

        //part 3
        form_mink_red.push(form_nsup2);
        form_mink_red.push(form_nsup3);

        form_mink_red.push(form_mink27_3);
        form_mink_red.push(form_mink27_2);

        form_mink_red.push(form_mink_33_1);
        form_mink_red.push(form_mink_32_1);

        form_mink_red.push(form_mink_9_1);
        form_mink_red.push(form_mink28_1);

        form_mink_red.push(form_mink_9_2);
        form_mink_red.push(form_mink28_2);

        form_mink_red.push(form_mink_9_1);
        form_mink_red.push(form_mink_9_2);

        form_mink_red.push(form_mink28_2);
        form_mink_red.push(form_mink28_1);

        //part 4
        form_mink_red.push(form_mink28_3);
        form_mink_red.push(form_mink17_3);

        form_mink_red.push(form_mink_8_1);
        form_mink_red.push(form_mink17_1);

        form_mink_red.push(form_mink_9_1);
        form_mink_red.push(form_mink17_3);

        form_mink_red.push(form_mink28_3);
        form_mink_red.push(form_mink28_1);

        //part 5

        form_mink_red.push(form_mink22_2);
        form_mink_red.push(form_mink29_1);

        form_mink_red.push(form_mink23_2);
        form_mink_red.push(form_mink29_3);

        form_mink_red.push(form_mink29_1);
        form_mink_red.push(form_mink29_3);

        form_mink_red.push(form_mink22_2);
        form_mink_red.push(form_mink23_2);

        form_mink_red.push(form_mink22_1);
        form_mink_red.push(form_mink23_1);

        //part 6

        form_mink_red.push(form_mink21_2);
        form_mink_red.push(form_mink29_2);

        form_mink_red.push(form_mink28_2);
        form_mink_red.push(form_mink28_3);

        form_mink_red.push(form_mink_9_2);
        form_mink_red.push(form_mink17_3);

        form_mink_red.push(form_mink29_2);
        form_mink_red.push(form_mink29_1)

        form_mink_red.push(form_mink21_2);
        form_mink_red.push(form_mink22_2)

        form_mink_red.push(form_mink17_4);
        form_mink_red.push(form_mink14_1)

        //part 7

        form_mink_red.push(form_mink29_2);
        form_mink_red.push(form_mink29_3)

        form_mink_red.push(form_mink21_2);
        form_mink_red.push(form_mink23_2)

        form_mink_red.push(form_mink21_1);
        form_mink_red.push(form_mink23_3)







        var form_geo2 = new THREE.Geometry().setFromPoints(form_mink_red);
        var form_mr = new THREE.LineDashedMaterial({
            color: 0x80002F,//color
            dashSize: 0.05,
            gapSize: 0.03,
            linewidth: 1

        });
        var form_minkowr = new THREE.LineSegments(form_geo2, form_mr);

        form_group_mink.add(form_minkowr);


        form_group_mink.traverse(function(obj) {
            if (obj.type === "Mesh") {
                obj.material.visible =false;
                }
            if (obj.type === "LineSegments") {
                obj.material.visible =false;
                }
            });

        form_group_faces.traverse(function(obj) {
            if (obj.type === "Mesh") {
                obj.material.visible =false;
                }
            });
            form_group_forces.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =false;
                }
            });
            form_group_forces2.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =false;
                }
            });

            form_group_forces3.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =false;
                }
            });

            form_sigima_1.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =false;
                }
            });

            form_sigima_2.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =false;
                }
            });

            force_gamma_1.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =false;
                }
            });

            force_gamma_2.traverse(function(obj) {
            if (obj.type === "Sprite") {
                obj.material.visible =false;
                }
            });


















































        function Cal_Vec_2(vec1, vec2, vec3, n) {

            cb = new THREE.Vector3(),
                ab = new THREE.Vector3(),
                normal = new THREE.Vector3(),
                cb.subVectors(vec1, vec2);
            ab.subVectors(vec3, vec2);
            ab.cross(cb);
            normal.copy(ab).normalize();


            var newPoint = new THREE.Vector3(n * normal.x, n * normal.y, n * normal.z);
            return newPoint;
        }

        function Cal_Plane_Line_Intersect_Point(Point_online, LineVec, Point_onPlane, PlaneVec) {

            var IntersectPoint = new THREE.Vector3(
                //x
                Point_online.x + LineVec.x * ((Point_onPlane.x - Point_online.x) * PlaneVec.x + (Point_onPlane.y - Point_online.y) * PlaneVec.y + (Point_onPlane.z - Point_online.z) * PlaneVec.z) / (PlaneVec.x * LineVec.x + PlaneVec.y * LineVec.y + PlaneVec.z * LineVec.z),
                //y
                Point_online.y + LineVec.y * ((Point_onPlane.x - Point_online.x) * PlaneVec.x + (Point_onPlane.y - Point_online.y) * PlaneVec.y + (Point_onPlane.z - Point_online.z) * PlaneVec.z) / (PlaneVec.x * LineVec.x + PlaneVec.y * LineVec.y + PlaneVec.z * LineVec.z),
                //z
                Point_online.z + LineVec.z * ((Point_onPlane.x - Point_online.x) * PlaneVec.x + (Point_onPlane.y - Point_online.y) * PlaneVec.y + (Point_onPlane.z - Point_online.z) * PlaneVec.z) / (PlaneVec.x * LineVec.x + PlaneVec.y * LineVec.y + PlaneVec.z * LineVec.z))

            return IntersectPoint;
        }

        function create_form_tubes(face_area, face_area_max, scale, startPoint, targetPoint, PointO) {
            var form_mesh = face_area / face_area_max
            tt = scale * face_area

            var Sphere_Point = new THREE.Sphere(new THREE.Vector3(targetPoint.x, targetPoint.y, targetPoint.z), 0.1);
            var Close_Point = Sphere_Point.clampPoint(startPoint);

            var Sphere_Point2 = new THREE.Sphere(new THREE.Vector3(startPoint.x, startPoint.y, startPoint.z), 0.1);
            var Close_Point2 = Sphere_Point2.clampPoint(targetPoint);


            if (PointO.z <= ForceP_A.z) {

                if (form_mesh < 0.25 & form_mesh >= 0) {
                    var Colorbar_blue_1 = new THREE.MeshPhongMaterial({
                        color: 0x5B84AE
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_blue_1);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_blue_1);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesh = createCylinderMesh(Close_Point2, Close_Point, Colorbar_blue_1, tt, tt);
                    //var tube_arrow_3o2=createCylinderArrowMesh(newArrowP3O2 ,FormCP3,Colorbar_blue_1,0.02,0.05,0.6);
                }
                if (form_mesh < 0.5 & form_mesh >= 0.25) {
                    var Colorbar_blue_2 = new THREE.MeshPhongMaterial({
                        color: 0x376D9B
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_blue_2);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_blue_2);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesh = createCylinderMesh(Close_Point2, Close_Point, Colorbar_blue_2, tt, tt);
                    // var tube_arrow_3o2=createCylinderArrowMesh(newArrowP3O2 ,FormCP3,Colorbar_blue_2,0.02,0.05,0.6);
                }
                if (form_mesh < 0.75 & form_mesh >= 0.5) {
                    var Colorbar_blue_3 = new THREE.MeshPhongMaterial({
                        color: 0x05416D
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_blue_3);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_blue_3);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesh = createCylinderMesh(Close_Point2, Close_Point, Colorbar_blue_3, tt, tt);
                    //var tube_arrow_3o2=createCylinderArrowMesh(newArrowP3O2,FormCP3,Colorbar_blue_3,0.02,0.05,0.6);
                }

                if (form_mesh >= 0.75) {
                    var Colorbar_blue_4 = new THREE.MeshPhongMaterial({
                        color: 0x0F3150
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_blue_4);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_blue_4);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesh = createCylinderMesh(Close_Point2, Close_Point, Colorbar_blue_4, tt, tt);
                    //var tube_arrow_3o2=createCylinderArrowMesh(newArrowP3O2,FormCP3,Colorbar_blue_4,0.02,0.05,0.6);
                }
                form_group.add(sp_Point);
                form_group.add(sp_Point2);
                form_group.add(tubeMesh);
                // form_group.add(tube_arrow_3o2);
                sp_Point.castShadow = true;
                sp_Point2.castShadow = true;
                tubeMesh.castShadow = true;

            }

            else if (PointO.z > ForceP_A.z) {

                if (form_mesh < 0.25 & form_mesh >= 0) {
                    var Colorbar_red_1 = new THREE.MeshPhongMaterial({
                        color: 0xD72F62
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_red_1);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_red_1);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesht = createCylinderMesh(Close_Point2, Close_Point, Colorbar_red_1, tt, tt);
                    //var tube_arrow2=createCylinderArrowMesh(TubePoints2[1],new THREE.Vector3(1.22*TubePoints2[1].x,1.22*TubePoints2[1].y,1.22*TubePoints2[1].z),Colorbar_red_1,0.02,0.05,0.6);
                }
                if (form_mesh < 0.5 & form_mesh >= 0.25) {
                    var Colorbar_red_2 = new THREE.MeshPhongMaterial({
                        color: 0xCC0549
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_red_2);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_red_2);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesht = createCylinderMesh(Close_Point2, Close_Point, Colorbar_red_2, tt, tt);
                    //var tube_arrow2=createCylinderArrowMesh(TubePoints2[1],new THREE.Vector3(1.22*TubePoints2[1].x,1.22*TubePoints2[1].y,1.22*TubePoints2[1].z),Colorbar_red_2,0.02,0.05,0.6);
                }
                if (form_mesh < 0.75 & form_mesh >= 0.5) {
                    var Colorbar_red_3 = new THREE.MeshPhongMaterial({
                        color: 0x940041
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_red_3);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_red_3);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesht = createCylinderMesh(Close_Point2, Close_Point, Colorbar_red_3, tt, tt);
                    //var tube_arrow2=createCylinderArrowMesh(TubePoints2[1],new THREE.Vector3(1.22*TubePoints2[1].x,1.22*TubePoints2[1].y,1.22*TubePoints2[1].z),Colorbar_red_3,0.02,0.05,0.6);
                }

                if (form_mesh >= 0.75) {
                    var Colorbar_red_4 = new THREE.MeshPhongMaterial({
                        color: 0x80002F
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_red_4);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_red_4);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesht = createCylinderMesh(Close_Point2, Close_Point, Colorbar_red_4, tt, tt);
                    //var tube_arrow2=createCylinderArrowMesh(TubePoints2[1],new THREE.Vector3(1.22*TubePoints2[1].x,1.22*TubePoints2[1].y,1.22*TubePoints2[1].z),Colorbar_red_4,0.02,0.05,0.6);
                }
                form_group.add(sp_Point);
                form_group.add(sp_Point2);
                form_group.add(tubeMesht);
                // form_group.add(tube_arrow_3o2);
                sp_Point.castShadow = true;
                sp_Point2.castShadow = true;
                tubeMesht.castShadow = true;

            }



        }

        function create_form_tubes_t(face_area, face_area_max, scale, startPoint, targetPoint) {
            var form_mesh = face_area / face_area_max
            tt = scale * face_area

            var Sphere_Point = new THREE.Sphere(new THREE.Vector3(targetPoint.x, targetPoint.y, targetPoint.z), 0.1);
            var Close_Point = Sphere_Point.clampPoint(startPoint);

            var Sphere_Point2 = new THREE.Sphere(new THREE.Vector3(startPoint.x, startPoint.y, startPoint.z), 0.1);
            var Close_Point2 = Sphere_Point2.clampPoint(targetPoint);


            if (dis1a >= dis1b) {

                if (form_mesh < 0.25 & form_mesh >= 0) {
                    var Colorbar_blue_1 = new THREE.MeshPhongMaterial({
                        color: 0x5B84AE
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_blue_1);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_blue_1);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesh = createCylinderMesh(Close_Point2, Close_Point, Colorbar_blue_1, tt, tt);
                    //var tube_arrow_3o2=createCylinderArrowMesh(newArrowP3O2 ,FormCP3,Colorbar_blue_1,0.02,0.05,0.6);
                }
                if (form_mesh < 0.5 & form_mesh >= 0.25) {
                    var Colorbar_blue_2 = new THREE.MeshPhongMaterial({
                        color: 0x376D9B
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_blue_2);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_blue_2);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesh = createCylinderMesh(Close_Point2, Close_Point, Colorbar_blue_2, tt, tt);
                    // var tube_arrow_3o2=createCylinderArrowMesh(newArrowP3O2 ,FormCP3,Colorbar_blue_2,0.02,0.05,0.6);
                }
                if (form_mesh < 0.75 & form_mesh >= 0.5) {
                    var Colorbar_blue_3 = new THREE.MeshPhongMaterial({
                        color: 0x05416D
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_blue_3);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_blue_3);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesh = createCylinderMesh(Close_Point2, Close_Point, Colorbar_blue_3, tt, tt);
                    //var tube_arrow_3o2=createCylinderArrowMesh(newArrowP3O2,FormCP3,Colorbar_blue_3,0.02,0.05,0.6);
                }

                if (form_mesh >= 0.75) {
                    var Colorbar_blue_4 = new THREE.MeshPhongMaterial({
                        color: 0x0F3150
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_blue_4);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_blue_4);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesh = createCylinderMesh(Close_Point2, Close_Point, Colorbar_blue_4, tt, tt);
                    //var tube_arrow_3o2=createCylinderArrowMesh(newArrowP3O2,FormCP3,Colorbar_blue_4,0.02,0.05,0.6);
                }
                form_group.add(sp_Point);
                form_group.add(sp_Point2);
                form_group.add(tubeMesh);
                // form_group.add(tube_arrow_3o2);
                sp_Point.castShadow = true;
                sp_Point2.castShadow = true;
                tubeMesh.castShadow = true;

            }

            if (dis1a < dis1b) {

                if (form_mesh < 0.25 & form_mesh >= 0) {
                    var Colorbar_red_1 = new THREE.MeshPhongMaterial({
                        color: 0xD72F62
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_red_1);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_red_1);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesht = createCylinderMesh(Close_Point2, Close_Point, Colorbar_red_1, tt, tt);
                    //var tube_arrow2=createCylinderArrowMesh(TubePoints2[1],new THREE.Vector3(1.22*TubePoints2[1].x,1.22*TubePoints2[1].y,1.22*TubePoints2[1].z),Colorbar_red_1,0.02,0.05,0.6);
                }
                if (form_mesh < 0.5 & form_mesh >= 0.25) {
                    var Colorbar_red_2 = new THREE.MeshPhongMaterial({
                        color: 0xCC0549
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_red_2);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_red_2);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesht = createCylinderMesh(Close_Point2, Close_Point, Colorbar_red_2, tt, tt);
                    //var tube_arrow2=createCylinderArrowMesh(TubePoints2[1],new THREE.Vector3(1.22*TubePoints2[1].x,1.22*TubePoints2[1].y,1.22*TubePoints2[1].z),Colorbar_red_2,0.02,0.05,0.6);
                }
                if (form_mesh < 0.75 & form_mesh >= 0.5) {
                    var Colorbar_red_3 = new THREE.MeshPhongMaterial({
                        color: 0x940041
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_red_3);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_red_3);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesht = createCylinderMesh(Close_Point2, Close_Point, Colorbar_red_3, tt, tt);
                    //var tube_arrow2=createCylinderArrowMesh(TubePoints2[1],new THREE.Vector3(1.22*TubePoints2[1].x,1.22*TubePoints2[1].y,1.22*TubePoints2[1].z),Colorbar_red_3,0.02,0.05,0.6);
                }

                if (form_mesh >= 0.75) {
                    var Colorbar_red_4 = new THREE.MeshPhongMaterial({
                        color: 0x80002F
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_red_4);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_red_4);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesht = createCylinderMesh(Close_Point2, Close_Point, Colorbar_red_4, tt, tt);
                    //var tube_arrow2=createCylinderArrowMesh(TubePoints2[1],new THREE.Vector3(1.22*TubePoints2[1].x,1.22*TubePoints2[1].y,1.22*TubePoints2[1].z),Colorbar_red_4,0.02,0.05,0.6);
                }
                form_group.add(sp_Point);
                form_group.add(sp_Point2);
                form_group.add(tubeMesht);
                // form_group.add(tube_arrow_3o2);
                sp_Point.castShadow = true;
                sp_Point2.castShadow = true;
                tubeMesht.castShadow = true;

            }



        }

        function create_form_tubes_t2(face_area, face_area_max, scale, startPoint, targetPoint) {
            var form_mesh = face_area / face_area_max
            tt = scale * face_area

            var Sphere_Point = new THREE.Sphere(new THREE.Vector3(targetPoint.x, targetPoint.y, targetPoint.z), 0.1);
            var Close_Point = Sphere_Point.clampPoint(startPoint);

            var Sphere_Point2 = new THREE.Sphere(new THREE.Vector3(startPoint.x, startPoint.y, startPoint.z), 0.1);
            var Close_Point2 = Sphere_Point2.clampPoint(targetPoint);


            if (dis2a >= dis2b) {

                if (form_mesh < 0.25 & form_mesh >= 0) {
                    var Colorbar_blue_1 = new THREE.MeshPhongMaterial({
                        color: 0x5B84AE
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_blue_1);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_blue_1);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesh = createCylinderMesh(Close_Point2, Close_Point, Colorbar_blue_1, tt, tt);
                    //var tube_arrow_3o2=createCylinderArrowMesh(newArrowP3O2 ,FormCP3,Colorbar_blue_1,0.02,0.05,0.6);
                }
                if (form_mesh < 0.5 & form_mesh >= 0.25) {
                    var Colorbar_blue_2 = new THREE.MeshPhongMaterial({
                        color: 0x376D9B
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_blue_2);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_blue_2);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesh = createCylinderMesh(Close_Point2, Close_Point, Colorbar_blue_2, tt, tt);
                    // var tube_arrow_3o2=createCylinderArrowMesh(newArrowP3O2 ,FormCP3,Colorbar_blue_2,0.02,0.05,0.6);
                }
                if (form_mesh < 0.75 & form_mesh >= 0.5) {
                    var Colorbar_blue_3 = new THREE.MeshPhongMaterial({
                        color: 0x05416D
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_blue_3);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_blue_3);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesh = createCylinderMesh(Close_Point2, Close_Point, Colorbar_blue_3, tt, tt);
                    //var tube_arrow_3o2=createCylinderArrowMesh(newArrowP3O2,FormCP3,Colorbar_blue_3,0.02,0.05,0.6);
                }

                if (form_mesh >= 0.75) {
                    var Colorbar_blue_4 = new THREE.MeshPhongMaterial({
                        color: 0x0F3150
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_blue_4);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_blue_4);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesh = createCylinderMesh(Close_Point2, Close_Point, Colorbar_blue_4, tt, tt);
                    //var tube_arrow_3o2=createCylinderArrowMesh(newArrowP3O2,FormCP3,Colorbar_blue_4,0.02,0.05,0.6);
                }
                form_group.add(sp_Point);
                form_group.add(sp_Point2);
                form_group.add(tubeMesh);
                // form_group.add(tube_arrow_3o2);
                sp_Point.castShadow = true;
                sp_Point2.castShadow = true;
                tubeMesh.castShadow = true;

            }

            if (dis2a < dis2b) {

                if (form_mesh < 0.25 & form_mesh >= 0) {
                    var Colorbar_red_1 = new THREE.MeshPhongMaterial({
                        color: 0xD72F62
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_red_1);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_red_1);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesht = createCylinderMesh(Close_Point2, Close_Point, Colorbar_red_1, tt, tt);
                    //var tube_arrow2=createCylinderArrowMesh(TubePoints2[1],new THREE.Vector3(1.22*TubePoints2[1].x,1.22*TubePoints2[1].y,1.22*TubePoints2[1].z),Colorbar_red_1,0.02,0.05,0.6);
                }
                if (form_mesh < 0.5 & form_mesh >= 0.25) {
                    var Colorbar_red_2 = new THREE.MeshPhongMaterial({
                        color: 0xCC0549
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_red_2);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_red_2);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesht = createCylinderMesh(Close_Point2, Close_Point, Colorbar_red_2, tt, tt);
                    //var tube_arrow2=createCylinderArrowMesh(TubePoints2[1],new THREE.Vector3(1.22*TubePoints2[1].x,1.22*TubePoints2[1].y,1.22*TubePoints2[1].z),Colorbar_red_2,0.02,0.05,0.6);
                }
                if (form_mesh < 0.75 & form_mesh >= 0.5) {
                    var Colorbar_red_3 = new THREE.MeshPhongMaterial({
                        color: 0x940041
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_red_3);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_red_3);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesht = createCylinderMesh(Close_Point2, Close_Point, Colorbar_red_3, tt, tt);
                    //var tube_arrow2=createCylinderArrowMesh(TubePoints2[1],new THREE.Vector3(1.22*TubePoints2[1].x,1.22*TubePoints2[1].y,1.22*TubePoints2[1].z),Colorbar_red_3,0.02,0.05,0.6);
                }

                if (form_mesh >= 0.75) {
                    var Colorbar_red_4 = new THREE.MeshPhongMaterial({
                        color: 0x80002F
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_red_4);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_red_4);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesht = createCylinderMesh(Close_Point2, Close_Point, Colorbar_red_4, tt, tt);
                    //var tube_arrow2=createCylinderArrowMesh(TubePoints2[1],new THREE.Vector3(1.22*TubePoints2[1].x,1.22*TubePoints2[1].y,1.22*TubePoints2[1].z),Colorbar_red_4,0.02,0.05,0.6);
                }
                form_group.add(sp_Point);
                form_group.add(sp_Point2);
                form_group.add(tubeMesht);
                // form_group.add(tube_arrow_3o2);
                sp_Point.castShadow = true;
                sp_Point2.castShadow = true;
                tubeMesht.castShadow = true;

            }



        }

        function create_form_tubes_t3(face_area, face_area_max, scale, startPoint, targetPoint) {
            var form_mesh = face_area / face_area_max
            tt = scale * face_area

            var Sphere_Point = new THREE.Sphere(new THREE.Vector3(targetPoint.x, targetPoint.y, targetPoint.z), 0.1);
            var Close_Point = Sphere_Point.clampPoint(startPoint);

            var Sphere_Point2 = new THREE.Sphere(new THREE.Vector3(startPoint.x, startPoint.y, startPoint.z), 0.1);
            var Close_Point2 = Sphere_Point2.clampPoint(targetPoint);


            if (dis3a >= dis3b) {

                if (form_mesh < 0.25 & form_mesh >= 0) {
                    var Colorbar_blue_1 = new THREE.MeshPhongMaterial({
                        color: 0x5B84AE
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_blue_1);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_blue_1);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesh = createCylinderMesh(Close_Point2, Close_Point, Colorbar_blue_1, tt, tt);
                    //var tube_arrow_3o2=createCylinderArrowMesh(newArrowP3O2 ,FormCP3,Colorbar_blue_1,0.02,0.05,0.6);
                }
                if (form_mesh < 0.5 & form_mesh >= 0.25) {
                    var Colorbar_blue_2 = new THREE.MeshPhongMaterial({
                        color: 0x376D9B
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_blue_2);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_blue_2);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesh = createCylinderMesh(Close_Point2, Close_Point, Colorbar_blue_2, tt, tt);
                    // var tube_arrow_3o2=createCylinderArrowMesh(newArrowP3O2 ,FormCP3,Colorbar_blue_2,0.02,0.05,0.6);
                }
                if (form_mesh < 0.75 & form_mesh >= 0.5) {
                    var Colorbar_blue_3 = new THREE.MeshPhongMaterial({
                        color: 0x05416D
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_blue_3);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_blue_3);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesh = createCylinderMesh(Close_Point2, Close_Point, Colorbar_blue_3, tt, tt);
                    //var tube_arrow_3o2=createCylinderArrowMesh(newArrowP3O2,FormCP3,Colorbar_blue_3,0.02,0.05,0.6);
                }

                if (form_mesh >= 0.75) {
                    var Colorbar_blue_4 = new THREE.MeshPhongMaterial({
                        color: 0x0F3150
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_blue_4);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_blue_4);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesh = createCylinderMesh(Close_Point2, Close_Point, Colorbar_blue_4, tt, tt);
                    //var tube_arrow_3o2=createCylinderArrowMesh(newArrowP3O2,FormCP3,Colorbar_blue_4,0.02,0.05,0.6);
                }
                form_group.add(sp_Point);
                form_group.add(sp_Point2);
                form_group.add(tubeMesh);
                // form_group.add(tube_arrow_3o2);
                sp_Point.castShadow = true;
                sp_Point2.castShadow = true;
                tubeMesh.castShadow = true;

            }

            if (dis3a < dis3b) {

                if (form_mesh < 0.25 & form_mesh >= 0) {
                    var Colorbar_red_1 = new THREE.MeshPhongMaterial({
                        color: 0xD72F62
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_red_1);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_red_1);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesht = createCylinderMesh(Close_Point2, Close_Point, Colorbar_red_1, tt, tt);
                    //var tube_arrow2=createCylinderArrowMesh(TubePoints2[1],new THREE.Vector3(1.22*TubePoints2[1].x,1.22*TubePoints2[1].y,1.22*TubePoints2[1].z),Colorbar_red_1,0.02,0.05,0.6);
                }
                if (form_mesh < 0.5 & form_mesh >= 0.25) {
                    var Colorbar_red_2 = new THREE.MeshPhongMaterial({
                        color: 0xCC0549
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_red_2);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_red_2);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesht = createCylinderMesh(Close_Point2, Close_Point, Colorbar_red_2, tt, tt);
                    //var tube_arrow2=createCylinderArrowMesh(TubePoints2[1],new THREE.Vector3(1.22*TubePoints2[1].x,1.22*TubePoints2[1].y,1.22*TubePoints2[1].z),Colorbar_red_2,0.02,0.05,0.6);
                }
                if (form_mesh < 0.75 & form_mesh >= 0.5) {
                    var Colorbar_red_3 = new THREE.MeshPhongMaterial({
                        color: 0x940041
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_red_3);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_red_3);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesht = createCylinderMesh(Close_Point2, Close_Point, Colorbar_red_3, tt, tt);
                    //var tube_arrow2=createCylinderArrowMesh(TubePoints2[1],new THREE.Vector3(1.22*TubePoints2[1].x,1.22*TubePoints2[1].y,1.22*TubePoints2[1].z),Colorbar_red_3,0.02,0.05,0.6);
                }

                if (form_mesh >= 0.75) {
                    var Colorbar_red_4 = new THREE.MeshPhongMaterial({
                        color: 0x80002F
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_red_4);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_red_4);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesht = createCylinderMesh(Close_Point2, Close_Point, Colorbar_red_4, tt, tt);
                    //var tube_arrow2=createCylinderArrowMesh(TubePoints2[1],new THREE.Vector3(1.22*TubePoints2[1].x,1.22*TubePoints2[1].y,1.22*TubePoints2[1].z),Colorbar_red_4,0.02,0.05,0.6);
                }
                form_group.add(sp_Point);
                form_group.add(sp_Point2);
                form_group.add(tubeMesht);
                // form_group.add(tube_arrow_3o2);
                sp_Point.castShadow = true;
                sp_Point2.castShadow = true;
                tubeMesht.castShadow = true;

            }



        }

        function create_form_tubes_t4(face_area, face_area_max, scale, startPoint, targetPoint) {
            var form_mesh = face_area / face_area_max
            tt = scale * face_area

            var Sphere_Point = new THREE.Sphere(new THREE.Vector3(targetPoint.x, targetPoint.y, targetPoint.z), 0.1);
            var Close_Point = Sphere_Point.clampPoint(startPoint);

            var Sphere_Point2 = new THREE.Sphere(new THREE.Vector3(startPoint.x, startPoint.y, startPoint.z), 0.1);
            var Close_Point2 = Sphere_Point2.clampPoint(targetPoint);


            if (dis4a >= dis4b) {

                if (form_mesh < 0.25 & form_mesh >= 0) {
                    var Colorbar_blue_1 = new THREE.MeshPhongMaterial({
                        color: 0x5B84AE
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_blue_1);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_blue_1);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesh = createCylinderMesh(Close_Point2, Close_Point, Colorbar_blue_1, tt, tt);
                    //var tube_arrow_3o2=createCylinderArrowMesh(newArrowP3O2 ,FormCP3,Colorbar_blue_1,0.02,0.05,0.6);
                }
                if (form_mesh < 0.5 & form_mesh >= 0.25) {
                    var Colorbar_blue_2 = new THREE.MeshPhongMaterial({
                        color: 0x376D9B
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_blue_2);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_blue_2);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesh = createCylinderMesh(Close_Point2, Close_Point, Colorbar_blue_2, tt, tt);
                    // var tube_arrow_3o2=createCylinderArrowMesh(newArrowP3O2 ,FormCP3,Colorbar_blue_2,0.02,0.05,0.6);
                }
                if (form_mesh < 0.75 & form_mesh >= 0.5) {
                    var Colorbar_blue_3 = new THREE.MeshPhongMaterial({
                        color: 0x05416D
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_blue_3);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_blue_3);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesh = createCylinderMesh(Close_Point2, Close_Point, Colorbar_blue_3, tt, tt);
                    //var tube_arrow_3o2=createCylinderArrowMesh(newArrowP3O2,FormCP3,Colorbar_blue_3,0.02,0.05,0.6);
                }

                if (form_mesh >= 0.75) {
                    var Colorbar_blue_4 = new THREE.MeshPhongMaterial({
                        color: 0x0F3150
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_blue_4);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_blue_4);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesh = createCylinderMesh(Close_Point2, Close_Point, Colorbar_blue_4, tt, tt);
                    //var tube_arrow_3o2=createCylinderArrowMesh(newArrowP3O2,FormCP3,Colorbar_blue_4,0.02,0.05,0.6);
                }
                form_group.add(sp_Point);
                form_group.add(sp_Point2);
                form_group.add(tubeMesh);
                // form_group.add(tube_arrow_3o2);
                sp_Point.castShadow = true;
                sp_Point2.castShadow = true;
                tubeMesh.castShadow = true;

            }

            if (dis4a < dis4b) {

                if (form_mesh < 0.25 & form_mesh >= 0) {
                    var Colorbar_red_1 = new THREE.MeshPhongMaterial({
                        color: 0xD72F62
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_red_1);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_red_1);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesht = createCylinderMesh(Close_Point2, Close_Point, Colorbar_red_1, tt, tt);
                    //var tube_arrow2=createCylinderArrowMesh(TubePoints2[1],new THREE.Vector3(1.22*TubePoints2[1].x,1.22*TubePoints2[1].y,1.22*TubePoints2[1].z),Colorbar_red_1,0.02,0.05,0.6);
                }
                if (form_mesh < 0.5 & form_mesh >= 0.25) {
                    var Colorbar_red_2 = new THREE.MeshPhongMaterial({
                        color: 0xCC0549
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_red_2);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_red_2);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesht = createCylinderMesh(Close_Point2, Close_Point, Colorbar_red_2, tt, tt);
                    //var tube_arrow2=createCylinderArrowMesh(TubePoints2[1],new THREE.Vector3(1.22*TubePoints2[1].x,1.22*TubePoints2[1].y,1.22*TubePoints2[1].z),Colorbar_red_2,0.02,0.05,0.6);
                }
                if (form_mesh < 0.75 & form_mesh >= 0.5) {
                    var Colorbar_red_3 = new THREE.MeshPhongMaterial({
                        color: 0x940041
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_red_3);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_red_3);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesht = createCylinderMesh(Close_Point2, Close_Point, Colorbar_red_3, tt, tt);
                    //var tube_arrow2=createCylinderArrowMesh(TubePoints2[1],new THREE.Vector3(1.22*TubePoints2[1].x,1.22*TubePoints2[1].y,1.22*TubePoints2[1].z),Colorbar_red_3,0.02,0.05,0.6);
                }

                if (form_mesh >= 0.75) {
                    var Colorbar_red_4 = new THREE.MeshPhongMaterial({
                        color: 0x80002F
                    });
                    var spGeom_Point = new THREE.SphereGeometry(tt - 0.001);
                    var sp_Point = new THREE.Mesh(spGeom_Point, Colorbar_red_4);
                    var sp_Point2 = new THREE.Mesh(spGeom_Point, Colorbar_red_4);
                    sp_Point.position.copy(Close_Point);
                    sp_Point2.position.copy(Close_Point2);
                    var tubeMesht = createCylinderMesh(Close_Point2, Close_Point, Colorbar_red_4, tt, tt);
                    //var tube_arrow2=createCylinderArrowMesh(TubePoints2[1],new THREE.Vector3(1.22*TubePoints2[1].x,1.22*TubePoints2[1].y,1.22*TubePoints2[1].z),Colorbar_red_4,0.02,0.05,0.6);
                }
                form_group.add(sp_Point);
                form_group.add(sp_Point2);
                form_group.add(tubeMesht);
                // form_group.add(tube_arrow_3o2);
                sp_Point.castShadow = true;
                sp_Point2.castShadow = true;
                tubeMesht.castShadow = true;

            }



        }

        function create_Tri_FaceMesh_test(p1, p2, p3, arr_face_dir, Is_First, arr_dir, text)//direction为三角形往哪个方向拉伸



        {

            var corepoint = face_center(p1, p2, p3);
            var m = 0.2;//scale

            //move point
            var dirA = new THREE.Vector3().subVectors(corepoint, p1);
            var dirB = new THREE.Vector3().subVectors(corepoint, p2);
            var dirC = new THREE.Vector3().subVectors(corepoint, p3);

            dirA.normalize();
            dirB.normalize();
            dirC.normalize();

            //move point

            var p1_1 = new THREE.Vector3();
            // p1_1=subVec(p1,m*unit_dir1);
            p1_1.x = p1.x + m * dirA.x;
            p1_1.y = p1.y + m * dirA.y;
            p1_1.z = p1.z + m * dirA.z;

            var p2_1 = new THREE.Vector3();
            p2_1.x = p2.x + m * dirB.x;
            p2_1.y = p2.y + m * dirB.y;
            p2_1.z = p2.z + m * dirB.z;

            var p3_1 = new THREE.Vector3();
            p3_1.x = p3.x + m * dirC.x;
            p3_1.y = p3.y + m * dirC.y;
            p3_1.z = p3.z + m * dirC.z;



            var vertices_tri = [
                p1_1, p2_1, p3_1
            ];

            var faces_tri = [
                new THREE.Face3(2, 1, 0),

            ];


            var geom_tri = new THREE.Geometry();
            geom_tri.vertices = vertices_tri;
            geom_tri.faces = faces_tri;
            geom_tri.computeFaceNormals();


            for (i = 0; i < geom_tri.faces.length; i++) {
                if (Is_First) {
                    var hex = 0x008000;
                    geom_tri.faces[i].color.setHex(hex);
                }
                else {
                    var hex = 0xa9a9a9;
                    geom_tri.faces[i].color.setHex(hex);
                }

            }



            var materials_tri = [
                //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                // new THREE.MeshBasicMaterial({color: 0x4d4dff, wireframe: true,transparent: true,opacity:0.05}),
                new THREE.MeshBasicMaterial({
                    vertexColors: THREE.FaceColors, transparent: true, opacity: 0.2, side: THREE.DoubleSide
                })
            ];

            var mesh_tri = new THREE.SceneUtils.createMultiMaterialObject(geom_tri, materials_tri);


            // var hex = 0x000000;//black
            if (Is_First)

                var arr_face_material = new THREE.MeshPhongMaterial({
                    color: 0x009600//force face green
                });
            else
                var arr_face_material = new THREE.MeshPhongMaterial({
                    color: 0x000000//force face black
                });

            var arr_material2;

            if (arr_dir < 0)//c or t
            {
                arrow_material2 = new THREE.MeshPhongMaterial({
                    color: 0xC00000//red
                });

            }
            else {
                arrow_material2 = new THREE.MeshPhongMaterial({

                    color: 0x0F3150//blue
                });

            }


            //in or out

            var forceFaceDir = Pnt_copy(arr_face_dir);
            forceFaceDir.normalize();

            //in or out
            var out1 = new THREE.Vector3();
            out1.x = corepoint.x + 0.2 * forceFaceDir.x;
            out1.y = corepoint.y + 0.2 * forceFaceDir.y;
            out1.z = corepoint.z + 0.2 * forceFaceDir.z;


            var out2 = new THREE.Vector3();
            out2.x = corepoint.x - 0.2 * forceFaceDir.x;
            out2.y = corepoint.y - 0.2 * forceFaceDir.y;
            out2.z = corepoint.z - 0.2 * forceFaceDir.z;

            var out1_core = new THREE.Vector3().subVectors(out1, corePoint_body2);
            var out2_core = new THREE.Vector3().subVectors(out2, corePoint_body2);

            if (out1_core.length() > out2_core.length())//out
            {


                var arrowHP1 = createCylinderArrowMesh(p3_1, p1_1, arr_face_material, 0.01, 0.03, 0.9);//face arr

                // var direction1 = new THREE.Vector3().subVectors(p1_1, p3_1);
                // var length1=direction1.length();
                // direction1.normalize();
                // var arrowHelper1 = new THREE.ArrowHelper(direction1, p3_1, length1,hex,0.2,0.05);
                mesh_tri.add(arrowHP1);

                // var direction2 = new THREE.Vector3().subVectors(p3_1, p2_1);
                // var length2=direction2.length();
                // direction2.normalize();
                // var arrowHelper2 = new THREE.ArrowHelper(direction2, p2_1, length2,hex,0.2,0.05);
                var arrowHP2 = createCylinderArrowMesh(p2_1, p3_1, arr_face_material, 0.01, 0.03, 0.9);//face arr
                mesh_tri.add(arrowHP2);

                // var direction3 = new THREE.Vector3().subVectors(p2_1, p1_1);
                // var length3=direction3.length();
                // direction3.normalize();
                // var arrowHelper3 = new THREE.ArrowHelper(direction3, p1_1, length3,hex,0.2,0.05);
                var arrowHP3 = createCylinderArrowMesh(p1_1, p2_1, arr_face_material, 0.01, 0.03, 0.9);//face arr
                mesh_tri.add(arrowHP3);

                //draw normal

                var corepoint2 = new THREE.Vector3();
                corepoint2.x = corepoint.x + 0.4 * forceFaceDir.x;
                corepoint2.y = corepoint.y + 0.4 * forceFaceDir.y;
                corepoint2.z = corepoint.z + 0.4 * forceFaceDir.z;

                var corepoint3 = new THREE.Vector3();
                corepoint3.x = corepoint.x + 0.37 * forceFaceDir.x;
                corepoint3.y = corepoint.y + 0.37 * forceFaceDir.y;
                corepoint3.z = corepoint.z + 0.37 * forceFaceDir.z;



                //=new THREE.ArrowHelper(forceFaceDir,corepoint,0.5*forceFaceDir.length(),0x00ff00,0.2,0.1);
                if (Is_First)//color diff
                {
                    var arrow_material1 = new THREE.MeshPhongMaterial({
                        color: 0x009600
                    });
                    var arrowN = createCylinderArrowMesh(corepoint, corepoint2, arrow_material1, 0.02, 0.05, 0.6);
                    //
                }
                else
                    var arrowN = createCylinderArrowMesh(corepoint, corepoint2, arrow_material2, 0.02, 0.05, 0.6);


                mesh_tri.add(arrowN);

                if (Is_First)//color diff
                {
                    var arrow_material_outline = new THREE.MeshBasicMaterial({ color: "white", transparent: false, side: THREE.BackSide });
                    var arrowN_O = createCylinderArrowMesh(corepoint, corepoint3, arrow_material_outline, 0.025, 0.05, 0.55);
                    //
                }
                else
                    var arrow_material_outline = new THREE.MeshBasicMaterial({ color: "white", transparent: false, side: THREE.BackSide });
                var arrowN_O = createCylinderArrowMesh(corepoint, corepoint3, arrow_material_outline, 0.025, 0.05, 0.55);



                mesh_tri.add(arrowN_O);
                arrowN_O.scale.multiplyScalar(1.2);

                var TXMesh = createSpriteText(text, corepoint2);

                text_group2.add(TXMesh);

                //face arr

                var cir_dir = new THREE.Vector3().subVectors(corepoint, p1);
                cir_dir.normalize();

                var arrowpt = new THREE.Vector3();
                arrowpt.x = corepoint.x + 0.2 * cir_dir.x;
                arrowpt.y = corepoint.y + 0.2 * cir_dir.y;
                arrowpt.z = corepoint.z + 0.2 * cir_dir.z;

                //arr_dir.normalize();

                var direction1 = cir_dir.applyAxisAngle(forceFaceDir, Math.PI / 2);

                //var direction1 = new THREE.Vector3().subVectors(p1, p2);
                var length1 = 0.001;
                direction1.normalize();
                var arrowHelper1 = new THREE.ArrowHelper(direction1, arrowpt, length1, "black", 0.1, 0.05);

                //        mesh_tri.add(arrowHelper1);


                //cir arr

                var circle_mesh = createCircleFaceArrow(corepoint, 0.1, forceFaceDir);
                mesh_tri.add(circle_mesh);



            }
            else {


                var arrowHP1 = createCylinderArrowMesh(p1_1, p2_1, arr_face_material, 0.01, 0.03, 0.9);
                mesh_tri.add(arrowHP1);


                var arrowHP2 = createCylinderArrowMesh(p2_1, p3_1, arr_face_material, 0.01, 0.03, 0.9);
                mesh_tri.add(arrowHP2);


                var arrowHP3 = createCylinderArrowMesh(p3_1, p1_1, arr_face_material, 0.01, 0.03, 0.9);
                mesh_tri.add(arrowHP3);



                var corepoint2 = new THREE.Vector3();
                corepoint2.x = corepoint.x - 0.4 * forceFaceDir.x;
                corepoint2.y = corepoint.y - 0.4 * forceFaceDir.y;
                corepoint2.z = corepoint.z - 0.4 * forceFaceDir.z;

                var corepoint3 = new THREE.Vector3();
                corepoint3.x = corepoint.x - 0.37 * forceFaceDir.x;
                corepoint3.y = corepoint.y - 0.37 * forceFaceDir.y;
                corepoint3.z = corepoint.z - 0.37 * forceFaceDir.z;

                if (Is_First)//color diff
                {
                    var arrow_material1 = new THREE.MeshPhongMaterial({
                        color: 0x009600
                    });
                    //var arrowN=createCylinderArrowMesh(corepoint,corepoint2,arrow_material1,0.02,0.05,0.7);
                    var arrowN = createCylinderArrowMesh(corepoint2, corepoint, arrow_material1, 0.02, 0.05, 0.6);

                }
                else
                    var arrowN = createCylinderArrowMesh(corepoint2, corepoint, arrow_material2, 0.02, 0.05, 0.6);


                mesh_tri.add(arrowN);

                if (Is_First)//color diff
                {
                    var arrow_material_outline = new THREE.MeshBasicMaterial({ color: "white", transparent: false, side: THREE.BackSide });
                    var arrowN_O = createCylinderArrowMesh(corepoint3, corepoint, arrow_material_outline, 0.025, 0.05, 0.55);
                    //
                }
                else
                    var arrow_material_outline = new THREE.MeshBasicMaterial({ color: "white", transparent: false, side: THREE.BackSide });
                var arrowN_O = createCylinderArrowMesh(corepoint3, corepoint, arrow_material_outline, 0.025, 0.05, 0.55);



                mesh_tri.add(arrowN_O);
                arrowN_O.scale.multiplyScalar(1.2);

                var TXMesh1 = createSpriteText(text, corepoint2);

                text_group2.add(TXMesh1);

                // var Line_center=new THREE.Vector3((p1.x+p2.x)/2,(p1.y+p2.y)/2,(p1.z+p2.z)/2);

                var cir_dir = new THREE.Vector3().subVectors(corepoint, p1);
                cir_dir.normalize();

                var arrowpt = new THREE.Vector3();
                arrowpt.x = corepoint.x + 0.2 * cir_dir.x;
                arrowpt.y = corepoint.y + 0.2 * cir_dir.y;
                arrowpt.z = corepoint.z + 0.2 * cir_dir.z;

                //arr_dir.normalize();

                var direction1 = cir_dir.applyAxisAngle(forceFaceDir, Math.PI / 2);

                //var direction1 = new THREE.Vector3().subVectors(p1, p2);
                var length1 = 0.001;
                direction1.normalize();
                var arrowHelper1 = new THREE.ArrowHelper(direction1, arrowpt, length1, "black", 0.1, 0.1);

                //            mesh_tri.add(arrowHelper1);


                //cir arr

                var circle_mesh = createCircleFaceArrow(corepoint, 0.1, forceFaceDir);
                mesh_tri.add(circle_mesh);




                return mesh_tri;

            }
        }


        function create_supports_Text_P(text, pos) {

            var canvas = document.createElement("canvas");
            canvas.width = 240;
            canvas.height = 240;
            var ctx = canvas.getContext("2d");
            ctx.fillStyle = "black";
            ctx.font = "80px Palatino";
            ctx.lineWidth = 2;
            ctx.fillText(text.charAt(0), 150, 150);
            ctx.fillStyle = "black";
            ctx.font = "50px Palatino";
            ctx.lineWidth = 2;
            ctx.fillText(text.charAt(1), 190, 170);

            var texture = new THREE.Texture(canvas);
            texture.needsUpdate = true;


            var material = new THREE.SpriteMaterial({ map: texture, depthWrite: false });
            var textObj = new THREE.Sprite(material);
            textObj.scale.set(0.5, 0.5, 0.5);


            //textObj.position.set(pos1);

            var posdir = Pnt_copy(pos);

            posdir.normalize();

            textObj.position.x = pos.x; //* (fontGeometry.boundingBox.max.x - fontGeometry.boundingBox.min.x);
            textObj.position.y = pos.y;
            textObj.position.z = pos.z - 0.1;


            return textObj;
        }

        function create_trial_Text_P_2(text, pos) {

            var canvas = document.createElement("canvas");
            canvas.width = 240;
            canvas.height = 240;
            var ctx = canvas.getContext("2d");
            ctx.fillStyle = "black";
            ctx.font = "80px Palatino";
            ctx.lineWidth = 2;
            ctx.fillText(text.charAt(0), 150, 150);
            ctx.fillStyle = "black";
            ctx.font = "50px Palatino";
            ctx.lineWidth = 2;
            ctx.fillText(text.charAt(1), 200, 120);
            ctx.fillStyle = "black";
            ctx.font = "50px Palatino";
            ctx.lineWidth = 2;
            ctx.fillText(text.charAt(2), 210, 120);


            var texture = new THREE.Texture(canvas);
            texture.needsUpdate = true;


            var material = new THREE.SpriteMaterial({ map: texture, depthWrite: false });
            var textObj = new THREE.Sprite(material);
            textObj.scale.set(0.5, 0.5, 0.5);


            //textObj.position.set(pos1);

            var posdir = Pnt_copy(pos);

            posdir.normalize();

            textObj.position.x = pos.x; //* (fontGeometry.boundingBox.max.x - fontGeometry.boundingBox.min.x);
            textObj.position.y = pos.y;
            textObj.position.z = pos.z - 0.1;


            return textObj;
        }

        function create_trial_Text_P_3(text, pos) {

            var canvas = document.createElement("canvas");
            canvas.width = 240;
            canvas.height = 240;
            var ctx = canvas.getContext("2d");
            ctx.fillStyle = "black";
            ctx.font = "80px Palatino";
            ctx.lineWidth = 2;
            ctx.fillText(text.charAt(0), 150, 150);
            ctx.fillStyle = "black";
            ctx.font = "50px Palatino";
            ctx.lineWidth = 2;
            ctx.fillText(text.charAt(1), 200, 120);
            ctx.fillStyle = "black";
            ctx.font = "50px Palatino";
            ctx.lineWidth = 2;
            ctx.fillText(text.charAt(2), 210, 120);


            var texture = new THREE.Texture(canvas);
            texture.needsUpdate = true;


            var material = new THREE.SpriteMaterial({ map: texture, depthWrite: false });
            var textObj = new THREE.Sprite(material);
            textObj.scale.set(0.5, 0.5, 0.5);


            //textObj.position.set(pos1);

            var posdir = Pnt_copy(pos);

            posdir.normalize();

            textObj.position.x = pos.x; //* (fontGeometry.boundingBox.max.x - fontGeometry.boundingBox.min.x);
            textObj.position.y = pos.y;
            textObj.position.z = pos.z + 0.15;


            return textObj;
        }

        function create_trial_Text_P(text, pos) {

            var canvas = document.createElement("canvas");
            canvas.width = 240;
            canvas.height = 240;
            var ctx = canvas.getContext("2d");
            ctx.fillStyle = "black";
            ctx.font = "80px Palatino";
            ctx.lineWidth = 2;
            ctx.fillText(text.charAt(0), 150, 150);
            ctx.fillStyle = "black";
            ctx.font = "50px Palatino";
            ctx.lineWidth = 2;
            ctx.fillText(text.charAt(1), 200, 120);



            var texture = new THREE.Texture(canvas);
            texture.needsUpdate = true;


            var material = new THREE.SpriteMaterial({ map: texture, depthWrite: false });
            var textObj = new THREE.Sprite(material);
            textObj.scale.set(0.5, 0.5, 0.5);


            //textObj.position.set(pos1);

            var posdir = Pnt_copy(pos);

            posdir.normalize();

            textObj.position.x = pos.x; //* (fontGeometry.boundingBox.max.x - fontGeometry.boundingBox.min.x);
            textObj.position.y = pos.y;
            textObj.position.z = pos.z - 0.1;


            return textObj;
        }

        function create_trial_Text_P_2d(text, pos) {

            var canvas = document.createElement("canvas");
            canvas.width = 240;
            canvas.height = 240;
            var ctx = canvas.getContext("2d");
            ctx.fillStyle = "black";
            ctx.font = "80px Palatino";
            ctx.lineWidth = 2;
            ctx.fillText(text.charAt(0), 150, 150);
            ctx.fillStyle = "black";
            ctx.font = "50px Palatino";
            ctx.lineWidth = 2;
            ctx.fillText(text.charAt(1), 200, 120);



            var texture = new THREE.Texture(canvas);
            texture.needsUpdate = true;


            var material = new THREE.SpriteMaterial({ map: texture, depthWrite: false });
            var textObj = new THREE.Sprite(material);
            textObj.scale.set(0.5, 0.5, 0.5);


            //textObj.position.set(pos1);

            var posdir = Pnt_copy(pos);

            posdir.normalize();

            textObj.position.x = pos.x; //* (fontGeometry.boundingBox.max.x - fontGeometry.boundingBox.min.x);
            textObj.position.y = pos.y;
            textObj.position.z = pos.z + 0.1;


            return textObj;
        }

        function create_trial_force_x(text, pos) {

            var canvas = document.createElement("canvas");
            canvas.width = 240;
            canvas.height = 240;
            var ctx = canvas.getContext("2d");
            ctx.fillStyle = "black";
            ctx.font = "80px Gabriola";
            ctx.lineWidth = 2;
            ctx.fillText(text.charAt(0), 150, 150);
            ctx.fillStyle = "black";
            ctx.font = "30px Palatino";
            ctx.lineWidth = 2;
            ctx.fillText(text.charAt(1), 180, 170);



            var texture = new THREE.Texture(canvas);
            texture.needsUpdate = true;


            var material = new THREE.SpriteMaterial({ map: texture, depthWrite: false });
            var textObj = new THREE.Sprite(material);
            textObj.scale.set(0.5, 0.5, 0.5);


            //textObj.position.set(pos1);

            var posdir = Pnt_copy(pos);

            posdir.normalize();

            textObj.position.x = pos.x; //* (fontGeometry.boundingBox.max.x - fontGeometry.boundingBox.min.x);
            textObj.position.y = pos.y;
            textObj.position.z = pos.z + 0.1;


            return textObj;
        }

        function create_trial_force_l(text, pos) {

            var canvas = document.createElement("canvas");
            canvas.width = 240;
            canvas.height = 240;
            var ctx = canvas.getContext("2d");
            ctx.fillStyle = "black";
            ctx.font = "80px Gabriola";
            ctx.lineWidth = 2;
            ctx.fillText(text.charAt(0), 150, 150);
            ctx.fillStyle = "black";
            ctx.font = "50px Palatino";
            ctx.lineWidth = 2;
            ctx.fillText(text.charAt(1), 170, 170);
            ctx.fillStyle = "black";
            ctx.font = "50px Palatino";
            ctx.lineWidth = 2;
            ctx.fillText(text.charAt(2), 200, 170);



            var texture = new THREE.Texture(canvas);
            texture.needsUpdate = true;


            var material = new THREE.SpriteMaterial({ map: texture, depthWrite: false });
            var textObj = new THREE.Sprite(material);
            textObj.scale.set(0.5, 0.5, 0.5);


            //textObj.position.set(pos1);

            var posdir = Pnt_copy(pos);

            posdir.normalize();

            textObj.position.x = pos.x; //* (fontGeometry.boundingBox.max.x - fontGeometry.boundingBox.min.x);
            textObj.position.y = pos.y;
            textObj.position.z = pos.z - 0.1;


            return textObj;
        }

        function create_trial_force_o(text, pos) {

            var canvas = document.createElement("canvas");
            canvas.width = 240;
            canvas.height = 240;
            var ctx = canvas.getContext("2d");
            ctx.fillStyle = "black";
            ctx.font = "80px Gabriola";
            ctx.lineWidth = 2;
            ctx.fillText(text.charAt(0), 150, 150);
            ctx.fillStyle = "black";
            ctx.font = "50px Palatino";
            ctx.lineWidth = 2;
            ctx.fillText(text.charAt(1), 190, 170);
            ctx.fillStyle = "black";
            ctx.font = "50px Palatino";
            ctx.lineWidth = 2;
            ctx.fillText(text.charAt(2), 200, 170);



            var texture = new THREE.Texture(canvas);
            texture.needsUpdate = true;


            var material = new THREE.SpriteMaterial({ map: texture, depthWrite: false });
            var textObj = new THREE.Sprite(material);
            textObj.scale.set(0.5, 0.5, 0.5);


            //textObj.position.set(pos1);

            var posdir = Pnt_copy(pos);

            posdir.normalize();

            textObj.position.x = pos.x; //* (fontGeometry.boundingBox.max.x - fontGeometry.boundingBox.min.x);
            textObj.position.y = pos.y;
            textObj.position.z = pos.z - 0.1;


            return textObj;
        }

        function create_supports_Text_Normal(text, pos) {

            var canvas = document.createElement("canvas");
            canvas.width = 240;
            canvas.height = 240;
            var ctx = canvas.getContext("2d");
            ctx.fillStyle = "black";
            ctx.font = "Bold 80px Palatino";
            ctx.lineWidth = 2;
            ctx.fillText(text.charAt(0), 150, 150);
            ctx.fillStyle = "black";
            ctx.font = "50px Palatino";
            ctx.lineWidth = 2;
            ctx.fillText(text.charAt(1), 190, 170);
            ctx.fillStyle = "black";
            ctx.font = "50px Palatino";
            ctx.lineWidth = 2;
            ctx.fillText(text.charAt(2), 210, 170);

            var texture = new THREE.Texture(canvas);
            texture.needsUpdate = true;


            var material = new THREE.SpriteMaterial({ map: texture, depthWrite: false });
            var textObj = new THREE.Sprite(material);
            textObj.scale.set(0.5, 0.5, 0.5);


            //textObj.position.set(pos1);

            var posdir = Pnt_copy(pos);

            posdir.normalize();

            textObj.position.x = pos.x + 0.1 * posdir.x; //* (fontGeometry.boundingBox.max.x - fontGeometry.boundingBox.min.x);
            textObj.position.y = pos.y + 0.1 * posdir.y;
            textObj.position.z = pos.z + 0.1 * posdir.z;


            return textObj;
        }

        function create_trial_Text_Normal(text, pos) {

            var canvas = document.createElement("canvas");
            canvas.width = 260;
            canvas.height = 260;
            var ctx = canvas.getContext("2d");
            ctx.fillStyle = "black";
            ctx.font = "Bold 80px Palatino";
            ctx.lineWidth = 2;
            ctx.fillText(text.charAt(0), 150, 150);
            ctx.fillStyle = "black";
            ctx.font = "50px Palatino";
            ctx.lineWidth = 2;
            ctx.fillText(text.charAt(1), 190, 170);
            ctx.fillStyle = "black";
            ctx.font = "50px Palatino";
            ctx.lineWidth = 2;
            ctx.fillText(text.charAt(2), 210, 170);
            ctx.fillStyle = "black";
            ctx.font = "50px Palatino";
            ctx.lineWidth = 2;
            ctx.fillText(text.charAt(3), 235, 170);

            var texture = new THREE.Texture(canvas);
            texture.needsUpdate = true;


            var material = new THREE.SpriteMaterial({ map: texture, depthWrite: false });
            var textObj = new THREE.Sprite(material);
            textObj.scale.set(0.5, 0.5, 0.5);


            //textObj.position.set(pos1);

            var posdir = Pnt_copy(pos);

            posdir.normalize();

            textObj.position.x = pos.x + 0.05 * posdir.x; //* (fontGeometry.boundingBox.max.x - fontGeometry.boundingBox.min.x);
            textObj.position.y = pos.y + 0.05 * posdir.y;
            textObj.position.z = pos.z + 0.1 * posdir.z;


            return textObj;
        }

        function create_trial_Text_Normal2(text, pos) {

            var canvas = document.createElement("canvas");
            canvas.width = 270;
            canvas.height = 270;
            var ctx = canvas.getContext("2d");
            ctx.fillStyle = "black";
            ctx.font = "Bold 80px Palatino";
            ctx.lineWidth = 2;
            ctx.fillText(text.charAt(0), 150, 150);
            ctx.fillStyle = "black";
            ctx.font = "50px Palatino";
            ctx.lineWidth = 2;
            ctx.fillText(text.charAt(1), 190, 170);
            ctx.fillStyle = "black";
            ctx.font = "50px Palatino";
            ctx.lineWidth = 2;
            ctx.fillText(text.charAt(2), 210, 170);
            ctx.fillStyle = "black";
            ctx.font = "50px Palatino";
            ctx.lineWidth = 2;
            ctx.fillText(text.charAt(3), 235, 170);
            ctx.fillStyle = "black";
            ctx.font = "50px Palatino";
            ctx.lineWidth = 2;
            ctx.fillText(text.charAt(4), 260, 170);

            var texture = new THREE.Texture(canvas);
            texture.needsUpdate = true;


            var material = new THREE.SpriteMaterial({ map: texture, depthWrite: false });
            var textObj = new THREE.Sprite(material);
            textObj.scale.set(0.5, 0.5, 0.5);


            //textObj.position.set(pos1);

            var posdir = Pnt_copy(pos);

            posdir.normalize();

            textObj.position.x = pos.x + 0.05 * posdir.x; //* (fontGeometry.boundingBox.max.x - fontGeometry.boundingBox.min.x);
            textObj.position.y = pos.y + 0.05 * posdir.y;
            textObj.position.z = pos.z + 0.1 * posdir.z;


            return textObj;
        }

        function create_trial_Text_Normal_2d(text, pos) {

            var canvas = document.createElement("canvas");
            canvas.width = 240;
            canvas.height = 240;
            var ctx = canvas.getContext("2d");
            ctx.fillStyle = "black";
            ctx.font = "Bold 80px Palatino";
            ctx.lineWidth = 2;
            ctx.fillText(text.charAt(0), 150, 150);
            ctx.fillStyle = "black";
            ctx.font = "50px Palatino";
            ctx.lineWidth = 2;
            ctx.fillText(text.charAt(1), 190, 170);
            ctx.fillStyle = "black";
            ctx.font = "50px Palatino";
            ctx.lineWidth = 2;
            ctx.fillText(text.charAt(2), 210, 170);
            ctx.fillStyle = "black";
            ctx.font = "50px Palatino";
            ctx.lineWidth = 2;
            ctx.fillText(text.charAt(3), 230, 170);

            var texture = new THREE.Texture(canvas);
            texture.needsUpdate = true;


            var material = new THREE.SpriteMaterial({ map: texture, depthWrite: false });
            var textObj = new THREE.Sprite(material);
            textObj.scale.set(0.5, 0.5, 0.5);


            //textObj.position.set(pos1);

            var posdir = Pnt_copy(pos);

            posdir.normalize();

            textObj.position.x = pos.x //* (fontGeometry.boundingBox.max.x - fontGeometry.boundingBox.min.x);
            textObj.position.y = pos.y
            textObj.position.z = pos.z + 0.1;


            return textObj;
        }

        function create_force_cell_apply(point1, point2, point3, point4, scale) {

            var centroid = new THREE.Vector3((point1.x + point2.x + point3.x + point4.x) / 4, (point1.y + point2.y + point3.y + point4.y) / 4, (point1.z + point2.z + point3.z + point4.z) / 4);


            var scale_point1 = new THREE.Vector3(centroid.x + (point1.x - centroid.x) * scale, centroid.y + (point1.y - centroid.y) * scale, centroid.z + (point1.z - centroid.z) * scale);


            var scale_point2 = new THREE.Vector3(centroid.x + (point2.x - centroid.x) * scale, centroid.y + (point2.y - centroid.y) * scale, centroid.z + (point2.z - centroid.z) * scale);


            var scale_point3 = new THREE.Vector3(centroid.x + (point3.x - centroid.x) * scale, centroid.y + (point3.y - centroid.y) * scale, centroid.z + (point3.z - centroid.z) * scale);


            var scale_point4 = new THREE.Vector3(centroid.x + (point4.x - centroid.x) * scale, centroid.y + (point4.y - centroid.y) * scale, centroid.z + (point4.z - centroid.z) * scale);

            var vertices = [
                scale_point1, scale_point2, scale_point3
            ];

            var faces = [
                new THREE.Face3(0, 1, 2),

            ];

            var geom = new THREE.Geometry();
            geom.vertices = vertices;
            geom.faces = faces;
            geom.computeFaceNormals();
            var material_step_1 = [
                //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                new THREE.MeshPhongMaterial({
                    color: 0x009600, side: THREE.DoubleSide
                })
            ];

            var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);


            force_cell.add(force_cell2)
            force_cell2.children[0].castShadow = true;
        }

        function create_force_cell_face1(face_area, face_area_max, point1, point2, point3, point4, scale) {
            var form_mesh = face_area / face_area_max

            var centroid = new THREE.Vector3((point1.x + point2.x + point3.x + point4.x) / 4, (point1.y + point2.y + point3.y + point4.y) / 4, (point1.z + point2.z + point3.z + point4.z) / 4);


            var scale_point1 = new THREE.Vector3(centroid.x + (point1.x - centroid.x) * scale, centroid.y + (point1.y - centroid.y) * scale, centroid.z + (point1.z - centroid.z) * scale);


            var scale_point2 = new THREE.Vector3(centroid.x + (point2.x - centroid.x) * scale, centroid.y + (point2.y - centroid.y) * scale, centroid.z + (point2.z - centroid.z) * scale);


            var scale_point3 = new THREE.Vector3(centroid.x + (point3.x - centroid.x) * scale, centroid.y + (point3.y - centroid.y) * scale, centroid.z + (point3.z - centroid.z) * scale);


            var scale_point4 = new THREE.Vector3(centroid.x + (point4.x - centroid.x) * scale, centroid.y + (point4.y - centroid.y) * scale, centroid.z + (point4.z - centroid.z) * scale);

            var vertices = [
                scale_point1, scale_point2, scale_point4
            ];

            var faces = [
                new THREE.Face3(0, 1, 2),

            ];

            var geom = new THREE.Geometry();
            geom.vertices = vertices;
            geom.faces = faces;
            geom.computeFaceNormals();

            if (ForceO1.z <= ForceP_B.z) {

                if (form_mesh < 0.25 & form_mesh >= 0) {
                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0x5B84AE, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }

                if (form_mesh < 0.5 & form_mesh >= 0.25) {

                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0x376D9B, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }

                if (form_mesh < 0.75 & form_mesh >= 0.5) {
                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0x05416D, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }

                if (form_mesh >= 0.75) {

                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0x0F3150, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }
            }

            else if (ForceO1.z > ForceP_B.z) {

                if (form_mesh < 0.25 & form_mesh >= 0) {
                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0xD72F62, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }

                if (form_mesh < 0.5 & form_mesh >= 0.25) {
                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0xCC0549, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }

                if (form_mesh < 0.75 & form_mesh >= 0.5) {
                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0x940041, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }

                if (form_mesh >= 0.75) {
                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0x80002F, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }
            }

            force_cell.add(force_cell2)
            force_cell2.children[0].castShadow = true;

        }
        function create_force_cell_face1m(face_area, face_area_max, point1, point2, point3, point4, scale) {
            var form_mesh = face_area / face_area_max

            var centroid = new THREE.Vector3((point1.x + point2.x + point3.x + point4.x) / 4, (point1.y + point2.y + point3.y + point4.y) / 4, (point1.z + point2.z + point3.z + point4.z) / 4);


            var scale_point1 = new THREE.Vector3(centroid.x + (point1.x - centroid.x) * scale, centroid.y + (point1.y - centroid.y) * scale, centroid.z + (point1.z - centroid.z) * scale);


            var scale_point2 = new THREE.Vector3(centroid.x + (point2.x - centroid.x) * scale, centroid.y + (point2.y - centroid.y) * scale, centroid.z + (point2.z - centroid.z) * scale);


            var scale_point3 = new THREE.Vector3(centroid.x + (point3.x - centroid.x) * scale, centroid.y + (point3.y - centroid.y) * scale, centroid.z + (point3.z - centroid.z) * scale);


            var scale_point4 = new THREE.Vector3(centroid.x + (point4.x - centroid.x) * scale, centroid.y + (point4.y - centroid.y) * scale, centroid.z + (point4.z - centroid.z) * scale);

            var vertices = [
                scale_point1, scale_point2, scale_point4
            ];

            var faces = [
                new THREE.Face3(0, 1, 2),

            ];

            var geom = new THREE.Geometry();
            geom.vertices = vertices;
            geom.faces = faces;
            geom.computeFaceNormals();

            if (dis3a >= dis3b) {

                if (form_mesh < 0.25 & form_mesh >= 0) {
                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0x5B84AE, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }

                if (form_mesh < 0.5 & form_mesh >= 0.25) {

                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0x376D9B, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }

                if (form_mesh < 0.75 & form_mesh >= 0.5) {
                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0x05416D, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }

                if (form_mesh >= 0.75) {

                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0x0F3150, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }
            }

            else if (dis3a < dis3b) {

                if (form_mesh < 0.25 & form_mesh >= 0) {
                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0xD72F62, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }

                if (form_mesh < 0.5 & form_mesh >= 0.25) {
                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0xCC0549, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }

                if (form_mesh < 0.75 & form_mesh >= 0.5) {
                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0x940041, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }

                if (form_mesh >= 0.75) {
                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0x80002F, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }
            }

            force_cell.add(force_cell2)
            force_cell2.children[0].castShadow = true;

        }

        function create_force_cell_face2(face_area, face_area_max, point1, point2, point3, point4, scale) {
            var form_mesh = face_area / face_area_max

            var centroid = new THREE.Vector3((point1.x + point2.x + point3.x + point4.x) / 4, (point1.y + point2.y + point3.y + point4.y) / 4, (point1.z + point2.z + point3.z + point4.z) / 4);


            var scale_point1 = new THREE.Vector3(centroid.x + (point1.x - centroid.x) * scale, centroid.y + (point1.y - centroid.y) * scale, centroid.z + (point1.z - centroid.z) * scale);


            var scale_point2 = new THREE.Vector3(centroid.x + (point2.x - centroid.x) * scale, centroid.y + (point2.y - centroid.y) * scale, centroid.z + (point2.z - centroid.z) * scale);


            var scale_point3 = new THREE.Vector3(centroid.x + (point3.x - centroid.x) * scale, centroid.y + (point3.y - centroid.y) * scale, centroid.z + (point3.z - centroid.z) * scale);


            var scale_point4 = new THREE.Vector3(centroid.x + (point4.x - centroid.x) * scale, centroid.y + (point4.y - centroid.y) * scale, centroid.z + (point4.z - centroid.z) * scale);

            var vertices = [
                scale_point1, scale_point2, scale_point4
            ];

            var faces = [
                new THREE.Face3(0, 1, 2),

            ];

            var geom = new THREE.Geometry();
            geom.vertices = vertices;
            geom.faces = faces;
            geom.computeFaceNormals();

            if (ForceO2.z <= ForceP_B.z) {

                if (form_mesh < 0.25 & form_mesh >= 0) {
                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0x5B84AE, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }

                if (form_mesh < 0.5 & form_mesh >= 0.25) {

                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0x376D9B, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }

                if (form_mesh < 0.75 & form_mesh >= 0.5) {
                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0x05416D, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }

                if (form_mesh >= 0.75) {

                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0x0F3150, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }
            }

            else if (ForceO2.z > ForceP_B.z) {

                if (form_mesh < 0.25 & form_mesh >= 0) {
                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0xD72F62, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }

                if (form_mesh < 0.5 & form_mesh >= 0.25) {
                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0xCC0549, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }

                if (form_mesh < 0.75 & form_mesh >= 0.5) {
                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0x940041, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }

                if (form_mesh >= 0.75) {
                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0x80002F, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }
            }

            force_cell.add(force_cell2)
            force_cell2.children[0].castShadow = true;

        }
        function create_force_cell_face2m(face_area, face_area_max, point1, point2, point3, point4, scale) {
            var form_mesh = face_area / face_area_max

            var centroid = new THREE.Vector3((point1.x + point2.x + point3.x + point4.x) / 4, (point1.y + point2.y + point3.y + point4.y) / 4, (point1.z + point2.z + point3.z + point4.z) / 4);


            var scale_point1 = new THREE.Vector3(centroid.x + (point1.x - centroid.x) * scale, centroid.y + (point1.y - centroid.y) * scale, centroid.z + (point1.z - centroid.z) * scale);


            var scale_point2 = new THREE.Vector3(centroid.x + (point2.x - centroid.x) * scale, centroid.y + (point2.y - centroid.y) * scale, centroid.z + (point2.z - centroid.z) * scale);


            var scale_point3 = new THREE.Vector3(centroid.x + (point3.x - centroid.x) * scale, centroid.y + (point3.y - centroid.y) * scale, centroid.z + (point3.z - centroid.z) * scale);


            var scale_point4 = new THREE.Vector3(centroid.x + (point4.x - centroid.x) * scale, centroid.y + (point4.y - centroid.y) * scale, centroid.z + (point4.z - centroid.z) * scale);

            var vertices = [
                scale_point1, scale_point2, scale_point4
            ];

            var faces = [
                new THREE.Face3(0, 1, 2),

            ];

            var geom = new THREE.Geometry();
            geom.vertices = vertices;
            geom.faces = faces;
            geom.computeFaceNormals();

            if (dis4a >= dis4b) {

                if (form_mesh < 0.25 & form_mesh >= 0) {
                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0x5B84AE, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }

                if (form_mesh < 0.5 & form_mesh >= 0.25) {

                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0x376D9B, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }

                if (form_mesh < 0.75 & form_mesh >= 0.5) {
                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0x05416D, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }

                if (form_mesh >= 0.75) {

                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0x0F3150, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }
            }

            else if (dis4a < dis4b) {

                if (form_mesh < 0.25 & form_mesh >= 0) {
                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0xD72F62, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }

                if (form_mesh < 0.5 & form_mesh >= 0.25) {
                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0xCC0549, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }

                if (form_mesh < 0.75 & form_mesh >= 0.5) {
                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0x940041, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }

                if (form_mesh >= 0.75) {
                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0x80002F, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }
            }

            force_cell.add(force_cell2)
            force_cell2.children[0].castShadow = true;

        }

        function create_force_cell_facem1(face_area, face_area_max, point1, point2, point3, point4, scale) {
            var form_mesh = face_area / face_area_max

            var centroid = new THREE.Vector3((point1.x + point2.x + point3.x + point4.x) / 4, (point1.y + point2.y + point3.y + point4.y) / 4, (point1.z + point2.z + point3.z + point4.z) / 4);


            var scale_point1 = new THREE.Vector3(centroid.x + (point1.x - centroid.x) * scale, centroid.y + (point1.y - centroid.y) * scale, centroid.z + (point1.z - centroid.z) * scale);


            var scale_point2 = new THREE.Vector3(centroid.x + (point2.x - centroid.x) * scale, centroid.y + (point2.y - centroid.y) * scale, centroid.z + (point2.z - centroid.z) * scale);


            var scale_point3 = new THREE.Vector3(centroid.x + (point3.x - centroid.x) * scale, centroid.y + (point3.y - centroid.y) * scale, centroid.z + (point3.z - centroid.z) * scale);


            var scale_point4 = new THREE.Vector3(centroid.x + (point4.x - centroid.x) * scale, centroid.y + (point4.y - centroid.y) * scale, centroid.z + (point4.z - centroid.z) * scale);

            var vertices = [
                scale_point1, scale_point2, scale_point4
            ];

            var faces = [
                new THREE.Face3(0, 1, 2),

            ];

            var geom = new THREE.Geometry();
            geom.vertices = vertices;
            geom.faces = faces;
            geom.computeFaceNormals();

            if (dis1a >= dis1b) {

                if (form_mesh < 0.25 & form_mesh >= 0) {
                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0x5B84AE, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }

                if (form_mesh < 0.5 & form_mesh >= 0.25) {

                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0x376D9B, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }

                if (form_mesh < 0.75 & form_mesh >= 0.5) {
                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0x05416D, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }

                if (form_mesh >= 0.75) {

                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0x0F3150, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }
            }

            else if (dis1a < dis1b) {

                if (form_mesh < 0.25 & form_mesh >= 0) {
                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0xD72F62, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }

                if (form_mesh < 0.5 & form_mesh >= 0.25) {
                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0xCC0549, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }

                if (form_mesh < 0.75 & form_mesh >= 0.5) {
                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0x940041, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }

                if (form_mesh >= 0.75) {
                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0x80002F, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }
            }

            force_cell.add(force_cell2)
            force_cell2.children[0].castShadow = true;

        }

        function create_force_cell_facem2(face_area, face_area_max, point1, point2, point3, point4, scale) {
            var form_mesh = face_area / face_area_max

            var centroid = new THREE.Vector3((point1.x + point2.x + point3.x + point4.x) / 4, (point1.y + point2.y + point3.y + point4.y) / 4, (point1.z + point2.z + point3.z + point4.z) / 4);


            var scale_point1 = new THREE.Vector3(centroid.x + (point1.x - centroid.x) * scale, centroid.y + (point1.y - centroid.y) * scale, centroid.z + (point1.z - centroid.z) * scale);


            var scale_point2 = new THREE.Vector3(centroid.x + (point2.x - centroid.x) * scale, centroid.y + (point2.y - centroid.y) * scale, centroid.z + (point2.z - centroid.z) * scale);


            var scale_point3 = new THREE.Vector3(centroid.x + (point3.x - centroid.x) * scale, centroid.y + (point3.y - centroid.y) * scale, centroid.z + (point3.z - centroid.z) * scale);


            var scale_point4 = new THREE.Vector3(centroid.x + (point4.x - centroid.x) * scale, centroid.y + (point4.y - centroid.y) * scale, centroid.z + (point4.z - centroid.z) * scale);

            var vertices = [
                scale_point1, scale_point2, scale_point4
            ];

            var faces = [
                new THREE.Face3(0, 1, 2),

            ];

            var geom = new THREE.Geometry();
            geom.vertices = vertices;
            geom.faces = faces;
            geom.computeFaceNormals();

            if (dis2a >= dis2b) {

                if (form_mesh < 0.25 & form_mesh >= 0) {
                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0x5B84AE, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }

                if (form_mesh < 0.5 & form_mesh >= 0.25) {

                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0x376D9B, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }

                if (form_mesh < 0.75 & form_mesh >= 0.5) {
                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0x05416D, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }

                if (form_mesh >= 0.75) {

                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0x0F3150, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }
            }

            else if (dis2a < dis2b) {

                if (form_mesh < 0.25 & form_mesh >= 0) {
                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0xD72F62, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }

                if (form_mesh < 0.5 & form_mesh >= 0.25) {
                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0xCC0549, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }

                if (form_mesh < 0.75 & form_mesh >= 0.5) {
                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0x940041, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }

                if (form_mesh >= 0.75) {
                    var material_step_1 = [
                        //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
                        new THREE.MeshBasicMaterial({ color: "white", wireframe: true, transparent: true, opacity: 0.1 }),
                        new THREE.MeshPhongMaterial({
                            color: 0x80002F, side: THREE.DoubleSide
                        })
                    ];
                    var force_cell2 = THREE.SceneUtils.createMultiMaterialObject(geom, material_step_1);
                }
            }

            force_cell.add(force_cell2)
            force_cell2.children[0].castShadow = true;

        }









        // ************************************************** end ********************************************************************************





        scene.add(form_group);
        scene.add(form_group_mink)
        scene.add(form_group_faces);
        scene.add(form_group_forces);
        scene.add(form_group_forces2);
        
        scene2.add(force_group_test);
        sceneOrtho2.add(form_sigima_1);
        sceneOrtho2.add(form_sigima_2);
        sceneOrtho1.add(force_gamma_1);
        sceneOrtho1.add(force_gamma_2);





    }




    var Force_face_dir = [];
    var Change_BC = false;

    function Cal_ForcesPnt() {


        var origin_N1 = Pnt_copy(TubePoints1[1]);
        var origin_N2 = Pnt_copy(TubePoints2[1]);
        var origin_N3 = Pnt_copy(TubePoints3[1]);
        var origin_N4 = Pnt_copy(TubePoints4[1]);

        origin_N1.multiplyScalar(-1);
        origin_N2.multiplyScalar(-1);
        origin_N3.multiplyScalar(-1);
        origin_N4.multiplyScalar(-1);

        var aa = new Array();
        aa = Cal_Arrange_AA(origin_N1, origin_N2, origin_N3, origin_N4);

        console.log("aa0", aa[0], "aa1", aa[1], "aa2", aa[2]);

        origin_N1.normalize();

        var L_AB = new THREE.Vector3(0, 0, 0);
        L_AB = cross(origin_N1, aa[0]);

        P_A = new THREE.Vector3(0, 0, 0);
        //m=Math.sqrt()
        var m = Math.sqrt(L * L / Math.pow(norm(L_AB), 2));

        P_B = new THREE.Vector3((P_A.x + m * L_AB.x), (P_A.y + m * L_AB.y), (P_A.z + m * L_AB.z));

        var L_BC = new THREE.Vector3(0, 0, 0);
        var L_CA = new THREE.Vector3(0, 0, 0);

        L_BC = cross(origin_N1, aa[1]);
        L_CA = cross(origin_N1, aa[2]);

        P_C = new THREE.Vector3(0, 0, 0);
        P_C = LinesSectPt(L_BC, P_B, L_CA, P_A);


        var L_BD = new THREE.Vector3(0, 0, 0);
        var L_DC = new THREE.Vector3(0, 0, 0);

        L_BD = cross(aa[1], aa[0]);
        L_DC = cross(aa[1], aa[2]);

        P_D = new THREE.Vector3(0, 0, 0);

        P_D = LinesSectPt(L_BD, P_B, L_DC, P_C);

        console.log("P_ABCD", P_A, P_B, P_C, P_D);



        //




        //console.log("P_D_",P_D);




        Change_BC = false;

        var F1 = cross(P_B, P_C);

        if (F1.z > 0) {
            var temp = Pnt_copy(P_B);
            P_B = Pnt_copy(P_C);
            P_C = Pnt_copy(temp);
            Change_BC = true;
        }


        var P_BA = new THREE.Vector3().subVectors(P_B, P_A);
        var P_CB = new THREE.Vector3().subVectors(P_C, P_B);

        var P_CA = new THREE.Vector3().subVectors(P_C, P_A);
        var P_DC = new THREE.Vector3().subVectors(P_D, P_C);

        var P_DA = new THREE.Vector3().subVectors(P_D, P_A);
        var P_BD = new THREE.Vector3().subVectors(P_B, P_D);

        var P_DB = new THREE.Vector3().subVectors(P_D, P_B);
        var P_CD = new THREE.Vector3().subVectors(P_C, P_D);

        F1 = cross(P_BA, P_CB);
        var F2 = cross(P_CA, P_DC);
        var F3 = cross(P_DA, P_BD);
        var F4 = cross(P_DB, P_CD);

        Force_face_dir = [];

        Force_face_dir.push(F1);
        Force_face_dir.push(F2);
        Force_face_dir.push(F3);
        Force_face_dir.push(F4);






    }


    function Force_move() {

        var P_A_temp = new THREE.Vector3(0, 0, 0);

        P_A_temp = Pnt_copy(P_A);

        P_A = subVec(P_A, P_A_temp);
        P_B = subVec(P_B, P_A_temp);
        P_C = subVec(P_C, P_A_temp);
        P_D = subVec(P_D, P_A_temp);



        var corePoint = new THREE.Vector3();
        corePoint.x = (P_A.x + P_B.x + P_C.x + P_D.x) / 4;
        corePoint.y = (P_A.y + P_B.y + P_C.y + P_D.y) / 4;
        corePoint.z = (P_A.z + P_B.z + P_C.z + P_D.z) / 4;


        if (corePoint_temp.x === 0 && corePoint_temp.y === 0 && corePoint_temp.z === 0) {
            corePoint_temp = Pnt_copy(corePoint);
        };



        P_A = subVec(P_A, corePoint_temp);
        P_B = subVec(P_B, corePoint_temp);
        P_C = subVec(P_C, corePoint_temp);
        P_D = subVec(P_D, corePoint_temp);

    }



    function Force_move_left() {

        var P_A_temp = new THREE.Vector3(0, 0, 0);

        P_A_temp = Pnt_copy(P_A);

        P_A = subVec(P_A, P_A_temp);
        P_B = subVec(P_B, P_A_temp);
        P_C = subVec(P_C, P_A_temp);
        P_D = subVec(P_D, P_A_temp);


        var corePoint = new THREE.Vector3();
        corePoint.x = (P_A.x + P_B.x + P_C.x + P_D.x) / 4;
        corePoint.y = (P_A.y + P_B.y + P_C.y + P_D.y) / 4;
        corePoint.z = (P_A.z + P_B.z + P_C.z + P_D.z) / 4;


        P_A = subVec(P_A, corePoint);
        P_B = subVec(P_B, corePoint);
        P_C = subVec(P_C, corePoint);
        P_D = subVec(P_D, corePoint);

    }


    function subVec(n1, n2) {
        var sub = new THREE.Vector3(0, 0, 0);
        sub.x = n1.x - n2.x;
        sub.y = n1.y - n2.y;
        sub.z = n1.z - n2.z;
        return sub;
    }


    function cross(n1, n2) {
        var ncross = new THREE.Vector3(0, 0, 0);
        ncross.x = ((n1.y * n2.z) - (n1.z * n2.y));
        ncross.y = ((n1.z * n2.x) - (n1.x * n2.z));
        ncross.z = ((n1.x * n2.y) - (n1.y * n2.x));
        return ncross;

    }

    function norm(n1) {
        var nnorm = Math.sqrt(n1.x * n1.x + n1.y * n1.y + n1.z * n1.z);
        return nnorm;
    }

    function distance(n1, n2) {
        var distance1 = Math.sqrt((n1.x - n2.x) * (n1.x - n2.x) + (n1.y - n2.y) * (n1.y - n2.y) + (n1.z - n2.z) * (n1.z - n2.z));
        return distance1;
    }

    function face_center(n1, n2, n3) {

        var face_centerD = new THREE.Vector3();

        face_centerD.x = (n1.x + n2.x + n3.x) / 3;
        face_centerD.y = (n1.y + n2.y + n3.y) / 3;
        face_centerD.z = (n1.z + n2.z + n3.z) / 3;

        return face_centerD;



    }


    function create_Tri_FaceMesh(p1, p2, p3, arr_face_dir, Is_First, arr_dir, text) {

        var corepoint = face_center(p1, p2, p3);
        var m = 0.2;//scale

        //move point
        var dirA = new THREE.Vector3().subVectors(corepoint, p1);
        var dirB = new THREE.Vector3().subVectors(corepoint, p2);
        var dirC = new THREE.Vector3().subVectors(corepoint, p3);

        dirA.normalize();
        dirB.normalize();
        dirC.normalize();

        // var unit_dir1=new THREE.Vector3();//normal
        // unit_dir1.x=dirA.x/norm(dirA);
        // unit_dir1.y=dirA.y/norm(dirA);
        // unit_dir1.z=dirA.z/norm(dirA);

        // var unit_dir2=new THREE.Vector3();//normal
        // unit_dir2.x=dirB.x/norm(dirB);
        // unit_dir2.y=dirB.y/norm(dirB);
        // unit_dir2.z=dirB.z/norm(dirB);

        // var unit_dir3=new THREE.Vector3();//normal
        // unit_dir3.x=dirC.x/norm(dirC);
        // unit_dir3.y=dirC.y/norm(dirC);
        // unit_dir3.z=dirC.z/norm(dirC);


        //move point

        var p1_1 = new THREE.Vector3();
        // p1_1=subVec(p1,m*unit_dir1);
        p1_1.x = p1.x + m * dirA.x;
        p1_1.y = p1.y + m * dirA.y;
        p1_1.z = p1.z + m * dirA.z;

        var p2_1 = new THREE.Vector3();
        p2_1.x = p2.x + m * dirB.x;
        p2_1.y = p2.y + m * dirB.y;
        p2_1.z = p2.z + m * dirB.z;

        var p3_1 = new THREE.Vector3();
        p3_1.x = p3.x + m * dirC.x;
        p3_1.y = p3.y + m * dirC.y;
        p3_1.z = p3.z + m * dirC.z;



        var vertices_tri = [
            p1_1, p2_1, p3_1
        ];

        var faces_tri = [
            new THREE.Face3(2, 1, 0),

        ];


        var geom_tri = new THREE.Geometry();
        geom_tri.vertices = vertices_tri;
        geom_tri.faces = faces_tri;
        geom_tri.computeFaceNormals();


        for (i = 0; i < geom_tri.faces.length; i++) {
            if (Is_First) {
                var hex = 0x008000;
                geom_tri.faces[i].color.setHex(hex);
            }
            else {
                var hex = 0xa9a9a9;
                geom_tri.faces[i].color.setHex(hex);
            }

        }

        //  var materials = new THREE.MeshBasicMaterial( {
        // vertexColors: THREE.FaceColors
        // } );

        var materials_tri = [
            //new THREE.MeshLambertMaterial({color: 0x4d4dff, transparent: true}),
            // new THREE.MeshBasicMaterial({color: 0x4d4dff, wireframe: true,transparent: true,opacity:0.05}),
            new THREE.MeshBasicMaterial({
                vertexColors: THREE.FaceColors, transparent: true, opacity: 0.2, side: THREE.DoubleSide
            })
        ];

        var mesh_tri = new THREE.SceneUtils.createMultiMaterialObject(geom_tri, materials_tri);

        // return mesh_tri;

        //arrowHelper1.add(mesh_tri)

        //var arrowHelper1;


        //var length = 1;
        // var hex = 0x000000;//black
        if (Is_First)

            var arr_face_material = new THREE.MeshPhongMaterial({
                color: 0x009600//force face green
            });
        else
            var arr_face_material = new THREE.MeshPhongMaterial({
                color: 0x000000//force face black
            });

        var arr_material2;

        if (arr_dir < 0)//c or t
        {
            arrow_material2 = new THREE.MeshPhongMaterial({
                color: 0xC00000//red
            });

        }
        else {
            arrow_material2 = new THREE.MeshPhongMaterial({

                color: 0x0F3150//blue
            });

        }


        //in or out

        var forceFaceDir = Pnt_copy(arr_face_dir);
        forceFaceDir.normalize();

        //in or out
        var out1 = new THREE.Vector3();
        out1.x = corepoint.x + 0.2 * forceFaceDir.x;
        out1.y = corepoint.y + 0.2 * forceFaceDir.y;
        out1.z = corepoint.z + 0.2 * forceFaceDir.z;


        var out2 = new THREE.Vector3();
        out2.x = corepoint.x - 0.2 * forceFaceDir.x;
        out2.y = corepoint.y - 0.2 * forceFaceDir.y;
        out2.z = corepoint.z - 0.2 * forceFaceDir.z;

        var out1_core = new THREE.Vector3().subVectors(out1, corePoint_body2);
        var out2_core = new THREE.Vector3().subVectors(out2, corePoint_body2);

        if (out1_core.length() > out2_core.length())//out
        {


            var arrowHP1 = createCylinderArrowMesh(p3_1, p1_1, arr_face_material, 0.01, 0.03, 0.9);//face arr

            // var direction1 = new THREE.Vector3().subVectors(p1_1, p3_1);
            // var length1=direction1.length();
            // direction1.normalize();
            // var arrowHelper1 = new THREE.ArrowHelper(direction1, p3_1, length1,hex,0.2,0.05);
            mesh_tri.add(arrowHP1);

            // var direction2 = new THREE.Vector3().subVectors(p3_1, p2_1);
            // var length2=direction2.length();
            // direction2.normalize();
            // var arrowHelper2 = new THREE.ArrowHelper(direction2, p2_1, length2,hex,0.2,0.05);
            var arrowHP2 = createCylinderArrowMesh(p2_1, p3_1, arr_face_material, 0.01, 0.03, 0.9);//face arr
            mesh_tri.add(arrowHP2);

            // var direction3 = new THREE.Vector3().subVectors(p2_1, p1_1);
            // var length3=direction3.length();
            // direction3.normalize();
            // var arrowHelper3 = new THREE.ArrowHelper(direction3, p1_1, length3,hex,0.2,0.05);
            var arrowHP3 = createCylinderArrowMesh(p1_1, p2_1, arr_face_material, 0.01, 0.03, 0.9);//face arr
            mesh_tri.add(arrowHP3);

            //draw normal

            var corepoint2 = new THREE.Vector3();
            corepoint2.x = corepoint.x + 0.4 * forceFaceDir.x;
            corepoint2.y = corepoint.y + 0.4 * forceFaceDir.y;
            corepoint2.z = corepoint.z + 0.4 * forceFaceDir.z;

            var corepoint3 = new THREE.Vector3();
            corepoint3.x = corepoint.x + 0.37 * forceFaceDir.x;
            corepoint3.y = corepoint.y + 0.37 * forceFaceDir.y;
            corepoint3.z = corepoint.z + 0.37 * forceFaceDir.z;



            //=new THREE.ArrowHelper(forceFaceDir,corepoint,0.5*forceFaceDir.length(),0x00ff00,0.2,0.1);
            if (Is_First)//color diff
            {
                var arrow_material1 = new THREE.MeshPhongMaterial({
                    color: 0x009600
                });
                var arrowN = createCylinderArrowMesh(corepoint, corepoint2, arrow_material1, 0.02, 0.05, 0.6);
                //
            }
            else
                var arrowN = createCylinderArrowMesh(corepoint, corepoint2, arrow_material2, 0.02, 0.05, 0.6);


            mesh_tri.add(arrowN);

            if (Is_First)//color diff
            {
                var arrow_material_outline = new THREE.MeshBasicMaterial({ color: "white", transparent: false, side: THREE.BackSide });
                var arrowN_O = createCylinderArrowMesh(corepoint, corepoint3, arrow_material_outline, 0.025, 0.05, 0.55);
                //
            }
            else
                var arrow_material_outline = new THREE.MeshBasicMaterial({ color: "white", transparent: false, side: THREE.BackSide });
            var arrowN_O = createCylinderArrowMesh(corepoint, corepoint3, arrow_material_outline, 0.025, 0.05, 0.55);



            mesh_tri.add(arrowN_O);
            arrowN_O.scale.multiplyScalar(1.2);

            var TXMesh = createSpriteText(text, corepoint2);

            text_group2.add(TXMesh);

            //face arr

            var cir_dir = new THREE.Vector3().subVectors(corepoint, p1);
            cir_dir.normalize();

            var arrowpt = new THREE.Vector3();
            arrowpt.x = corepoint.x + 0.2 * cir_dir.x;
            arrowpt.y = corepoint.y + 0.2 * cir_dir.y;
            arrowpt.z = corepoint.z + 0.2 * cir_dir.z;

            //arr_dir.normalize();

            var direction1 = cir_dir.applyAxisAngle(forceFaceDir, Math.PI / 2);

            //var direction1 = new THREE.Vector3().subVectors(p1, p2);
            var length1 = 0.001;
            direction1.normalize();
            var arrowHelper1 = new THREE.ArrowHelper(direction1, arrowpt, length1, "black", 0.1, 0.05);

            //        mesh_tri.add(arrowHelper1);


            //cir arr

            var circle_mesh = createCircleFaceArrow(corepoint, 0.1, forceFaceDir);
            mesh_tri.add(circle_mesh);

            //var step_1=createCircleFaceArrow2(TubePoints1[1],0.2,forceFaceDir);
            // Tube_group.add(step_1);


        }
        else {

            // var direction1 = new THREE.Vector3().subVectors(p2_1, p1_1);
            // var length1=direction1.length();
            // direction1.normalize();
            // var arrowHelper1 = new THREE.ArrowHelper(direction1, p1_1, length1,hex,0.1,0.05);
            var arrowHP1 = createCylinderArrowMesh(p1_1, p2_1, arr_face_material, 0.01, 0.03, 0.9);//face arr
            mesh_tri.add(arrowHP1);

            // var direction2 = new THREE.Vector3().subVectors(p3_1, p2_1);
            // var length2=direction2.length();
            // direction2.normalize();
            // var arrowHelper2 = new THREE.ArrowHelper(direction2, p2_1, length2,hex,0.1,0.05);
            var arrowHP2 = createCylinderArrowMesh(p2_1, p3_1, arr_face_material, 0.01, 0.03, 0.9);//face arr
            mesh_tri.add(arrowHP2);



            // var direction3 = new THREE.Vector3().subVectors(p1_1, p3_1);
            // var length3=direction3.length();
            // direction3.normalize();
            // var arrowHelper3 = new THREE.ArrowHelper(direction3, p3_1, length3,hex,0.1,0.05);
            var arrowHP3 = createCylinderArrowMesh(p3_1, p1_1, arr_face_material, 0.01, 0.03, 0.9);//face arr
            mesh_tri.add(arrowHP3);



            var corepoint2 = new THREE.Vector3();
            corepoint2.x = corepoint.x - 0.4 * forceFaceDir.x;
            corepoint2.y = corepoint.y - 0.4 * forceFaceDir.y;
            corepoint2.z = corepoint.z - 0.4 * forceFaceDir.z;

            var corepoint3 = new THREE.Vector3();
            corepoint3.x = corepoint.x - 0.37 * forceFaceDir.x;
            corepoint3.y = corepoint.y - 0.37 * forceFaceDir.y;
            corepoint3.z = corepoint.z - 0.37 * forceFaceDir.z;

            if (Is_First)//color diff
            {
                var arrow_material1 = new THREE.MeshPhongMaterial({
                    color: 0x009600
                });
                //var arrowN=createCylinderArrowMesh(corepoint,corepoint2,arrow_material1,0.02,0.05,0.7);
                var arrowN = createCylinderArrowMesh(corepoint2, corepoint, arrow_material1, 0.02, 0.05, 0.6);

            }
            else
                var arrowN = createCylinderArrowMesh(corepoint2, corepoint, arrow_material2, 0.02, 0.05, 0.6);


            //=new THREE.ArrowHelper(forceFaceDir,corepoint,0.5*forceFaceDir.length(),0x00ff00,0.2,0.1);



            //draw normal

            //var dirN=cross(direction2,direction1);

            //dirN.normalize();


            //var arrowN=new THREE.ArrowHelper(forceFaceDir,corepoint,0.5*forceFaceDir.length(),0x00ff00,0.2,0.1);
            mesh_tri.add(arrowN);

            if (Is_First)//color diff
            {
                var arrow_material_outline = new THREE.MeshBasicMaterial({ color: "white", transparent: false, side: THREE.BackSide });
                var arrowN_O = createCylinderArrowMesh(corepoint3, corepoint, arrow_material_outline, 0.025, 0.05, 0.55);
                //
            }
            else
                var arrow_material_outline = new THREE.MeshBasicMaterial({ color: "white", transparent: false, side: THREE.BackSide });
            var arrowN_O = createCylinderArrowMesh(corepoint3, corepoint, arrow_material_outline, 0.025, 0.05, 0.55);



            mesh_tri.add(arrowN_O);
            arrowN_O.scale.multiplyScalar(1.2);

            var TXMesh1 = createSpriteText(text, corepoint2);

            text_group2.add(TXMesh1);

            // var Line_center=new THREE.Vector3((p1.x+p2.x)/2,(p1.y+p2.y)/2,(p1.z+p2.z)/2);

            var cir_dir = new THREE.Vector3().subVectors(corepoint, p1);
            cir_dir.normalize();

            var arrowpt = new THREE.Vector3();
            arrowpt.x = corepoint.x + 0.2 * cir_dir.x;
            arrowpt.y = corepoint.y + 0.2 * cir_dir.y;
            arrowpt.z = corepoint.z + 0.2 * cir_dir.z;

            //arr_dir.normalize();

            var direction1 = cir_dir.applyAxisAngle(forceFaceDir, Math.PI / 2);

            //var direction1 = new THREE.Vector3().subVectors(p1, p2);
            var length1 = 0.001;
            direction1.normalize();
            var arrowHelper1 = new THREE.ArrowHelper(direction1, arrowpt, length1, "black", 0.1, 0.1);

            //            mesh_tri.add(arrowHelper1);


            //cir arr

            var circle_mesh = createCircleFaceArrow(corepoint, 0.1, forceFaceDir);
            mesh_tri.add(circle_mesh);



            // var step_1=createCircleFaceArrow2(TubePoints1[1],0.4,Force_face_dir[0]);
            // Tube_group.add(step_1);


        }







        //draw normal



        return mesh_tri;



        //var polyhedron =createMesh(new THREE.PolyhedronGeometry(vertices,faces));





















    }

    function Pnt_copy(n1) {

        var n2 = new THREE.Vector3(0, 0, 0);
        n2.x = n1.x;
        n2.y = n1.y;
        n2.z = n1.z;
        return n2;
    }

    function arrow_direction(n1, n2, n3, n4) {

        var matr3 = new THREE.Matrix3();
        matr3.elements = [n2.x, n2.y, n2.z, n3.x, n3.y, n3.z, n4.x, n4.y, n4.z];

        var matr3_Inver = new THREE.Matrix3();

        matr3_Inver.getInverse(matr3);

        var arr_direct = new Array();

        var Ma3 = matr3_Inver.elements;

        var a1 = Ma3[0] * (-1) * n1.x + Ma3[3] * (-1) * n1.y + Ma3[6] * (-1) * n1.z;
        //var a1=Ma3[0]*(-1)*n1.x+Ma3[3]*(-1)*n1.y+Ma3[6]*(-1)*n1.z;
        arr_direct.push(a1);

        var a2 = Ma3[1] * (-1) * n1.x + Ma3[4] * (-1) * n1.y + Ma3[7] * (-1) * n1.z;
        arr_direct.push(a2);

        var a3 = Ma3[2] * (-1) * n1.x + Ma3[5] * (-1) * n1.y + Ma3[8] * (-1) * n1.z;
        arr_direct.push(a3);

        return arr_direct;





    }

    function Cal_Arrange_AA(n1, n2, n3, n4) {

        var n11 = Pnt_copy(n1);
        var n22 = Pnt_copy(n2);
        var n33 = Pnt_copy(n3);
        var n44 = Pnt_copy(n4);

        n11.normalize();
        n22.normalize();
        n33.normalize();
        n44.normalize();

        Change_N3N4 = false;




        // end

        var CO = arrow_direction(n11, n22, n33, n44);

        console.log("CO0", CO[0], "CO1", CO[1], "CO2", CO[2]);


        var AngV = Math.atan2(n22.y, n22.x);





        if (CO[0] < 0) {
            n22.x = -n22.x;
            n22.y = -n22.y;
            n22.z = -n22.z;
        }
        if (CO[1] < 0) {
            n33.x = -n33.x;
            n33.y = -n33.y;
            n33.z = -n33.z;
        }
        if (CO[2] < 0) {
            n44.x = -n44.x;
            n44.y = -n44.y;
            n44.z = -n44.z;
        }



        var n22_ang = Rotate_Vec(n22, new THREE.Vector3(0, 0, 1), -AngV);
        var n33_ang = Rotate_Vec(n33, new THREE.Vector3(0, 0, 1), -AngV);
        var n44_ang = Rotate_Vec(n44, new THREE.Vector3(0, 0, 1), -AngV);





        //var AngN33=Math.atan2(n33_ang.y,n33_ang.x);


        var AngN3 = Math.atan2(n33_ang.y, n33_ang.x);
        if (AngN3 < 0)
            AngN3 = AngN3 + 2.0 * Math.PI;
        var AngN4 = Math.atan2(n44_ang.y, n44_ang.x);
        if (AngN4 < 0)
            AngN4 = AngN4 + 2.0 * Math.PI;


        //console.log("AngV",AngV,"AngN3",AngN3,"AngN4",AngN4);

        var AA = new Array();
        AA.push(n22);

        if (AngN3 < AngN4) {
            AA.push(n33);
            AA.push(n44);
        }
        else {
            AA.push(n44);
            AA.push(n33);
            Change_N3N4 = true;
        }

        return AA;
    }

    function Rotate_Vec(p1, R_V, Theta) {
        //  function [P2] = Rotate_Vec(P1, R_V, theta)

        var vector = new THREE.Vector3(0, 0, 0);
        var axis = new THREE.Vector3(0, 0, 0);

        vector = Pnt_copy(p1);
        axis = Pnt_copy(R_V);

        vector.applyAxisAngle(axis, Theta);
        return vector;
    }

    function LinesSectPt(L1_dir, P1_pnt, L2_dir, P2_pnt) {

        var L1_dir1 = new THREE.Vector3(0, 0, 0);
        var L2_dir2 = new THREE.Vector3(0, 0, 0);

        L1_dir1 = Pnt_copy(L1_dir);
        L2_dir2 = Pnt_copy(L2_dir);



        L1_dir1.x = L1_dir.x / norm(L1_dir);
        L1_dir1.y = L1_dir.y / norm(L1_dir);

        L2_dir2.x = L2_dir.x / norm(L2_dir);
        L2_dir2.y = L2_dir.y / norm(L2_dir);
        L2_dir2.z = L2_dir.z / norm(L2_dir);


        var P1P2_Vec = new THREE.Vector3(0, 0, 0);
        P1P2_Vec.x = P2_pnt.x - P1_pnt.x;
        P1P2_Vec.y = P2_pnt.y - P1_pnt.y;
        P1P2_Vec.z = P2_pnt.z - P1_pnt.z;


        var P2P3_Norm = norm(cross(P1P2_Vec, L1_dir1));



        var P3_pnt = new THREE.Vector3(0, 0, 0);

        P3_pnt.x = P1_pnt.x + ((P1P2_Vec.x * L1_dir1.x + P1P2_Vec.y * L1_dir1.y + P1P2_Vec.z * L1_dir1.z)) * L1_dir1.x;
        P3_pnt.y = P1_pnt.y + ((P1P2_Vec.x * L1_dir1.x + P1P2_Vec.y * L1_dir1.y + P1P2_Vec.z * L1_dir1.z)) * L1_dir1.y;
        P3_pnt.z = P1_pnt.z + ((P1P2_Vec.x * L1_dir1.x + P1P2_Vec.y * L1_dir1.y + P1P2_Vec.z * L1_dir1.z)) * L1_dir1.z;

        var CosTheta = Math.abs(L1_dir1.x * L2_dir2.x + L1_dir1.y * L2_dir2.y + L1_dir1.z * L2_dir2.z);


        var k_pnt = new THREE.Vector3(0, 0, 0);

        if (CosTheta < 0) {
            k_pnt = Pnt_copy(P3_pnt);

        }

        if (CosTheta > 0) {
            var Tantheta = Math.sqrt((1 - Math.pow(CosTheta, 2))) / CosTheta;
            var KP3_Norm = P2P3_Norm / Tantheta;

            var K1_pnt = new THREE.Vector3((P3_pnt.x + KP3_Norm * L1_dir1.x), (P3_pnt.y + KP3_Norm * L1_dir1.y), (P3_pnt.z + KP3_Norm * L1_dir1.z));
            var K2_pnt = new THREE.Vector3((P3_pnt.x - KP3_Norm * L1_dir1.x), (P3_pnt.y - KP3_Norm * L1_dir1.y), (P3_pnt.z - KP3_Norm * L1_dir1.z));



            var P2K1_vec = new THREE.Vector3((K1_pnt.x - P2_pnt.x), (K1_pnt.y - P2_pnt.y), (K1_pnt.z - P2_pnt.z));
            var P2K2_vec = new THREE.Vector3((K2_pnt.x - P2_pnt.x), (K2_pnt.y - P2_pnt.y), (K2_pnt.z - P2_pnt.z));

            var D1 = norm(cross(P2K1_vec, L2_dir2));
            var D2 = norm(cross(P2K2_vec, L2_dir2));


            if (D1 < D2)
                k_pnt = Pnt_copy(K1_pnt);
            else
                k_pnt = Pnt_copy(K2_pnt);

        }

        return k_pnt;


    }

    function Cal_Vec(vec1, vec2, vec3, n) {

        cb = new THREE.Vector3(),
            ab = new THREE.Vector3(),
            normal = new THREE.Vector3(),
            cb.subVectors(vec1, vec2);
        ab.subVectors(vec3, vec2);
        ab.cross(cb);
        normal.copy(ab).normalize();


        var newPoint = new THREE.Vector3(vec2.x - n * normal.x, vec2.y - n * normal.y, vec2.z - n * normal.z);
        return newPoint;
    }

    function generatePoints(points) {
        // add n random spheres
        var geometry = new THREE.Geometry();
        geometry.vertices.push(points[0]);
        geometry.vertices.push(points[1]);

        var line = new THREE.Line(geometry, lattice_line_material);


        return line;
    }


    var stats;

    function initStats() {
        stats = new Stats();
        //document.body.appendChild(stats.dom);
    }

    var gui;




    var step = 0;

    var INTERSECTED;
    var SELECTED;

    function render() {

        stats.update();


        var rayCaster2 = new THREE.Raycaster();
        rayCaster2.setFromCamera(mouse, camera);
        var intersects = rayCaster2.intersectObjects(Ctrl_tubes);




        renderer.clear();
        renderer.setViewport(0, 0, window.innerWidth / 2, window.innerHeight)
        renderer.render(scene, camera);

        renderer.autoClear = false;
        renderer.setViewport(window.innerWidth / 2, 0, window.innerWidth / 2, window.innerHeight)
        renderer.render(scene2, camera);

        renderer.clearDepth();
        renderer.setViewport(window.innerWidth / 2, 0, window.innerWidth / 2, window.innerHeight)
		renderer.render( sceneOrtho1, cameraOrtho );

        renderer.clearDepth();
        // renderer.setViewport(window.innerWidth / 2, 0, window.innerWidth / 2, window.innerHeight)
        renderer.setViewport(0, 0, window.innerWidth / 2, window.innerHeight)
		renderer.render( sceneOrtho2, cameraOrtho );
    }

    function animate() {


        stats.update();
        requestAnimationFrame(animate);
        orbit_ctrl.update();
        trfm_ctrl.update();
        render();
        TWEEN.update();
    }

    function draw() {
        initRender();
        initScene();
        initCamera();
        orbit_ctrl = new THREE.OrbitControls(camera, renderer.domElement);
        //initLight();
        initModel();


        initStats();
        //initGui();

        animate();
        //window.onresize = onWindowResize;
    }
</script>

</html>

